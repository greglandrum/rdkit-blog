<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>RDKit blog</title>
<link>https://greglandrum.github.io/rdkit-blog/</link>
<atom:link href="https://greglandrum.github.io/rdkit-blog/index.xml" rel="self" type="application/rss+xml"/>
<description>RDKit experiments, tips, and tutorials</description>
<generator>quarto-1.6.39</generator>
<lastBuildDate>Thu, 06 Mar 2025 23:00:00 GMT</lastBuildDate>
<item>
  <title>Drawing on drawings</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings.html</link>
  <description><![CDATA[ 




<p>In addition to the expected functions to draw one more more molecules, the RDKit <code>MolDraw2D</code> objects lets you add annotations (text, lines, arrows, shapes, etc) to your drawings. This post shows how to use that to layout the molecules and data from some free-energy calculations.</p>
<p>The data here and the overall figure layout is from <a href="https://link.springer.com/article/10.1007/s10822-021-00436-z/figures/8">Figure 8</a> of <a href="https://link.springer.com/article/10.1007/s10822-021-00436-z">this open-access paper</a> from our group.</p>
<div id="933592b3" class="cell" data-scrolled="true" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb1-4">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-6">IPythonConsole.molSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span></span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.6</code></pre>
</div>
</div>
<p>Start with the scaffold for the molecules:</p>
<div id="64244b6f" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">core <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb3-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2401 03062519142D          </span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb3-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb3-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 21 23 0 0 0</span></span>
<span id="cb3-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb3-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -1.8519 5.7623 0 0</span></span>
<span id="cb3-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -3.1855 4.9922 0 0</span></span>
<span id="cb3-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -3.1855 3.4522 0 0</span></span>
<span id="cb3-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -1.8519 2.6822 0 0</span></span>
<span id="cb3-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -0.5182 3.4522 0 0</span></span>
<span id="cb3-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -0.5182 4.9922 0 0</span></span>
<span id="cb3-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 N -1.8519 1.1422 0 0</span></span>
<span id="cb3-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 C -3.1855 0.3722 0 0</span></span>
<span id="cb3-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C -3.1855 -1.1679 0 0</span></span>
<span id="cb3-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 N -1.8519 -1.9379 0 0</span></span>
<span id="cb3-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 C -0.5182 -1.1679 0 0</span></span>
<span id="cb3-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 C -0.5182 0.3722 0 0</span></span>
<span id="cb3-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 13 N -4.5192 2.6822 0 0</span></span>
<span id="cb3-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 14 C -5.8529 3.4522 0 0</span></span>
<span id="cb3-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 15 C -7.1866 2.6822 0 0</span></span>
<span id="cb3-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 16 O -5.8529 4.9922 0 0</span></span>
<span id="cb3-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 17 N -8.5934 3.3086 0 0</span></span>
<span id="cb3-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 18 C -9.6238 2.1642 0 0</span></span>
<span id="cb3-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 19 S -8.8538 0.8305 0 0</span></span>
<span id="cb3-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 20 C -7.3476 1.1507 0 0</span></span>
<span id="cb3-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 21 A -11.1554 2.3252 0 1</span></span>
<span id="cb3-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb3-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb3-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb3-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb3-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb3-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb3-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb3-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb3-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 4 7</span></span>
<span id="cb3-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 8 9</span></span>
<span id="cb3-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 9 10</span></span>
<span id="cb3-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 1 10 11</span></span>
<span id="cb3-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 1 11 12</span></span>
<span id="cb3-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 1 7 8</span></span>
<span id="cb3-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 13 1 7 12</span></span>
<span id="cb3-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 14 1 3 13</span></span>
<span id="cb3-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 15 1 13 14</span></span>
<span id="cb3-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 16 1 14 15</span></span>
<span id="cb3-47"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 17 2 14 16</span></span>
<span id="cb3-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 18 1 18 19</span></span>
<span id="cb3-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 19 1 19 20</span></span>
<span id="cb3-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 20 1 15 17</span></span>
<span id="cb3-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 21 2 15 20</span></span>
<span id="cb3-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 22 2 17 18</span></span>
<span id="cb3-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 23 1 18 21</span></span>
<span id="cb3-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb3-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb3-56"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb3-57"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span>)</span>
<span id="cb3-58">core</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now define the side chains:</p>
<div id="4226a0fc" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">chains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L20'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[*:1]C1=CC2=C(OCO2)C=C1'</span>),</span>
<span id="cb4-2">          (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[*:1]C1=CC2=C(OCC2)C=C1'</span>),</span>
<span id="cb4-3">          (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L21'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[*:1]C1=CC2=C(OCCO2)C=C1'</span>),</span>
<span id="cb4-4">          (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L17'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[*:1]c1ccc(OC)cc1'</span>),</span>
<span id="cb4-5">          (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L19'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[*:1]c1ccc(OC)c(OC)c1'</span>),</span>
<span id="cb4-6">         )</span>
<span id="cb4-7"></span>
<span id="cb4-8">chainmols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> chains]</span>
<span id="cb4-9">Draw.MolsToGridImage(chainmols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> chains])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>I’d like the side chains to all be oriented consistently, so I’m going to construct the full molecules, lay them out, and then remove the core from each of those.</p>
<p>Here’s the easy way to construct the full molecules, using <code>Chem.molzip()</code></p>
<div id="5eea12f3" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> lbl,smi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> chains:</span>
<span id="cb5-3">    nm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.molzip(core,Chem.MolFromSmiles(smi))</span>
<span id="cb5-4">    rdDepictor.Compute2DCoords(nm)</span>
<span id="cb5-5">    mols.append(nm)</span>
<span id="cb5-6">    </span>
<span id="cb5-7">Draw.MolsToGridImage(mols,legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> chains])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now use <code>Chem.ReplaceCore()</code> to remove the core atoms from each molecule, leaving us with just the sidechains in a consistent orientation:</p>
<div id="671abb35" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">justcore <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(core)</span>
<span id="cb6-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We need to remove the dummy atom:</span></span>
<span id="cb6-3">justcore.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb6-4"></span>
<span id="cb6-5">newchains <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb6-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (lbl,smi),mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(chains,mols):</span>
<span id="cb6-7">    tmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.ReplaceCore(mol,justcore)</span>
<span id="cb6-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># label the dummy atom:</span></span>
<span id="cb6-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> atom <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tmol.GetAtoms():</span>
<span id="cb6-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> atom.GetAtomicNum():</span>
<span id="cb6-11">            atom.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atomLabel'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R"</span>)</span>
<span id="cb6-12">    newchains[lbl] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tmol</span>
<span id="cb6-13"></span>
<span id="cb6-14">Draw.MolsToGridImage(newchains.values(), legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>newchains.keys())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The easiest way to reproduce the target figure is by laying the molecules out on a 3x3 grid with some empty spaces:</p>
<div id="052960a3" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">lbls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L20'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L21'</span>,</span>
<span id="cb7-2">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L17'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,</span>
<span id="cb7-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L19'</span>]</span>
<span id="cb7-4">grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [newchains[l] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> l <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> l <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lbls]</span>
<span id="cb7-5">Draw.MolsToGridImage(grid,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lbls)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6dc5b3bd" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVG</span>
<span id="cb8-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Geometry</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up the drawing object:</span></span>
<span id="cb8-5">nRows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-6">nCols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb8-7">panelx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb8-8">panely <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb8-9">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(panelx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>nCols,panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>nRows,panelx,panely)</span>
<span id="cb8-10">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb8-11">dopts.legendFontSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-12"></span>
<span id="cb8-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># draw the sidechains</span></span>
<span id="cb8-14">d2d.DrawMolecules(grid,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lbls)</span>
<span id="cb8-15"></span>
<span id="cb8-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now draw all the arrows and add the free-energy values</span></span>
<span id="cb8-17">d2d.SetLineWidth(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb8-18">d2d.SetFontSize(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb8-19"></span>
<span id="cb8-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use gray arrows so that they don't stand out quite so much</span></span>
<span id="cb8-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   (the original figure has solid black, but I find this nicer)</span></span>
<span id="cb8-22">arrowColor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.4</span>)</span>
<span id="cb8-23"></span>
<span id="cb8-24">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(panelx,panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-25">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-26">d2d.DrawArrow(p2,p1,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-27"></span>
<span id="cb8-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># draw the free-energy value slightly offset along the y axis</span></span>
<span id="cb8-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (this is a horizontal arrow) from the mid-point of the arrow:</span></span>
<span id="cb8-30">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-31">midp.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-32">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-0.3"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-33"></span>
<span id="cb8-34"></span>
<span id="cb8-35">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(panelx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,panely)</span>
<span id="cb8-36">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(panelx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-37">d2d.DrawArrow(p2,p1,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-38">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-39">midp.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-40">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.0"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-41"></span>
<span id="cb8-42">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(panelx,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-43">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>panely<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-44">d2d.DrawArrow(p1,p2,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-45">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-46">midp.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-47">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.8"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-48"></span>
<span id="cb8-49">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> panelx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,panely)</span>
<span id="cb8-50">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> panelx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-51">d2d.DrawArrow(p1,p2,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb8-52">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-53">midp.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb8-54">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.5"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-55"></span>
<span id="cb8-56"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do the diagonals... these are trickier</span></span>
<span id="cb8-57"></span>
<span id="cb8-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this is the fraction of the side length of the grid boxes that the arrows</span></span>
<span id="cb8-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># will extend into each box.</span></span>
<span id="cb8-60">frac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb8-61"></span>
<span id="cb8-62">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-63">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-64">d2d.DrawArrow(p2,p1,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,frac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb8-65">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-66">midp.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb8-67">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.1"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-68"></span>
<span id="cb8-69">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-70">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-71">d2d.DrawArrow(p2,p1,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,frac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb8-72">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-73">midp.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb8-74">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.4"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-75"></span>
<span id="cb8-76">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-77">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-78">d2d.DrawArrow(p2,p1,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,frac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb8-79">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-80">midp.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb8-81">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4.9"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb8-82"></span>
<span id="cb8-83">p1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-84">p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Geometry.Point2D((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panelx,(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>frac)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>panely)</span>
<span id="cb8-85">d2d.DrawArrow(p2,p1,color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>arrowColor,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, asPolygon<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,frac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb8-86">midp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (p1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-87">midp.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb8-88">d2d.DrawString(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.1"</span>,midp,rawCoords<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, align<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb8-89"></span>
<span id="cb8-90"></span>
<span id="cb8-91">d2d.FinishDrawing()</span>
<span id="cb8-92">svg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.GetDrawingText()</span>
<span id="cb8-93">SVG(svg)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings_files/figure-html/cell-8-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>At the moment it’s not possible to change the font colour used for <code>DrawText()</code>, so I can’t sensibly add the predicted free energy values to the plot. I will fix that for the next RDKit release and update this post at some point in the future once that has been done.</p>
<p>If you’re doing a figure for a paper and you want to so some fine tuning of the result, it’s almost definitely faster (and likely better) to save the SVG to a file and then use your favorite drawing package that can open SVG files (inkscape, Adobe Illustrator, whatever) to do the final polishing.</p>



 ]]></description>
  <category>tutorial</category>
  <category>drawing</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-03-07-drawing-on-drawings.html</guid>
  <pubDate>Thu, 06 Mar 2025 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/drawing-on-drawings-1.png" medium="image" type="image/png" height="137" width="144"/>
</item>
<item>
  <title>Tuning substructure queries</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1.html</link>
  <description><![CDATA[ 




<p>This is another tutorial post, this time looking at use of the function <code>AdjustQueryProperties()</code> to tune substructure queries without having to write SMARTS patterns. I show how to use the functionality both in the RDKit PostgreSQL cartridge and from Python.</p>
<p>This is an updated and expanded version of an <a href="https://rdkit.blogspot.com/2016/07/tuning-substructure-queries-ii.html">old blog post</a>.</p>
<div id="cell-2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext sql</span>
<span id="cb1-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(time.asctime())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.5
Sat Mar  1 06:53:41 2025</code></pre>
</div>
</div>
<section id="adjusting-queries-in-the-cartridge" class="level1">
<h1>Adjusting queries in the cartridge</h1>
<p>Our starting point is a query against ChEMBL for molecules that contain a pyridine ring.</p>
<div id="cell-4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-3">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-4">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccn1'</span>::mol limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-6">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb3-7">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-3-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we add two dummy atoms to that in order to look for 2-6 di-substituted pyridines we initially get no results:</p>
<div id="cell-6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-2">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-3">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-4">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb5-5">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(*)n1'</span> limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
0 rows affected.</code></pre>
</div>
</div>
<p>But we can change that by calling the new <code>mol_adjust_query_properties()</code> function:</p>
<div id="cell-8" class="cell" data-scrolled="false" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-2">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-3">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-4">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb7-5">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(*)n1'</span>::mol) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb7-6">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb7-7">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This function makes a number of changes by default:</p>
<ul>
<li>Converts dummy atoms into “any” queries</li>
<li>Adds a degree query to every ring atom so that its substitution must match what was provided</li>
<li>Aromaticity perception is done (if it hasn’t been done already)</li>
</ul>
<p>The addition of degree queries has the consequence that we only find di-substituted pyridines. We can lift that restriction by providing some additional configuration information to <code>mol_adjust_query_properties()</code> as JSON:</p>
<div id="cell-10" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustDegree'</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>}</span>
<span id="cb9-2">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.dumps(params)</span>
<span id="cb9-3">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-4">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-5">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-6">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-7">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(*)n1'</span>::mol,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-8">                                         :params) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb9-9">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb9-10">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-6-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice that now we have additional substitutions on the rings. However now there are also some examples where the pyridine is part of a fused ring. We can get rid of these by telling <code>mol_adjust_query_properties()</code> to also add a ring-count query to every ring atom :</p>
<div id="cell-12" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustDegree'</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb11-2">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustRingCount'</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>}</span>
<span id="cb11-3">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.dumps(params)</span>
<span id="cb11-4">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-5">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(*)n1'</span>::mol,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-9">                                         :params) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb11-10">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb11-11">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-7-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So now we are getting results which can have more than two substituents on the pyridine ring, but where the pyridine cannot be in a fused ring.</p>
<p>To explore the next set of options, we extend the query a little bit to search for 2-6 substituted pyridines where one of the substituents starts with an <code>NC=O</code>:</p>
<div id="cell-15" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-2">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-3">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-4">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-5">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(NC(=O)*)n1'</span>::mol) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-6">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb13-7">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-8-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s allow the degrees of ring atoms or dummies to change, but not the degree of chain atoms, this should remove matches like those to molecule CHEMBL5221563 above:</p>
<div id="cell-17" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustDegree'</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb15-2">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustDegreeFlags'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'IGNORERINGS|IGNOREDUMMIES'</span>}</span>
<span id="cb15-3">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.dumps(params)</span>
<span id="cb15-4">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-5">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-6">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-7">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-8">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(NC(=O)*)n1'</span>::mol,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-9">                                         :params) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb15-10">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb15-11">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And now get rid of the fused rings by turning on the ring-count changes too:</p>
<div id="cell-19" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustDegree'</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb17-2">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustDegreeFlags'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'IGNORERINGS|IGNOREDUMMIES'</span>,</span>
<span id="cb17-3">         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'adjustRingCount'</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>}</span>
<span id="cb17-4">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.dumps(params)</span>
<span id="cb17-5">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-6">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-7">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-8">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-9">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(NC(=O)*)n1'</span>::mol,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-10">                                         :params) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-11">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb17-12">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="queries-from-mol-blocks" class="level2">
<h2 class="anchored" data-anchor-id="queries-from-mol-blocks">Queries from mol blocks</h2>
<p>The same adjustments can be used on query molecules constructed from mol blocks:</p>
<div id="cell-22" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">mb<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb19-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv1561 07261609522D          </span></span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  8  8  0  0  0  0            999 V2000</span></span>
<span id="cb19-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -1.9866    0.7581    0.0000 N   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -2.7011    0.3455    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -2.7011   -0.4795    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -1.9866   -0.8920    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -1.2721   -0.4795    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -1.2721    0.3455    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -3.4155    0.7580    0.0000 A   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   -0.5577    0.7580    0.0000 A   0  0  0  0  0  0  0  0  0  0  0  0</span></span>
<span id="cb19-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  1  2  1  0  0  0  0</span></span>
<span id="cb19-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  1  6  2  0  0  0  0</span></span>
<span id="cb19-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  2  3  2  0  0  0  0</span></span>
<span id="cb19-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  3  4  1  0  0  0  0</span></span>
<span id="cb19-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  4  5  2  0  0  0  0</span></span>
<span id="cb19-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  5  6  1  0  0  0  0</span></span>
<span id="cb19-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  2  7  1  0  0  0  0</span></span>
<span id="cb19-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  6  8  1  0  0  0  0</span></span>
<span id="cb19-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb19-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb19-23">Chem.MolFromMolBlock(mb)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The semantics of mol block queries are a bit different since we already have query atoms:</p>
<div id="cell-24" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-2">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-3">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-4">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-5">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_from_ctab(:mb) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb20-6">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb20-7">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Calling <code>mol_adjust_query_properties()</code> here effectively just adds the degree queries (since the dummies are already queries), providing the same results as in Block 4 above:</p>
<div id="cell-26" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-2">    select chembl_id,molfile <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_structures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-3">    using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-4">    join chembl_id_lookup on (entity_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>molregno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-5">    where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span>mol_adjust_query_properties(mol_from_ctab(:mb)) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-6">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(y) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data]</span>
<span id="cb22-7">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35
10 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="using-this-from-python" class="level1">
<h1>Using this from Python</h1>
<p>The same options are available from Python using the function <code>Chem.AdjustQueryProperties()</code>:</p>
<div id="cell-28" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cc1cc(C)nc(NC(=O)c2ccc3c(c2)OCO3)c1'</span>)</span>
<span id="cb24-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1cc(C)nc(NC(=O)c2ccc3c(c2)OCO3)c1'</span>)</span>
<span id="cb24-3">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1cc(C)nc(N(C)C(=O)c2ccc3c(c2)OCO3)c1'</span>)</span>
<span id="cb24-4">Draw.MolsToGridImage((m1,m2,m3),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'m1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'m2'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'m3'</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1cccc(NC(=O)*)n1'</span>)</span>
<span id="cb25-2">q</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Initially this has no substructure matches since the dummy atoms can’t match anything:</p>
<div id="cell-31" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">m1.HasSubstructMatch(q),m2.HasSubstructMatch(q),m3.HasSubstructMatch(q)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(False, False, False)</code></pre>
</div>
</div>
<p>The defaults to <code>Chem.AdjustQueryProperties()</code> take care of this, but they also exclude the match to m1 due to the degree queries added to ring atoms:</p>
<div id="cell-33" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q)</span>
<span id="cb28-2">m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(False, True, True)</code></pre>
</div>
</div>
<p>Turn off the degree queries and all the molecules match:</p>
<div id="cell-35" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters()</span>
<span id="cb30-2">params.adjustDegree<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb30-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb30-4">m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(True, True, True)</code></pre>
</div>
</div>
<p>We can also use the degree query only on chain atoms, this disables the match of m3:</p>
<div id="cell-37" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters()</span>
<span id="cb32-2">params.adjustDegree<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb32-3">params.adjustDegreeFlags<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Chem.ADJUST_IGNORERINGS<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>Chem.ADJUST_IGNOREDUMMIES</span>
<span id="cb32-4">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb32-5">m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(True, True, False)</code></pre>
</div>
</div>
</section>
<section id="some-other-adjust-query-options" class="level1">
<h1>Some other adjust query options</h1>
<p>These are easier to demonstrate in Python, but all are also available in the PostgreSQL cartridge.</p>
<section id="adjustringchain" class="level2">
<h2 class="anchored" data-anchor-id="adjustringchain">adjustRingChain</h2>
<p>Query atoms in rings/chains only match atoms in rings/chains.</p>
<div id="cell-40" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1CCCCO1'</span>)</span>
<span id="cb34-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CCOCC'</span>)</span>
<span id="cb34-3">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COC'</span>)</span>
<span id="cb34-4">Draw.MolsToGridImage((m1,m2,q),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'query'</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-41" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q),m2.HasSubstructMatch(q))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb37-2">params.adjustRingChain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb37-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb37-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False True</code></pre>
</div>
</div>
</section>
<section id="adjustconjugatedfiverings" class="level2">
<h2 class="anchored" data-anchor-id="adjustconjugatedfiverings">adjustConjugatedFiveRings</h2>
<p>This one is there to allow queries, particularly sketched queries, with conjugated 5 rings to match both aromatic and non-aromatic molecules.</p>
<p>Bonds in conjugated 5 rings are converted to <code>SINGLE|DOUBLE|AROMATIC</code></p>
<p>It’s easiest to demonstrate with a mol block query:</p>
<div id="cell-44" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">mb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''atom list query</span></span>
<span id="cb39-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2007 05282011072D          </span></span>
<span id="cb39-3"></span>
<span id="cb39-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb39-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb39-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 5 5 0 0 0</span></span>
<span id="cb39-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb39-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 [C,N,O,S] -4.9583 2.185 0 0</span></span>
<span id="cb39-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -6.2042 1.2798 0 0</span></span>
<span id="cb39-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -5.7283 -0.1848 0 0</span></span>
<span id="cb39-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -4.1883 -0.1848 0 0</span></span>
<span id="cb39-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -3.7125 1.2798 0 0</span></span>
<span id="cb39-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb39-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb39-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb39-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 1 3 4</span></span>
<span id="cb39-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 1 5</span></span>
<span id="cb39-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 2 3</span></span>
<span id="cb39-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 2 4 5</span></span>
<span id="cb39-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb39-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb39-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb39-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb39-24">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(mb)</span>
<span id="cb39-25">q</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1=CCC=C1'</span>)</span>
<span id="cb40-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1=COC=C1'</span>)</span>
<span id="cb40-3">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1=CNC=C1'</span>)</span>
<span id="cb40-4">m4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1=CS(=O)C=C1'</span>)</span>
<span id="cb40-5">Draw.MolsToGridImage((m1,m2,m3,m4),molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q),m2.HasSubstructMatch(q),m3.HasSubstructMatch(q),m4.HasSubstructMatch(q))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True False False True</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb43-2">params.adjustConjugatedFiveRings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb43-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb43-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq),m4.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True True True</code></pre>
</div>
</div>
<p>Note that this can make make the query more generic than expected:</p>
<div id="cell-49" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">m5 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1CCCC1'</span>)</span>
<span id="cb45-2">m6 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1CC=CC1'</span>)</span>
<span id="cb45-3">Draw.MolsToGridImage((m5,m6))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m5.HasSubstructMatch(q),m6.HasSubstructMatch(q))</span>
<span id="cb46-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m5.HasSubstructMatch(tq),m6.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False False
True True</code></pre>
</div>
</div>
</section>
<section id="makeatomsgenericmakebondsgeneric" class="level2">
<h2 class="anchored" data-anchor-id="makeatomsgenericmakebondsgeneric">makeAtomsGeneric/makeBondsGeneric</h2>
<p>These two options convert the affected query atoms/bonds to match any atom/bond.</p>
<div id="cell-52" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1'</span>)</span>
<span id="cb48-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1nnccc1'</span>)</span>
<span id="cb48-3">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1NNCCC1'</span>)</span>
<span id="cb48-4">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1nnccc1'</span>)</span>
<span id="cb48-5">Draw.MolsToGridImage((m1,m2,m3,q),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'query'</span>],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q),m2.HasSubstructMatch(q),m3.HasSubstructMatch(q))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False True False</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb51-2">params.makeAtomsGeneric <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb51-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb51-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True False</code></pre>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb53-2">params.makeBondsGeneric <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb53-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb53-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>False True True</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb55-2">params.makeBondsGeneric <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb55-3">params.makeAtomsGeneric <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb55-4">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb55-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq),m3.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True True</code></pre>
</div>
</div>
</section>
<section id="adjustsinglebondstodegreeoneneighbors" class="level2">
<h2 class="anchored" data-anchor-id="adjustsinglebondstodegreeoneneighbors">adjustSingleBondsToDegreeOneNeighbors</h2>
<p>Converts single bonds from aromatic or conjugated atoms and neighboring atoms with degree one to be <code>SINGLE | AROMATIC</code></p>
<div id="cell-58" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1CCCc2c1nncc2'</span>)</span>
<span id="cb57-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1cccc2c1nncc2'</span>)</span>
<span id="cb57-3">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Cc1nnccc1'</span>)</span>
<span id="cb57-4">Draw.MolsToGridImage((m1,m2,q),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'query'</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q),m2.HasSubstructMatch(q))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True False</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb60-2">params.adjustSingleBondsToDegreeOneNeighbors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb60-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb60-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True</code></pre>
</div>
</div>
</section>
<section id="adjustsinglebondsbetweenaromaticatoms" class="level2">
<h2 class="anchored" data-anchor-id="adjustsinglebondsbetweenaromaticatoms">adjustSingleBondsBetweenAromaticAtoms</h2>
<p>Converts single bonds between aromatic or conjugated atoms to <code>SINGLE | AROMATIC</code></p>
<div id="cell-62" class="cell" data-scrolled="true" data-execution_count="36">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1CC2=CC=CC=C2C2=CC=CC=C12'</span>)</span>
<span id="cb62-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1=CC=C2C(C=CC3=CC=CC=C23)=C1'</span>)</span>
<span id="cb62-3">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1c2ccccc2'</span>)</span>
<span id="cb62-4">Draw.MolsToGridImage((m1,m2,q),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'query'</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q),m2.HasSubstructMatch(q))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True False</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb65-2">params.adjustSingleBondsBetweenAromaticAtoms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb65-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb65-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq),m2.HasSubstructMatch(tq))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True</code></pre>
</div>
</div>
</section>
<section id="usestereocareforbonds" class="level2">
<h2 class="anchored" data-anchor-id="usestereocareforbonds">useStereoCareForBonds</h2>
<p>This one provides a fine grain control over how double bond stereo in the query is matched.</p>
<div id="cell-66" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1">IPythonConsole.drawOptions.addStereoAnnotation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span></code></pre></div>
</div>
<div id="cell-67" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1">mb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb68-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2401 03012506222D          </span></span>
<span id="cb68-3"></span>
<span id="cb68-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb68-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb68-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 4 3 0 0 0</span></span>
<span id="cb68-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb68-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -10.037 2.8148 0 0</span></span>
<span id="cb68-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -8.7034 3.5848 0 0</span></span>
<span id="cb68-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -11.3707 3.5848 0 0</span></span>
<span id="cb68-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -7.3697 2.8148 0 0</span></span>
<span id="cb68-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb68-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb68-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 2 1 2</span></span>
<span id="cb68-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 1 1 3</span></span>
<span id="cb68-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 2 4</span></span>
<span id="cb68-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb68-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb68-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb68-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb68-21">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(mb)</span>
<span id="cb68-22">q</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-68" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C/C=C/C'</span>)</span>
<span id="cb69-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'C/C=C\C'</span>)</span>
<span id="cb69-3">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC=CC'</span>)</span>
<span id="cb69-4">Draw.MolsToGridImage((m1,m2,m3))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-69" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1">ssopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SubstructMatchParameters()</span>
<span id="cb70-2">ssopts.useChirality <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb70-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q,ssopts),m2.HasSubstructMatch(q,ssopts),m3.HasSubstructMatch(q,ssopts))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True False False</code></pre>
</div>
</div>
<div id="cell-70" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb72-2">params.useStereoCareForBonds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb72-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb72-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq,ssopts),m2.HasSubstructMatch(tq,ssopts),m3.HasSubstructMatch(tq,ssopts))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True True</code></pre>
</div>
</div>
<p>This isn’t particularly interesting for this simple case, but it can become relevant for more complex queries</p>
<div id="cell-72" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1">mb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb74-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2401 03012506432D          </span></span>
<span id="cb74-3"></span>
<span id="cb74-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb74-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb74-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 12 12 0 0 0</span></span>
<span id="cb74-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb74-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -6.2311 2.2894 0 0</span></span>
<span id="cb74-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 N -7.7711 2.2893 0 0</span></span>
<span id="cb74-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -8.5412 0.9556 0 0</span></span>
<span id="cb74-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -7.7712 -0.378 0 0</span></span>
<span id="cb74-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -6.2312 -0.378 0 0</span></span>
<span id="cb74-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -5.4612 0.9557 0 0</span></span>
<span id="cb74-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 C -3.9212 0.9557 0 0</span></span>
<span id="cb74-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 C -3.1512 2.2893 0 0</span></span>
<span id="cb74-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C -1.6112 2.2893 0 0</span></span>
<span id="cb74-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 C -10.0812 0.9557 0 0 STBOX=1</span></span>
<span id="cb74-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 C -10.8512 -0.378 0 0 STBOX=1</span></span>
<span id="cb74-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 C -10.0812 -1.7117 0 0</span></span>
<span id="cb74-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb74-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb74-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb74-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb74-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb74-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb74-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb74-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb74-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 6 7</span></span>
<span id="cb74-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 8 9</span></span>
<span id="cb74-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 3 10</span></span>
<span id="cb74-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 1 11 12</span></span>
<span id="cb74-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 2 7 8</span></span>
<span id="cb74-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 2 10 11 STBOX=1</span></span>
<span id="cb74-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb74-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb74-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb74-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb74-38">IPythonConsole.drawOptions.addAtomIndices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb74-39">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(mb)</span>
<span id="cb74-40">q</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The RDKit renderer doesn’t currently display it (memo to self: that’s a feature we should add), but the double bond between atoms 9 and 10 has the stereo care flag set:</p>
<div id="cell-74" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1">q.GetBondBetweenAtoms(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>).HasProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'molStereoCare'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>1</code></pre>
</div>
</div>
<div id="cell-75" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1">IPythonConsole.drawOptions.addAtomIndices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span></code></pre></div>
</div>
<p>Two molecules:</p>
<div id="cell-77" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb78" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'C/C=C\c1ncc(cc1)/C=C/C'</span>)</span>
<span id="cb78-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'C/C=C\c1ncc(cc1)/C=C\C'</span>)</span>
<span id="cb78-3">Draw.MolsToGridImage((m1,m2))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The default behavior is to only match the first molecule, because our query has one cis and one trans but the second molecule has two cis bonds.</p>
<div id="cell-79" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1">ssopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SubstructMatchParameters()</span>
<span id="cb79-2">ssopts.useChirality <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb79-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q,ssopts),m2.HasSubstructMatch(q,ssopts))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True False</code></pre>
</div>
</div>
<p>If we set <code>useStereoCareForBonds</code> the stereochemistry on the trans bond in the query (the one that does not have the <code>molStereoCare</code> flag set) is ignored when querying.</p>
<div id="cell-81" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb81-2">params.useStereoCareForBonds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb81-3">tq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(q,params)</span>
<span id="cb81-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(tq,ssopts),m2.HasSubstructMatch(tq,ssopts))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True</code></pre>
</div>
</div>
<p>We could, of course, have accomplished the same thing by explicitly marking the second query bond as stereo unknown:</p>
<div id="cell-83" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1">mb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb83-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2401 03012506492D          </span></span>
<span id="cb83-3"></span>
<span id="cb83-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb83-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb83-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 12 12 0 0 0</span></span>
<span id="cb83-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb83-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -6.2311 2.2894 0 0</span></span>
<span id="cb83-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 N -7.7711 2.2893 0 0</span></span>
<span id="cb83-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -8.5412 0.9556 0 0</span></span>
<span id="cb83-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -7.7712 -0.378 0 0</span></span>
<span id="cb83-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -6.2312 -0.378 0 0</span></span>
<span id="cb83-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -5.4612 0.9557 0 0</span></span>
<span id="cb83-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 C -3.9212 0.9557 0 0</span></span>
<span id="cb83-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 C -3.1512 2.2893 0 0</span></span>
<span id="cb83-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C -1.6112 2.2893 0 0</span></span>
<span id="cb83-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 C -10.0812 0.9557 0 0</span></span>
<span id="cb83-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 C -10.8512 -0.378 0 0</span></span>
<span id="cb83-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 C -10.0812 -1.7117 0 0</span></span>
<span id="cb83-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb83-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb83-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb83-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb83-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb83-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb83-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb83-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb83-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 6 7</span></span>
<span id="cb83-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 8 9</span></span>
<span id="cb83-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 3 10</span></span>
<span id="cb83-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 1 11 12</span></span>
<span id="cb83-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 2 7 8 CFG=2</span></span>
<span id="cb83-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 2 10 11</span></span>
<span id="cb83-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb83-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb83-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb83-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb83-38">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(mb)</span>
<span id="cb83-39">q</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1_files/figure-html/cell-51-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-84" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1">ssopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SubstructMatchParameters()</span>
<span id="cb84-2">ssopts.useChirality <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb84-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(m1.HasSubstructMatch(q,ssopts),m2.HasSubstructMatch(q,ssopts))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True True</code></pre>
</div>
</div>
<p>But sometimes it’s easier to just mark the double bonds you care about rather than marking the ones you don’t care about.</p>


</section>
</section>

 ]]></description>
  <category>tutorial</category>
  <category>substructure</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-03-01-more-on-tuning-substructure-queries-1.html</guid>
  <pubDate>Fri, 28 Feb 2025 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Highlight atoms in drawings</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial.html</link>
  <description><![CDATA[ 




<p>This is a tutorial blog post demonstrating some of the options the RDKit has for highlighting parts of molecules to show additional information.</p>
<p>An older blog post shows a more advanced application: using multiple highlights together with R-group decomposition: https://greglandrum.github.io/rdkit-blog/posts/2021-08-07-rgd-and-highlighting.html</p>
<div id="62bc69d3" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SimilarityMaps</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb1-6">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.5</code></pre>
</div>
</div>
<p>Test molecule:</p>
<div id="5518f2e2" class="cell" data-scrolled="true" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">esomep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COc1ccc2nc([nH]c2c1)[S@](=O)Cc1ncc(C)c(OC)c1C'</span>)</span>
<span id="cb3-2">rdDepictor.Compute2DCoords(esomep)</span>
<span id="cb3-3">esomep</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="dbe1cd7b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">esomep_h <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddHs(esomep)</span>
<span id="cb4-2">rdDepictor.Compute2DCoords(esomep_h)</span>
<span id="cb4-3">esomep_h</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="highlight-numerical-data" class="level1">
<h1>Highlight numerical data</h1>
<p>As an example of numeric data I’ll use partial charges calculated using the DASH-props tree populated with AM1-BCC charges. Here’s the paper describing the work: https://doi.org/10.1063/5.0218154 and here’s the github repo: https://github.com/rinikerlab/DASH-tree</p>
<div id="10070156" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> serenityff.charge.tree.dash_tree <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DASHTree, TreeType</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> serenityff.charge.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> dash_props_tree_path</span>
<span id="cb5-3">tree <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DASHTree(tree_folder_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dash_props_tree_path, tree_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>TreeType.FULL)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Loading DASH tree data
Loaded 122 trees and data</code></pre>
</div>
</div>
<div id="df3d9cbe" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">charges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tree.get_molecules_partial_charges(esomep_h, chg_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AM1BCC"</span>, </span>
<span id="cb7-2">                                              chg_std_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AM1BCC_std"</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"charges"</span>]</span>
<span id="cb7-3"></span>
<span id="cb7-4">charges[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>[0.10260369084159895,
 -0.3260823673748836,
 0.13600369084159897,
 -0.17074237544369403,
 -0.04009630915840103,
 0.009303690841598967]</code></pre>
</div>
</div>
<p>Let’s start with the oldest option in the RDKit and the one that is best suited to presenting continuous numerical data, similarity maps:</p>
<div id="95e954a5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVG</span>
<span id="cb9-2"></span>
<span id="cb9-3">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">550</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>)</span>
<span id="cb9-4">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb9-5">dopts.useBWAtomPalette()</span>
<span id="cb9-6">SimilarityMaps.GetSimilarityMapFromWeights(esomep_h,charges,d2d,colorMap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'coolwarm'</span>,alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb9-7">d2d.FinishDrawing()</span>
<span id="cb9-8">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-7-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice above that I switched to using a black and white atom palette when doing highlighting. I think this makes everything easier to read and will do it throughout this post.</p>
<div id="3ed3df4e" class="cell" data-scrolled="true" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(charges),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(charges)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(0.44457, -0.6342717064338059)</code></pre>
</div>
</div>
<p>An alternate approach: draw the molecule and use distinct atomic highlights (circles/ovals) with a radius proportional to the magnitude of the charge.</p>
<div id="b4e399a5" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">maxRad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb12-2">chargeRadii <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb12-3">chargeColors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb12-4">highlightAtoms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb12-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,chg <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(charges):</span>
<span id="cb12-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># quantize and scale the charge so that we can use it to scale the highlight radii</span></span>
<span id="cb12-7">    chg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>chg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb12-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(chg)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>:</span>
<span id="cb12-9">        chargeRadii[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(chg)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>maxRad </span>
<span id="cb12-10">        highlightAtoms.append(i)</span>
<span id="cb12-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> chg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb12-12">            chargeColors[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb12-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb12-14">            chargeColors[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb12-15"></span>
<span id="cb12-16">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">550</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>)</span>
<span id="cb12-17">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb12-18">dopts.useBWAtomPalette()</span>
<span id="cb12-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we need to set the highlights to be circles or we'll end up with ovals</span></span>
<span id="cb12-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># that fit around the atomic symbol</span></span>
<span id="cb12-21">dopts.atomHighlightsAreCircles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb12-22"></span>
<span id="cb12-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we need to provide highlightBonds=[] here to avoid having the bonds between highlighted atoms highlighted:</span></span>
<span id="cb12-24">d2d.DrawMolecule(esomep_h,highlightAtoms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlightAtoms,highlightAtomColors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>chargeColors,highlightAtomRadii<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>chargeRadii,</span>
<span id="cb12-25">                highlightBonds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[])</span>
<span id="cb12-26">d2d.FinishDrawing()</span>
<span id="cb12-27">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-9-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also add the numeric values for the atoms where we’ve drawn circles by setting the <code>atomNote</code> property on those atoms:</p>
<div id="ab63f0e5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">molcopy <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(esomep_h)</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> chargeColors:</span>
<span id="cb13-4">    chg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> charges[aid]</span>
<span id="cb13-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(chg)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>:</span>
<span id="cb13-6">        molcopy.GetAtomWithIdx(aid).SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atomNote'</span>,<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>charges[aid]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb13-7">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">550</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>)</span>
<span id="cb13-8">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb13-9">dopts.useBWAtomPalette()</span>
<span id="cb13-10">dopts.atomHighlightsAreCircles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb13-11">d2d.DrawMolecule(molcopy,highlightAtoms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlightAtoms,highlightAtomColors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>chargeColors,highlightAtomRadii<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>chargeRadii,</span>
<span id="cb13-12">                highlightBonds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[])</span>
<span id="cb13-13">d2d.FinishDrawing()</span>
<span id="cb13-14">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-10-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="highlighting-regions-of-a-molecule" class="level1">
<h1>Highlighting regions of a molecule</h1>
<section id="single-color" class="level2">
<h2 class="anchored" data-anchor-id="single-color">Single color</h2>
<p>This time we’re going to highlight regions of the molecule that match a substructure</p>
<div id="cea18f1c" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># build a list that has all atoms that match the substructure:</span></span>
<span id="cb14-2">matches1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a1aaaaa1'</span>))</span>
<span id="cb14-3">highlightAtoms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> match <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches1:</span>
<span id="cb14-5">    highlightAtoms.extend(match)</span>
<span id="cb14-6"></span>
<span id="cb14-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and now draw with highlights on those atoms:    </span></span>
<span id="cb14-8">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb14-9">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb14-10">dopts.useBWAtomPalette()</span>
<span id="cb14-11">d2d.DrawMolecule(esomep,highlightAtoms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlightAtoms)</span>
<span id="cb14-12">d2d.FinishDrawing()</span>
<span id="cb14-13">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-11-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multiple-colors" class="level2">
<h2 class="anchored" data-anchor-id="multiple-colors">Multiple colors</h2>
<p>We can also have multiple different highlighting colors.</p>
<div id="54560d2d" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rather than trying to guess discernible colors, I will just use </span></span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># matplotlib's color scheme</span></span>
<span id="cb15-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb15-4">plt.style.use(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tableau-colorblind10'</span>)</span>
<span id="cb15-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> colors</span></code></pre></div>
</div>
<div id="cf787d77" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict</span>
<span id="cb16-2"></span>
<span id="cb16-3">matches1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a1aaaaa1'</span>))</span>
<span id="cb16-4">color1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors.to_rgb(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>)</span>
<span id="cb16-5">matches2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a1aaaa1'</span>))</span>
<span id="cb16-6">color2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors.to_rgb(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>)</span>
<span id="cb16-7"></span>
<span id="cb16-8">rad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span></span>
<span id="cb16-9">atomHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb16-10">atomRads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb16-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (matches,color) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>((matches1,matches2),(color1,color2)):</span>
<span id="cb16-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> match <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches:</span>
<span id="cb16-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> match:</span>
<span id="cb16-14">            atomHighlights[aid].append(color)</span>
<span id="cb16-15">            atomRads[aid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rad</span>
<span id="cb16-16">        </span>
<span id="cb16-17">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb16-18">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb16-19">dopts.useBWAtomPalette()</span>
<span id="cb16-20">d2d.DrawMoleculeWithHighlights(esomep,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(atomHighlights),{},atomRads,{})</span>
<span id="cb16-21">d2d.FinishDrawing()</span>
<span id="cb16-22">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-13-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also just draw the outlines of the highlighted atoms:</p>
<div id="bc0670bf" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb17-2">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb17-3">dopts.useBWAtomPalette()</span>
<span id="cb17-4">dopts.fillHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb17-5">d2d.DrawMoleculeWithHighlights(esomep,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(atomHighlights),{},atomRads,{})</span>
<span id="cb17-6">d2d.FinishDrawing()</span>
<span id="cb17-7">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-14-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Repeat that, but include the bonds as well.</p>
<div id="d8a2aa2a" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">rad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb18-2">atomHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb18-3">bondHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb18-4">atomRads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb18-5"></span>
<span id="cb18-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (matches,color) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>((matches1,matches2),(color1,color2)):</span>
<span id="cb18-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> match <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches:</span>
<span id="cb18-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,aid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(match):</span>
<span id="cb18-9">            atomHighlights[aid].append(color1)</span>
<span id="cb18-10">            atomRads[aid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rad</span>
<span id="cb18-11">            bnd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetBondBetweenAtoms(aid,match[(i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(match)])</span>
<span id="cb18-12">            bondHighlights[bnd.GetIdx()].append(color)</span>
<span id="cb18-13">        </span>
<span id="cb18-14">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb18-15">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb18-16">dopts.useBWAtomPalette()</span>
<span id="cb18-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I think this looks better if we ensure that the atom highlights are always circles:</span></span>
<span id="cb18-18">dopts.atomHighlightsAreCircles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb18-19">d2d.DrawMoleculeWithHighlights(esomep,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(atomHighlights),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(bondHighlights),atomRads,{})</span>
<span id="cb18-20">d2d.FinishDrawing()</span>
<span id="cb18-21">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-15-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also do that in a more “subway map” style. I will add a third highlight to make it more dramatic.</p>
<div id="a9a5a63f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict</span>
<span id="cb19-2"></span>
<span id="cb19-3">matches1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a1aaaaa1'</span>))</span>
<span id="cb19-4">color1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors.to_rgb(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C0'</span>)</span>
<span id="cb19-5">matches2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a1aaaa1'</span>))</span>
<span id="cb19-6">color2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors.to_rgb(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>)</span>
<span id="cb19-7">matches3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Occc[nH]c'</span>))</span>
<span id="cb19-8">color3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors.to_rgb(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C2'</span>)</span>
<span id="cb19-9"></span>
<span id="cb19-10">rad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span></span>
<span id="cb19-11">atomHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb19-12">bondHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb19-13">atomRads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb19-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> matches,color <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>((matches1,matches2,matches3),(color1,color2,color3)):</span>
<span id="cb19-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> match <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches:</span>
<span id="cb19-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,aid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(match):</span>
<span id="cb19-17">            atomHighlights[aid].append(color)</span>
<span id="cb19-18">            atomRads[aid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rad</span>
<span id="cb19-19">            bnd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetBondBetweenAtoms(aid,match[(i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(match)])</span>
<span id="cb19-20">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> bnd <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb19-21">                bondHighlights[bnd.GetIdx()].append(color)</span>
<span id="cb19-22">        </span>
<span id="cb19-23">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">450</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb19-24">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb19-25">dopts.useBWAtomPalette()</span>
<span id="cb19-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># turn off the highlight fill and ensure circular atom highlights:</span></span>
<span id="cb19-27">dopts.fillHighlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb19-28">dopts.atomHighlightsAreCircles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb19-29">d2d.DrawMoleculeWithHighlights(esomep,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(atomHighlights),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(bondHighlights),atomRads,{})</span>
<span id="cb19-30">d2d.FinishDrawing()</span>
<span id="cb19-31">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-16-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="highlighting-rings" class="level1">
<h1>Highlighting rings</h1>
<p>This is something I first figured out how to do for the <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-08-07-rgd-and-highlighting.html">R-group decomposition blog post</a> mentioned above.</p>
<p>Here we have to draw the molecule twice: The first time finalizes the scaling of the drawing canvas, then we clear the canvas, draw the polygons that fill the rings, and then draw the molecule a second time on top of the polygons.</p>
<div id="322eabd8" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Geometry</span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># setup the same way we did before:</span></span>
<span id="cb20-4">matches1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetSubstructMatches(Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a1aaaaa1'</span>))</span>
<span id="cb20-5"></span>
<span id="cb20-6">color1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors.to_rgb(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1'</span>)</span>
<span id="cb20-7"></span>
<span id="cb20-8"></span>
<span id="cb20-9">highlightAtoms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb20-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> match <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches1:</span>
<span id="cb20-11">    highlightAtoms.extend(match)</span>
<span id="cb20-12"></span>
<span id="cb20-13">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>)</span>
<span id="cb20-14">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.drawOptions()</span>
<span id="cb20-15">dopts.useBWAtomPalette()</span>
<span id="cb20-16">dopts.setHighlightColour(color1)</span>
<span id="cb20-17"></span>
<span id="cb20-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># draw the molecule to get the atom drawing positions and set the canvas scale:</span></span>
<span id="cb20-19">d2d.DrawMolecule(esomep,highlightAtoms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlightAtoms)</span>
<span id="cb20-20">d2d.ClearDrawing()</span>
<span id="cb20-21"></span>
<span id="cb20-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># draw the filled rings:</span></span>
<span id="cb20-23">conf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> esomep.GetConformer()</span>
<span id="cb20-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> ring <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches1:</span>
<span id="cb20-25">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Geometry.Point2D(conf.GetAtomPosition(aidx)) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aidx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ring]</span>
<span id="cb20-26">    d2d.SetFillPolys(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb20-27">    d2d.SetColour(color1)</span>
<span id="cb20-28">    d2d.DrawPolygon(ps)</span>
<span id="cb20-29">dopts.clearBackground <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb20-30"></span>
<span id="cb20-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now redraw the molecule on top of those ring highlights:</span></span>
<span id="cb20-32">d2d.DrawMolecule(esomep,highlightAtoms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlightAtoms)</span>
<span id="cb20-33">d2d.FinishDrawing()</span>
<span id="cb20-34">SVG(d2d.GetDrawingText())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial_files/figure-html/cell-17-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As usual, I hope this was useful. Please leave questions, comments, or suggestions in the widget below.</p>


</section>

 ]]></description>
  <category>tutorial</category>
  <category>drawing</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-02-21-highlighting-atoms-tutorial.html</guid>
  <pubDate>Thu, 20 Feb 2025 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/atom-highlighting-tutorial-1.png" medium="image" type="image/png" height="78" width="144"/>
</item>
<item>
  <title>Storing molecules in images</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images.html</link>
  <description><![CDATA[ 




<p>We added the ability to store metadata about molecules in the PNG and SVG images that the RDKit generates some years ago. This tutorial post shows how to use that information.</p>
<blockquote class="blockquote">
<p>Note: there’s an <a href="https://rdkit.blogspot.com/2020/07/adding-molecular-metadata-to-pngs.html">old post</a> where I first explored this topic. The functionality has since been added to the RDKit core.</p>
</blockquote>
<p>These days you can do some pretty amazing work with using a deep neural network to “understand” the image and translate it into a chemical structure, but it’s a lot easier (and less noisy!) to just save the molecular structure as part of the image file itself.</p>
<div id="deed336c" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb1-4">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.5</code></pre>
</div>
</div>
<p>Read in some molecules and generating coordinates for them.</p>
<div id="baf77f2e" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb3-2">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/S1P1_data.csv'</span>)</span>
<span id="cb3-3">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> df.canonical_smiles][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>]</span>
<span id="cb3-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb3-5">    rdDepictor.Compute2DCoords(m)</span></code></pre></div>
</div>
<div id="68dadcd0" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">df.columns</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>Index(['doc_id', 'molregno', 'standard_relation', 'standard_value',
       'standard_units', 'standard_flag', 'standard_type', 'pchembl_value',
       'canonical_smiles', 'compound_chembl_id'],
      dtype='object')</code></pre>
</div>
</div>
<section id="working-with-pngs" class="level1">
<h1>Working with PNGs</h1>
<p>Generate a PNG image of one molecule:</p>
<div id="817329e0" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DCairo(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb6-2">d2d.DrawMolecule(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb6-3">d2d.FinishDrawing()</span>
<span id="cb6-4">d2d.WriteDrawingText(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>)</span></code></pre></div>
</div>
<p>Read the image in and display it:</p>
<div id="7d21000f" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">img <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Image.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>)</span>
<span id="cb7-2">img</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The PNG contains metadata allowing us to reconstruct the molecule; you do that with <code>MolFromPNGFile()</code>:</p>
<div id="b789ad22" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">nmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromPNGFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>)</span>
<span id="cb8-2">nmol</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="additional-metadata" class="level2">
<h2 class="anchored" data-anchor-id="additional-metadata">Additional metadata</h2>
<p>There’s also a function to add additional metadata to the PNG file. Here we’ll just add the information about the molecule that we read in from the input CSV file:</p>
<div id="ba125ac7" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">df.iloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>doc_id                                                             5839
molregno                                                         189018
standard_relation                                                     =
standard_value                                                     82.0
standard_units                                                       nM
standard_flag                                                         1
standard_type                                                      EC50
pchembl_value                                                      7.09
canonical_smiles      CCCCCCCCc1ccc(NC(=O)[C@@H](N)COP(=O)(O)O)cc1.O...
compound_chembl_id                                         CHEMBL332050
Name: 0, dtype: object</code></pre>
</div>
</div>
<div id="4df427ba" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get a string with PNG data:</span></span>
<span id="cb11-2">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DCairo(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb11-3">d2d.DrawMolecule(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb11-4">d2d.FinishDrawing()</span>
<span id="cb11-5">png <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.GetDrawingText()</span>
<span id="cb11-6"></span>
<span id="cb11-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># construct a dictionary with the metadat we want to add:</span></span>
<span id="cb11-8">metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {k:<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(v) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k,v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(df.iloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].keys(),df.iloc[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])}</span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and then add the data to the PNG string:</span></span>
<span id="cb11-11">png <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddMetadataToPNGString(metadata,png)</span>
<span id="cb11-12"></span></code></pre></div>
</div>
<p>Read the molecule and the metadata from the PNG string:</p>
<div id="5ae22e5d" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">nm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromPNGString(png)</span>
<span id="cb12-2">nprops <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MetadataFromPNGString(png)</span>
<span id="cb12-3">nm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="404efdfa" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">nprops.keys()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>dict_keys(['rdkitPKL rdkit 2024.09.5', 'MOL rdkit 2024.09.5', 'SMILES rdkit 2024.09.5', 'doc_id', 'molregno', 'standard_relation', 'standard_value', 'standard_units', 'standard_flag', 'standard_type', 'pchembl_value', 'canonical_smiles', 'compound_chembl_id'])</code></pre>
</div>
</div>
<p>Here we can see metadata that the RDKit added - pkl data, a Mol block, and SMILES - as well as the properties that we added. The Mol block and the SMILES can be used by other tools, so there’s a bit of interoperability here too.</p>
<p>The values are all strings:</p>
<div id="0b72b6a9" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">nprops[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'compound_chembl_id'</span>], nprops[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pchembl_value'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(b'CHEMBL332050', b'7.09')</code></pre>
</div>
</div>
</section>
</section>
<section id="working-with-multiple-molecules" class="level1">
<h1>Working with multiple molecules</h1>
<p>We can also store/retrieve multiple molecules to/from a PNG:</p>
<div id="c5a1fbe3" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">img <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolsToGridImage(ms[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>df.compound_chembl_id.to_list())</span>
<span id="cb17-2">img</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3aad4aa1" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span>(img)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>IPython.core.display.Image</code></pre>
</div>
</div>
<p>Write the image to a file and then display it (just as a demo):</p>
<div id="4ea4ad51" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wb+'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outf:</span>
<span id="cb20-2">    outf.write(img.data)</span>
<span id="cb20-3">newImg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Image.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>)</span>
<span id="cb20-4">newImg</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The call to read multiple molecules from a PNG is <code>MolsFromPNGFile()</code>:</p>
<div id="b5ddc277" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">nmols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolsFromPNGFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>)</span>
<span id="cb21-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(nmols))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>12</code></pre>
</div>
</div>
<p>Look at the first molecule:</p>
<div id="1e0be8d9" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">nmols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In case you’re curious, here’s what the keys for the metadata in the PNG file are:</p>
<div id="95802f99" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">nmd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MetadataFromPNGFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.png'</span>)</span>
<span id="cb24-2">nmd.keys()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>dict_keys(['rdkitPKL rdkit 2024.09.5', 'MOL rdkit 2024.09.5', 'SMILES rdkit 2024.09.5', 'rdkitPKL1 rdkit 2024.09.5', 'MOL1 rdkit 2024.09.5', 'SMILES1 rdkit 2024.09.5', 'rdkitPKL2 rdkit 2024.09.5', 'MOL2 rdkit 2024.09.5', 'SMILES2 rdkit 2024.09.5', 'rdkitPKL3 rdkit 2024.09.5', 'MOL3 rdkit 2024.09.5', 'SMILES3 rdkit 2024.09.5', 'rdkitPKL4 rdkit 2024.09.5', 'MOL4 rdkit 2024.09.5', 'SMILES4 rdkit 2024.09.5', 'rdkitPKL5 rdkit 2024.09.5', 'MOL5 rdkit 2024.09.5', 'SMILES5 rdkit 2024.09.5', 'rdkitPKL6 rdkit 2024.09.5', 'MOL6 rdkit 2024.09.5', 'SMILES6 rdkit 2024.09.5', 'rdkitPKL7 rdkit 2024.09.5', 'MOL7 rdkit 2024.09.5', 'SMILES7 rdkit 2024.09.5', 'rdkitPKL8 rdkit 2024.09.5', 'MOL8 rdkit 2024.09.5', 'SMILES8 rdkit 2024.09.5', 'rdkitPKL9 rdkit 2024.09.5', 'MOL9 rdkit 2024.09.5', 'SMILES9 rdkit 2024.09.5', 'rdkitPKL10 rdkit 2024.09.5', 'MOL10 rdkit 2024.09.5', 'SMILES10 rdkit 2024.09.5', 'rdkitPKL11 rdkit 2024.09.5', 'MOL11 rdkit 2024.09.5', 'SMILES11 rdkit 2024.09.5'])</code></pre>
</div>
</div>
</section>
<section id="working-with-svg" class="level1">
<h1>Working with SVG</h1>
<p>We can do the same thing with SVG. At the moment we only support a single molecule per SVG file and the metadata is not added by default</p>
<div id="df1518e7" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVG</span>
<span id="cb26-2"></span>
<span id="cb26-3">d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DSVG(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>)</span>
<span id="cb26-4">d2d.DrawMolecule(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb26-5"></span>
<span id="cb26-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the molecule metadata:</span></span>
<span id="cb26-7">d2d.AddMoleculeMetadata(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb26-8"></span>
<span id="cb26-9">d2d.FinishDrawing()</span>
<span id="cb26-10">svg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d2d.GetDrawingText()</span>
<span id="cb26-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># look at the first few characters of the string:</span></span>
<span id="cb26-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(svg[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>])</span>
<span id="cb26-13"></span>
<span id="cb26-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># display the SVG</span></span>
<span id="cb26-15">SVG(svg)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;?xml vers</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-19-output-2.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Write the SVG to a file and read it back in:</p>
<div id="e2413916" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVG</span>
<span id="cb28-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.svg'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w+'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outf:</span>
<span id="cb28-3">    outf.write(svg)</span>
<span id="cb28-4"></span>
<span id="cb28-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'img1.svg'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> inf:</span>
<span id="cb28-6">    newData <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inf.read()</span>
<span id="cb28-7"></span>
<span id="cb28-8">newSVG <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SVG(newData)</span>
<span id="cb28-9">newSVG</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-20-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now read the molecule back from the SVG:</p>
<div id="5118cb7c" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">nmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromRDKitSVG(newData)</span>
<span id="cb29-2">nmol</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="last-notes" class="level1">
<h1>Last notes</h1>
<p>I won’t demonstrate it here in this short post, but chemical reactions can also be stored in/retrieved from PNG files (though currently not SVG files). As with molecules, the data is automatically added to the PNG when a reaction is drawn. It can be retrieved with the function <code>rdChemReactions.ReactionFromPNGString()</code> or <code>rdChemReactions.ReactionFromPNGFile()</code>.</p>
<p>I was going to demo this by grabbing an image from a website that I know uses the RDKit for molecule display, like ChEMBL or the PDBE, but both of those use SVGs for their images and they haven’t made the extra call to add the molecular metadata to those SVGs (this may be intentional, since the metadata does make the SVG files a bit larger).</p>
<p>One thing we’ve noticed is that if you embed one of these PNGs into a Word or PowerPoint document, the metadata ends up being lost when you copy the image back out of the document. However, if you unzip the .docx or .pptx file and look at the PNG there, the metadata is still present, so not all is lost.</p>
<p>Anyway, I think it’s pretty cool to be able to save a compound’s structure as part of its image. Hopefully others agree. :-)</p>


</section>

 ]]></description>
  <category>tutorial</category>
  <category>drawing</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-02-15-storing-molecules-in-images.html</guid>
  <pubDate>Fri, 14 Feb 2025 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/storing-molecules-in-images-1.png" medium="image" type="image/png" height="94" width="144"/>
</item>
<item>
  <title>More on generalized substructure search</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search.html</link>
  <description><![CDATA[ 




<p>This post builds on, and updates, <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-08-03-generalized-substructure-search.html">an older blog post</a> as well as some material from the 2024 RDKit UGM <a href="https://github.com/rdkit/UGM_2024/blob/main/Notebooks/Greg_WhatsNew.ipynb">What’s New session</a>. It’s a tutorial on some functionality for making substructure searching considerably more flexible that we call “Generalized Substructure Search”.</p>
<p>I will show how use to use generalized substructure search with both a <code>SubstructLibrary</code> and the RDKit PostgreSQL cartridge.</p>
<div id="cell-2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> copy</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdGeneralizedSubstruct</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdTautomerQuery</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-8">IPythonConsole.drawOptions.minFontSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-9">Draw.SetComicMode(IPythonConsole.drawOptions)</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb1-11">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-13"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.5</code></pre>
</div>
</div>
<div id="cell-3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext sql</span></code></pre></div>
</div>
<p>Load a <code>SubstructLibrary</code> created using ChEMBL 35. I do this using Charles Hoyt’s <a href="https://github.com/cthoyt/chembl-downloader"><code>chembl_downloader</code></a> Python package to handle downloading the ChEMBL SDF data. For reference, on my 2.5 year old linux box, processing the 2.4 million molecules took ~990 seconds.</p>
<p>The code used to construct this is:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">chembl_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"35"</span></span>
<span id="cb4-2"></span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RDLogger</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb4-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdSubstructLibrary</span>
<span id="cb4-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle, time</span>
<span id="cb4-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gzip</span>
<span id="cb4-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> chembl_downloader</span>
<span id="cb4-9"></span>
<span id="cb4-10">RDLogger.DisableLog(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rdApp.warning"</span>)</span>
<span id="cb4-11">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSubstructLibrary.CachedTrustedSmilesMolHolder()</span>
<span id="cb4-12">fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSubstructLibrary.TautomerPatternHolder(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>)</span>
<span id="cb4-13">keys <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSubstructLibrary.KeyFromPropHolder() </span>
<span id="cb4-14">library <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSubstructLibrary.SubstructLibrary(mols,fps, keys)</span>
<span id="cb4-15">nats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb4-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> chembl_downloader.supplier(version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>chembl_version) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> suppl:</span>
<span id="cb4-17">    t1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>time.time()</span>
<span id="cb4-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(suppl):</span>
<span id="cb4-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> ((i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>):</span>
<span id="cb4-20">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Processed </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> molecules in </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(time.time()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds"</span>)</span>
<span id="cb4-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> mol.GetNumAtoms()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>:</span>
<span id="cb4-22">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb4-23">        library.AddMol(mol)</span>
<span id="cb4-24">        nats.append(mol.GetNumHeavyAtoms())</span>
<span id="cb4-25">t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>time.time()</span>
<span id="cb4-26"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"That took </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds. The library has </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(library)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> molecules."</span>)</span>
<span id="cb4-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'../data/chembl</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>chembl_version<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_ssslib.pkl'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wb+'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outf:</span>
<span id="cb4-28">    pickle.dump(library,outf)</span>
<span id="cb4-29"></span>
<span id="cb4-30"></span>
<span id="cb4-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we want to be able to use the number of heavy atoms as a search order:</span></span>
<span id="cb4-32">nats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>([(x,i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(nats)])</span>
<span id="cb4-33">order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> nats]</span>
<span id="cb4-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># append that to the pickle file with the substruct lib:</span></span>
<span id="cb4-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'../data/chembl</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>chembl_version<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_ssslib.pkl'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ab'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outf:</span>
<span id="cb4-36">    pickle.dump(order,outf)</span>
<span id="cb4-37">    </span></code></pre></div>
<p>Load the pickled <code>SubstructLibrary</code> and the order information:</p>
<div id="cell-6" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb5-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/chembl35_ssslib.pkl'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> inf:</span>
<span id="cb5-3">    sslib <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(inf)</span>
<span id="cb5-4">    order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(inf)</span>
<span id="cb5-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'SubstructLibrary loaded with </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(sslib)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> molecules'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SubstructLibrary loaded with 2430167 molecules</code></pre>
</div>
</div>
<section id="advanced-query-basics" class="level1">
<h1>Advanced query basics</h1>
<p>(Yes, I am laughing as I write this)</p>
<p>Start with a query including a variable attachment point:</p>
<div id="cell-9" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">qmb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb7-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2108 08012107372D          </span></span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb7-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb7-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 11 11 0 0 0</span></span>
<span id="cb7-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb7-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -2.4167 7.8734 0 0</span></span>
<span id="cb7-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -3.7503 7.1034 0 0</span></span>
<span id="cb7-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -3.7503 5.5633 0 0</span></span>
<span id="cb7-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 N -2.4167 4.7933 0 0</span></span>
<span id="cb7-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -1.083 5.5633 0 0</span></span>
<span id="cb7-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -1.083 7.1034 0 0</span></span>
<span id="cb7-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 N 0.3973 7.5279 0 0</span></span>
<span id="cb7-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 N 0.3104 5.0377 0 0</span></span>
<span id="cb7-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C 1.2585 6.2511 0 0</span></span>
<span id="cb7-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 * 0.3539 6.2828 0 0</span></span>
<span id="cb7-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 C 1.5089 8.2833 0 0</span></span>
<span id="cb7-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb7-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb7-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb7-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb7-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb7-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb7-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb7-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb7-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 7 6</span></span>
<span id="cb7-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 5 8</span></span>
<span id="cb7-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 8 9</span></span>
<span id="cb7-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 2 7 9</span></span>
<span id="cb7-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 1 10 11 ENDPTS=(2 8 7) ATTACH=ANY</span></span>
<span id="cb7-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb7-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb7-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb7-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb7-36">qry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(qmb)</span>
<span id="cb7-37">qry</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we just use that query with the substruct library we don’t get the expected results:</p>
<div id="cell-11" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># change the sort order of the substruct library so that</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we get the matches in order of increasing number of heavy atoms</span></span>
<span id="cb8-3">sslib.SetSearchOrder(order)</span>
<span id="cb8-4">mids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sslib.GetMatches(qry)</span>
<span id="cb8-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(mids)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> results'</span>)</span>
<span id="cb8-6">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetMolHolder().GetMol(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mids[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]]</span>
<span id="cb8-7">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mids[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]]</span>
<span id="cb8-8">Draw.MolsToGridImage(ms,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1000 results</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-6-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Repeat that query using the cartridge and my local install of ChEMBL35</p>
<div id="cell-13" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-2">    select chembl_id,mol_send(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-3">        join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">        join compound_properties using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">        where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span> mol_from_ctab(:qmb) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">    order by (heavy_atoms,chembl_id) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb10-7">    </span>
<span id="cb10-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb10-9">    </span>
<span id="cb10-10">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.Mol(y.tobytes()) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb10-11">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb10-12">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1000 rows affected.
1000 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-7-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The ordering of the results is different, but the same molecules, most of which don’t match what we intended, are there.</p>
<p>In order to use the advanced query feature (the link node) in the search, we need to construct an extended query mol and then pass that to the substruct library:</p>
<div id="cell-15" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">xqry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdGeneralizedSubstruct.CreateExtendedQueryMol(qry)</span>
<span id="cb12-2">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sslib.GetMatches(xqry)</span>
<span id="cb12-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb12-4">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetMol(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb12-5">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb12-6"></span>
<span id="cb12-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get the actual matching atoms from each molecule </span></span>
<span id="cb12-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so we can highlight them:</span></span>
<span id="cb12-9">highlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb12-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb12-11">    highlights.append(rdGeneralizedSubstruct.MolGetSubstructMatch(mol,xqry))</span>
<span id="cb12-12">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb12-13">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb12-14">dopts.useBWAtomPalette()</span>
<span id="cb12-15">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb12-16">                     highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlights,drawOptions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dopts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1000 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-8-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Repeat that using the cartridge. The key here is the function <code>mol_to_xqmol()</code>:</p>
<div id="cell-17" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-2">    select chembl_id,mol_send(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-3">        join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-4">        join compound_properties using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-5">        where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span> mol_to_xqmol(mol_from_ctab(:qmb)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-6">    order by (heavy_atoms,chembl_id) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb14-7">    </span>
<span id="cb14-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb14-9">    </span>
<span id="cb14-10">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.Mol(y.tobytes()) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb14-11">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb14-12">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1000 rows affected.
1000 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-9-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Many of those include sidechains (or even other rings in the case of CHEMBL1990692) attached to the core. We can limit the results to only have substitutions at two the two positions tagged in the query using the <code>adjustQueryProperties</code> flag. You can find more information about this function in an <a href="https://rdkit.blogspot.com/2016/07/tuning-substructure-queries-ii.html">old blog post</a></p>
<blockquote class="blockquote">
<p>Memo to myself: update that post!</p>
</blockquote>
<div id="cell-19" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">aqps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters()</span>
<span id="cb16-2">aqps.adjustHeavyDegree <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb16-3">aqps.adjustHeavyDegreeFlags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryWhichFlags.ADJUST_IGNORECHAINS</span>
<span id="cb16-4">xqry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdGeneralizedSubstruct.CreateExtendedQueryMol(qry,adjustQueryProperties<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb16-5">                                                     adjustQueryParameters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>aqps)</span>
<span id="cb16-6">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sslib.GetMatches(xqry)</span>
<span id="cb16-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb16-8">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetMol(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb16-9">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb16-10"></span>
<span id="cb16-11">highlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb16-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb16-13">    highlights.append(rdGeneralizedSubstruct.MolGetSubstructMatch(mol,xqry))</span>
<span id="cb16-14">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb16-15">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb16-16">dopts.useBWAtomPalette()</span>
<span id="cb16-17">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb16-18">                     highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlights,drawOptions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dopts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>186 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now do the same thing with the cartridge:</p>
<div id="cell-21" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.dumps({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adjustHeavyDegree"</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adjustHeavyDegreeFlags"</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IGNORECHAINS"</span>})</span>
<span id="cb18-2">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3">    select chembl_id,mol_send(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-4">        join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-5">        join compound_properties using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-6">        where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;</span> mol_to_xqmol(mol_from_ctab(:qmb),true,true,true,:params) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-7">    order by (heavy_atoms,chembl_id) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb18-8">    </span>
<span id="cb18-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb18-10">    </span>
<span id="cb18-11">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.Mol(y.tobytes()) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb18-12">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb18-13">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>190 rows affected.
190 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-generic-atoms" class="level1">
<h1>Using generic atoms</h1>
<p>For the next query we will combine a generic atom along with a link node (a position in the molecule which can have varying numbers of atoms)</p>
<p>There’s more information, including a list of supported atom types, in the <a href="https://www.rdkit.org/docs/RDKit_Book.html#generic-markush-queries-in-substructure-matching">RDKit book</a></p>
<div id="cell-23" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">qmb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb20-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2401 02062512582D          </span></span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb20-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb20-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 12 13 1 0 0</span></span>
<span id="cb20-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb20-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -2.4167 7.8733 0 0</span></span>
<span id="cb20-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -3.7503 7.1033 0 0</span></span>
<span id="cb20-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -3.7503 5.5632 0 0</span></span>
<span id="cb20-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 N -2.4167 4.7932 0 0</span></span>
<span id="cb20-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -1.083 5.5632 0 0</span></span>
<span id="cb20-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -1.083 7.1033 0 0</span></span>
<span id="cb20-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 N 0.3973 7.5278 0 0</span></span>
<span id="cb20-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 N 0.3104 5.0376 0 0</span></span>
<span id="cb20-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C 1.2585 6.251 0 0</span></span>
<span id="cb20-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 C 2.7975 6.1973 0 0</span></span>
<span id="cb20-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 N 3.6136 7.5032 0 0</span></span>
<span id="cb20-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 * -2.4167 9.4133 0 0</span></span>
<span id="cb20-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb20-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb20-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb20-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb20-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb20-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb20-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb20-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb20-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 7 6</span></span>
<span id="cb20-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 5 8</span></span>
<span id="cb20-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 8 9</span></span>
<span id="cb20-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 2 7 9</span></span>
<span id="cb20-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 1 9 10</span></span>
<span id="cb20-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 1 10 11</span></span>
<span id="cb20-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 13 1 1 12</span></span>
<span id="cb20-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb20-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 LINKNODE 1 3 2 10 9 10 11</span></span>
<span id="cb20-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN SGROUP</span></span>
<span id="cb20-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 SUP 0 ATOMS=(1 12) SAP=(3 12 1 1) XBONDS=(1 13) LABEL=ARY ESTATE=E</span></span>
<span id="cb20-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END SGROUP</span></span>
<span id="cb20-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb20-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb20-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb20-43">qry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(qmb)</span>
<span id="cb20-44"></span>
<span id="cb20-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we currently have to do some contortions in order to show labels for the Sgroups:</span></span>
<span id="cb20-46">lbls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb20-47"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> sgs <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> Chem.GetMolSubstanceGroups(qry):</span>
<span id="cb20-48">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> sgs.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'TYPE'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SUP'</span>:</span>
<span id="cb20-49">        lbls.append((sgs.GetAtoms()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],sgs.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LABEL"</span>)))</span>
<span id="cb20-50"></span>
<span id="cb20-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># convert the Sgroups into queries:        </span></span>
<span id="cb20-52">Chem.SetGenericQueriesFromProperties(qry)</span>
<span id="cb20-53"></span>
<span id="cb20-54"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now apply the labels</span></span>
<span id="cb20-55"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx,lbl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lbls:</span>
<span id="cb20-56">    qry.GetAtomWithIdx(idx).SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atomLabel'</span>,lbl)</span>
<span id="cb20-57">                    </span>
<span id="cb20-58"></span>
<span id="cb20-59">qry</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">aqps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters()</span>
<span id="cb21-2">aqps.adjustHeavyDegree <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb21-3">aqps.adjustHeavyDegreeFlags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryWhichFlags.ADJUST_IGNORECHAINS</span>
<span id="cb21-4"></span>
<span id="cb21-5">xqry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdGeneralizedSubstruct.CreateExtendedQueryMol(qry,adjustQueryProperties<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb21-6">                                                     adjustQueryParameters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>aqps)</span>
<span id="cb21-7">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SubstructMatchParameters()</span>
<span id="cb21-8">params.useGenericMatchers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb21-9">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sslib.GetMatches(xqry, params)</span>
<span id="cb21-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb21-11"></span>
<span id="cb21-12">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetMol(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb21-13">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb21-14"></span>
<span id="cb21-15">highlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb21-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb21-17">    highlights.append(rdGeneralizedSubstruct.MolGetSubstructMatch(mol,xqry))</span>
<span id="cb21-18">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb21-19">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb21-20">dopts.useBWAtomPalette()</span>
<span id="cb21-21">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb21-22">                     highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlights,drawOptions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dopts)</span>
<span id="cb21-23"></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-13-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can use generic queries in the cartridge by explicitly calling <code>mol_adjust_query_properties()</code> and including <code>"setGenericQueryFromProperties":true</code> in its arguments (we should clean that up, and make <code>mol_to_xqmol()</code> support the extra work), and by using the <code>@&gt;&gt;</code> operator to search instead of the normal <code>@&gt;</code> substructure search operator.</p>
<div id="cell-26" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.dumps({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adjustHeavyDegree"</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb23-2">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"adjustHeavyDegreeFlags"</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"IGNORECHAINS"</span>,</span>
<span id="cb23-3">                     <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"setGenericQueryFromProperties"</span>:<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>})</span>
<span id="cb23-4">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-5">    select chembl_id,mol_send(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-6">        join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-7">        join compound_properties using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-8">        where m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@&gt;&gt;</span> mol_to_xqmol(mol_adjust_query_properties(mol_from_ctab(:qmb),:params)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-9">    order by (heavy_atoms,chembl_id) limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb23-10">    </span>
<span id="cb23-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb23-12">    </span>
<span id="cb23-13">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.Mol(y.tobytes()) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb23-14">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb23-15">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 rows affected.
2 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-14-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we don’t use the generic matchers, we get additional results:</p>
<div id="cell-28" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sslib.GetMatches(xqry)</span>
<span id="cb25-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb25-3"></span>
<span id="cb25-4">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetMol(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb25-5">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb25-6"></span>
<span id="cb25-7">highlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb25-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb25-9">    highlights.append(rdGeneralizedSubstruct.MolGetSubstructMatch(mol,xqry))</span>
<span id="cb25-10">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb25-11">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb25-12">dopts.useBWAtomPalette()</span>
<span id="cb25-13">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb25-14">                     highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlights,drawOptions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dopts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-15-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tautomer-insensitivity" class="level1">
<h1>Tautomer insensitivity</h1>
<p>We haven’t seen it in the examples so far, but the results are being done with a tautomer insensitive search - it finds molecules where a tautomer could match the query even if the molecule itself may not directly match.</p>
<p>Here’s a query incorporating both a variable attachment point and a link node which demonstrates this:</p>
<div id="cell-31" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">qmb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''qry </span></span>
<span id="cb27-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2305 09052314502D          </span></span>
<span id="cb27-3"></span>
<span id="cb27-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb27-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb27-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 13 13 0 0 0</span></span>
<span id="cb27-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb27-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 N -4.75 1.9567 0 0</span></span>
<span id="cb27-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -6.0837 1.1867 0 0</span></span>
<span id="cb27-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -6.0837 -0.3534 0 0</span></span>
<span id="cb27-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -4.75 -1.1234 0 0</span></span>
<span id="cb27-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -3.4163 -0.3534 0 0</span></span>
<span id="cb27-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -3.4163 1.1867 0 0</span></span>
<span id="cb27-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 N -1.9692 1.7134 0 0</span></span>
<span id="cb27-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 N -1.8822 -0.7768 0 0</span></span>
<span id="cb27-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C -1.0211 0.4999 0 0</span></span>
<span id="cb27-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 C 0.5179 0.5536 0 0</span></span>
<span id="cb27-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 N 1.2409 1.9133 0 0</span></span>
<span id="cb27-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 * -5.6391 -0.0967 0 0</span></span>
<span id="cb27-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 13 C -5.6391 -2.4067 0 0</span></span>
<span id="cb27-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb27-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb27-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb27-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb27-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb27-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb27-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb27-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb27-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 8 9</span></span>
<span id="cb27-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 7 6</span></span>
<span id="cb27-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 5 8</span></span>
<span id="cb27-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 2 7 9</span></span>
<span id="cb27-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 11 1 9 10</span></span>
<span id="cb27-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 12 1 10 11</span></span>
<span id="cb27-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 13 1 12 13 ENDPTS=(3 4 3 2) ATTACH=ANY</span></span>
<span id="cb27-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb27-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 LINKNODE 1 2 2 10 9 10 11</span></span>
<span id="cb27-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb27-39"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END'''</span></span>
<span id="cb27-40"></span>
<span id="cb27-41">qry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(qmb)</span>
<span id="cb27-42"></span>
<span id="cb27-43">qry</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">aqps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters()</span>
<span id="cb28-2">aqps.adjustHeavyDegree <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb28-3">aqps.adjustHeavyDegreeFlags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryWhichFlags.ADJUST_IGNORECHAINS</span>
<span id="cb28-4"></span>
<span id="cb28-5">xqry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdGeneralizedSubstruct.CreateExtendedQueryMol(qry,adjustQueryProperties<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb28-6">                                                     adjustQueryParameters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>aqps)</span>
<span id="cb28-7">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SubstructMatchParameters()</span>
<span id="cb28-8">params.useGenericMatchers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb28-9">matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sslib.GetMatches(xqry, params)</span>
<span id="cb28-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(matches)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> matches'</span>)</span>
<span id="cb28-11"></span>
<span id="cb28-12">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetMol(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>]</span>
<span id="cb28-13">highlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb28-14"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb28-15">    highlights.append(rdGeneralizedSubstruct.MolGetSubstructMatch(mol,xqry))</span>
<span id="cb28-16">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sslib.GetKeyHolder().GetKey(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches]</span>
<span id="cb28-17">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb28-18">dopts.useBWAtomPalette()</span>
<span id="cb28-19">Draw.MolsToGridImage(mols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>),</span>
<span id="cb28-20">                     highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlights,drawOptions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dopts)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20 matches</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Molecules CHEMBL105982 and CHEMBL110180, which are drawn with a different tautomer of the ring system we’re lookin for, would not be found using a standard substructure search:</p>
<div id="cell-34" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">Draw.MolsToGridImage(mols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>], subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">mols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>].HasSubstructMatch(qry),mols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>].HasSubstructMatch(qry)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(False, False)</code></pre>
</div>
</div>
</section>
<section id="supported-query-features" class="level1">
<h1>Supported query features</h1>
<p>In addition to the link nodes and variable attachment points demonstrated above, the extended query mol also supports SRUs (repeat units with a specified range of repeats, these are similar to link nodes but can support multiple atoms).</p>
<p>The list of supported generic queries can be found in the <a href="https://www.rdkit.org/docs/RDKit_Book.html#generic-markush-queries-in-substructure-matching">RDKit Book</a></p>
</section>
<section id="creating-advanced-queries" class="level1">
<h1>Creating advanced queries</h1>
<section id="sketchers" class="level2">
<h2 class="anchored" data-anchor-id="sketchers">Sketchers</h2>
<p>At the time I wrote this post, none of the freely available chemical sketchers I was aware of were able to create either link nodes or variable attachment points. The open sketchers like ketcher are steadily improving, but, at least as far as I can tell, they don’t support these advanced query features. I drew all the queries for the post using ChemAxon’s MarvinSketch, which has been my go-to sketcher for years. It’s cross-platform, not insanely expensive, and generaly quite good. Biovia Draw, as you’d expect, can also deal with all of these features (at least it used to back when I still had a license. I stopped paying for that one a few years ago since I wasn’t using it). I haven’t used any of the other commercial chemical sketchers recently, so I can’t comment on their support.</p>
</section>
<section id="by-hand" class="level2">
<h2 class="anchored" data-anchor-id="by-hand">By hand</h2>
<p>If you know SMARTS, it’s pretty easy to add either link nodes or variable attachment points to <a href="https://docs.chemaxon.com/display/docs/formats_chemaxon-extended-smiles-and-smarts-cxsmiles-and-cxsmarts.md">CXSMARTS</a>; here’s some documentation on the subset of CXSMARTS that the RDKit <a href="https://www.rdkit.org/docs/RDKit_Book.html#cxsmiles-cxsmarts-extensions">currently supports</a></p>
<p>Here’s an example for a link node. Here you need to provide the index (all indices in CXSMARTS are zero-based) for the atom that is the link node along with the possible repeat counts:</p>
<div id="cell-39" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[#6]-1-[#6]-c2ccccc2-[#7]-1 |LN:1:1.2|'</span>)</span>
<span id="cb33-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>For variable attachment points you provide the index of the multi-center attachment point (the atom that will not be actual enumerated molecule) and the indices of the atoms that are bonded to the attachment point’s neighbor:</p>
<div id="cell-41" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[#6]-*.c1nc2cccnc2n1 |m:1:3.10|'</span>)</span>
<span id="cb34-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice that we currently do a pretty crappy job of generating coordinates for these multi-center attachments. That’s something we need to work on at some point in the future.</p>
<p>SRUs (repeat units that can include multiple atoms) are a bit trickier to provide by hand, but still doable:</p>
<div id="cell-44" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1-[#6]-[#8]-C=O |Sg:n:6,7:2-4:ht:::|'</span>)</span>
<span id="cb35-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that the current rendering code does not automagically insert missing brackets (something we should fix), but we can see that the correct substance group type has been added:</p>
<div id="cell-46" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">sgs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.GetMolSubstanceGroups(m)</span>
<span id="cb36-2">sg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sgs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb36-3">sg.GetPropsAsDict()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>{'TYPE': 'SRU',
 '_cxsmilesindex': 0,
 'LABEL': '2-4',
 'CONNECT': 'HT',
 'XBHEAD': &lt;rdkit.rdBase._vectj at 0x78dfc975fb40&gt;,
 'XBCORR': &lt;rdkit.rdBase._vectj at 0x78dfc975f840&gt;,
 'index': 1}</code></pre>
</div>
</div>
<p>Here’s the same query provided as a mol block, so we can see the brackets:</p>
<div id="cell-48" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">qmb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb38-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  Mrv2401 02082507292D          </span></span>
<span id="cb38-3"></span>
<span id="cb38-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  0  0  0     0  0            999 V3000</span></span>
<span id="cb38-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN CTAB</span></span>
<span id="cb38-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 COUNTS 10 10 1 0 0</span></span>
<span id="cb38-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN ATOM</span></span>
<span id="cb38-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 C -9.3703 -7.3117 0 0</span></span>
<span id="cb38-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 C -10.7039 -8.0817 0 0</span></span>
<span id="cb38-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 C -10.7039 -9.6218 0 0</span></span>
<span id="cb38-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 C -9.3703 -10.3918 0 0</span></span>
<span id="cb38-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 C -8.0366 -9.6218 0 0</span></span>
<span id="cb38-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 C -8.0366 -8.0817 0 0</span></span>
<span id="cb38-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 C -6.7029 -7.3117 0 0</span></span>
<span id="cb38-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 O -5.3692 -8.0818 0 0</span></span>
<span id="cb38-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 C -4.0357 -7.3118 0 0</span></span>
<span id="cb38-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 O -4.0357 -5.7718 0 0</span></span>
<span id="cb38-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END ATOM</span></span>
<span id="cb38-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN BOND</span></span>
<span id="cb38-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 1 1 2</span></span>
<span id="cb38-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 2 2 2 3</span></span>
<span id="cb38-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 3 1 3 4</span></span>
<span id="cb38-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 4 2 4 5</span></span>
<span id="cb38-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 5 1 5 6</span></span>
<span id="cb38-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 6 2 1 6</span></span>
<span id="cb38-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 7 1 6 7</span></span>
<span id="cb38-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 8 1 7 8</span></span>
<span id="cb38-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 9 1 8 9</span></span>
<span id="cb38-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 10 2 9 10</span></span>
<span id="cb38-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END BOND</span></span>
<span id="cb38-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 BEGIN SGROUP</span></span>
<span id="cb38-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 1 SRU 0 ATOMS=(2 7 8) XBONDS=(2 7 9) BRKXYZ=(9 -5.2821 -6.9645 0 -</span></span>
<span id="cb38-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 -4.3581 -8.5649 0 0 0 0) BRKXYZ=(9 -6.7901 -8.429 0 -7.7141 -6.8286 0 -</span></span>
<span id="cb38-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 0 0 0) CONNECT=HT LABEL="2-4"</span></span>
<span id="cb38-35"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END SGROUP</span></span>
<span id="cb38-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  V30 END CTAB</span></span>
<span id="cb38-37"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">M  END</span></span>
<span id="cb38-38"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb38-39">qry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromMolBlock(qmb)</span>
<span id="cb38-40">qry</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And a quick demonstration that it actually works:</p>
<div id="cell-50" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">tmols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(smi) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> smi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1COC(=O)O'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1COCOC(=O)O'</span>,</span>
<span id="cb39-2">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1COCOCOC(=O)O'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1COCOCOCOC(=O)O'</span>,</span>
<span id="cb39-3">                                            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1COCOCOCOCOC(=O)O'</span>)]</span>
<span id="cb39-4">xqry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdGeneralizedSubstruct.CreateExtendedQueryMol(qry)</span>
<span id="cb39-5"></span>
<span id="cb39-6">highlights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb39-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tmols:</span>
<span id="cb39-8">    highlights.append(rdGeneralizedSubstruct.MolGetSubstructMatch(mol,xqry))</span>
<span id="cb39-9">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb39-10">dopts.useBWAtomPalette()</span>
<span id="cb39-11">legends <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'n=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)]</span>
<span id="cb39-12">Draw.MolsToGridImage(tmols,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>),legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>legends,</span>
<span id="cb39-13">                     highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>highlights,drawOptions<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dopts)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>tutorial</category>
  <category>substructure</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-02-08-more-on-generalized-substructure-search.html</guid>
  <pubDate>Fri, 07 Feb 2025 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/more-on-generalized-substructure-search-1.png" medium="image" type="image/png" height="48" width="144"/>
</item>
<item>
  <title>ChEMBL Document Similarity</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1.html</link>
  <description><![CDATA[ 




<p>For a couple of other ideas I want to explore, I need some “clumpy” sets of compounds: a group of compounds with a number of separate clusters of different sizes and cohesiveness (I’m not sure what the right word here is, I mean how tightly packed the cluster is). As I almost always do, I’m going to do this using data from ChEMBL and I will use groups of compounds from individual med chem papers as my clumps. Since I want clumpiness at different similarity ranges, I want to be able to find groups of “related” papers: papers with similar compounds. This post is a first step towards finding those related papers.</p>
<p>There’s an <a href="https://chembl.blogspot.com/2013/09/document-similarity-in-chembl.html">old ChEMBL blog post</a> about document similarity. Not too long after that, I did a <a href="https://rdkit.blogspot.com/2013/12/finding-related-documents-in-chembl.html">blog post</a> with a related approach. This time instead of looking at the number of highly similar compounds between papers, I’m going to look at the median similarity between the compounds the papers..</p>
<p>I start by comparing at the distribution of similarities between compounds in med chem papers to those between papers in order to demonstrate that there is a significant difference there. To do this I pick a random sample of 20000 documents with between 20 and 100 compounds and use the usual Morgan fingerprint with radius 2 (there are plots below for radius 3 as well).</p>
<p>Here are the distributions of the median compound similarities within the papers and the median similarities between 500K random pairs of papers:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/dc5d46f9-2-image.png" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<p>The plot also contains lines showing the threshold values for similarity between random compounds and related compounds taken from <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-05-21-similarity-search-thresholds.html">this blog post</a>. Unsurprisingly, the intra-paper similarity values tend to be significantly higher than the inter-paper similarity values. The intra-paper similarity values tend to be above the “related” threshold value while the inter-paper values are below the “random” threshold value.</p>
<p>Moving on to finding related documents. One simple measure for document similarity is to count how many exact matches they have in common. This isn’t particularly interesting for my purposes, so I chose to focus on pairs of documents that have high ratios of compounds that have similarities above the “related” threshold. Here’s the overall distribution for fraction of exact matches, and fraction of pairs above the “random” and “related” thresholds for a set of 20 million random document pairs:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/dc5d46f9-1-image-2.png" class="img-fluid figure-img"></p>
<figcaption>image-2.png</figcaption>
</figure>
</div>
<p>Looking through the papers with the highest “related” fraction shows that they contain peptides or other large molecules. This is less useful for me, so I’m going to come back to this in a follow-up post where I either limit the size of the compounds considered or use a count-based fingerprint to calculate similarity so that larger molecules don’t automatically have higher similarity scores.|</p>
<div id="b46a1e68" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdFingerprintGenerator</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb1-6">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataStructs</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-13">plt.style.use(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tableau-colorblind10'</span>)</span>
<span id="cb1-14"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb1-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> psycopg2</span>
<span id="cb1-16"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext sql</span>
<span id="cb1-17"></span>
<span id="cb1-18"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.4</code></pre>
</div>
</div>
<div id="5233a402" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>config SqlMagic.feedback <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span></code></pre></div>
</div>
<section id="data-collection" class="level1">
<h1>Data collection</h1>
<p>Start by getting a collection of documents with between 20 and 100 compounds; this is my normal heuristic for trying to get med chem papers.</p>
<div id="8759dc15" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-2">    select doc_id,count(distinct molregno) cnt into temporary table doc_compound_counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-3">      <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> docs join compound_records using (doc_id) join compound_structures using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb4-4">      group by (doc_id)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>[]</code></pre>
</div>
</div>
<div id="9e90d2b5" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb6-2">    select count(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> doc_compound_counts where cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>34821</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="f1877fd0" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">docs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-2">   select doc_id <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> doc_compound_counts tablesample bernoulli(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span>) repeatable (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8723346</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb8-3">    where cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> limit <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20000</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb8-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(docs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> * postgresql://localhost/chembl_35</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>20000</code></pre>
</div>
</div>
<p>Generate fingerprints for the compounds from the papers</p>
<div id="2e49fbf1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">fpg2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-2">fpg3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb11-3"></span>
<span id="cb11-4">fps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb11-5">fps3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb11-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> docs:</span>
<span id="cb11-7">    doc_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> doc_id[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb11-8">    pkls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-9">        select molregno,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-10">        where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:doc_id</span>
<span id="cb11-11">    ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.Mol(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].tobytes()) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pkls]</span>
<span id="cb11-12">    fps2[doc_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpg2.GetFingerprints(ms)</span>
<span id="cb11-13">    fps3[doc_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpg3.GetFingerprints(ms)</span></code></pre></div>
</div>
</section>
<section id="intra--and-inter-paper-similarity-distributions" class="level1">
<h1>Intra- and inter-paper similarity distributions</h1>
<p>Calculate intra-paper similarity distributions</p>
<div id="81949f6b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">sims2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb12-2">sims3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb12-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx,doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(docs):</span>
<span id="cb12-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> idx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>:</span>
<span id="cb12-5">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Done </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb12-6">    doc_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> doc_id[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb12-7">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb12-8">    fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps2[doc_id]</span>
<span id="cb12-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fps)):</span>
<span id="cb12-10">        a.extend(DataStructs.BulkTanimotoSimilarity(fps[i],fps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:i]))</span>
<span id="cb12-11">    sims2[doc_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(a,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span>
<span id="cb12-12">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb12-13">    fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps3[doc_id]</span>
<span id="cb12-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fps)):</span>
<span id="cb12-15">        a.extend(DataStructs.BulkTanimotoSimilarity(fps[i],fps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:i]))</span>
<span id="cb12-16">    sims3[doc_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(a,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span>
<span id="cb12-17">    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done 0
Done 1000
Done 2000
Done 3000
Done 4000
Done 5000
Done 6000
Done 7000
Done 8000
Done 9000
Done 10000
Done 11000
Done 12000
Done 13000
Done 14000
Done 15000
Done 16000
Done 17000
Done 18000
Done 19000</code></pre>
</div>
</div>
<div id="3db19079" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb14-2"></span>
<span id="cb14-3">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb14-4">plt.hist([[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims2.values()],[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims3.values()]],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mfp2'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mfp3'</span>]))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-5">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'median intra-doc similarity'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-6">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-7"></span>
<span id="cb14-8">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb14-9">plt.hist([[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims2.values()],[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims3.values()]],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mfp2'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mfp3'</span>]))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-10">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'95</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">% i</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ntra-doc similarity'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-11">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now calculate the inter-paper similarity distributions; I’ll choose 500,000 random pairs for this:</p>
<div id="25ee9cdf" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span></span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb15-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb15-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb15-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># from: https://stackoverflow.com/a/55245866</span></span>
<span id="cb15-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> decode(i):</span>
<span id="cb15-8">    k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.floor((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>math.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>i))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb15-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> k,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb15-10"></span>
<span id="cb15-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> rand_pairs(n,m):</span>
<span id="cb15-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> [decode(i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> random.sample(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),m)]</span>
<span id="cb15-13"></span>
<span id="cb15-14">pairs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rand_pairs(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(docs),target)</span>
<span id="cb15-15">pairs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(docs[i][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],docs[j][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pairs]</span>
<span id="cb15-16">       </span>
<span id="cb15-17">        </span>
<span id="cb15-18">inter_sims2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb15-19">related_sims2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb15-20">inter_sims3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb15-21">related_sims3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb15-22"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(target):</span>
<span id="cb15-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> idx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>(target<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>):</span>
<span id="cb15-24">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Done </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb15-25">    di,dj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pairs[idx]</span>
<span id="cb15-26">   </span>
<span id="cb15-27">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-28">    fpsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps2[di]</span>
<span id="cb15-29">    fpsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps2[dj]</span>
<span id="cb15-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsi)):</span>
<span id="cb15-31">        a.extend(DataStructs.BulkTanimotoSimilarity(fpsi[i],fpsj))</span>
<span id="cb15-32">    inter_sims2[(di,dj)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(a,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span>
<span id="cb15-33">    related_sims2[(di,dj)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsi),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsj))</span>
<span id="cb15-34"></span>
<span id="cb15-35">    a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-36">    fpsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps3[di]</span>
<span id="cb15-37">    fpsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps3[dj]</span>
<span id="cb15-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsi)):</span>
<span id="cb15-39">        a.extend(DataStructs.BulkTanimotoSimilarity(fpsi[i],fpsj))</span>
<span id="cb15-40">    inter_sims3[(di,dj)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(a,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span>
<span id="cb15-41">    related_sims3[(di,dj)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsi),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsj) )</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done 0
Done 25000
Done 50000
Done 75000
Done 100000
Done 125000
Done 150000
Done 175000
Done 200000
Done 225000
Done 250000
Done 275000
Done 300000
Done 325000
Done 350000
Done 375000
Done 400000
Done 425000
Done 450000
Done 475000</code></pre>
</div>
</div>
<p>Compare the intra- and inter-paper distributions.</p>
<p>The line labeled noise in the plot below is the “noise level” for the fingerprint - the 95% threshold for similarity between random compound. The dashed line labeled “related” is the threshold level for compounds which are related to each other. You can find more information about these definitions in <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-05-21-similarity-search-thresholds.html">this blog post</a></p>
<div id="818eccc8" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb17-2"></span>
<span id="cb17-3">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb17-4">plt.hist([[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims2.values()],[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.values()]],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb17-5">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intra-document'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inter-document'</span>]),density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-6">ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.ylim()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb17-7">plt.plot([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ymax],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k-'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'noise'</span>)</span>
<span id="cb17-8">plt.plot([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ymax],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'related'</span>)</span>
<span id="cb17-9">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'median mfp2 similarity'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-10">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-11"></span>
<span id="cb17-12">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb17-13">plt.hist([[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims2.values()],[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.values()]],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb17-14">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intra-document'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inter-document'</span>]),density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-15">ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.ylim()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb17-16">plt.plot([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.22</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ymax],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k-'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'noise'</span>)</span>
<span id="cb17-17">plt.plot([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ymax],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'related'</span>)</span>
<span id="cb17-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'95% mfp2 similarity'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-19">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Get just the first of those plots, because that’s what we’ll use in the summary above:</p>
<div id="339896ff" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb18-2"></span>
<span id="cb18-3">plt.hist([[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims2.values()],[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.values()]],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb18-4">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'intra-document'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'inter-document'</span>]),density<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-5">ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.ylim()[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb18-6">plt.plot([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ymax],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k-'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'noise'</span>)</span>
<span id="cb18-7">plt.plot([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,ymax],<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k--'</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'related'</span>)</span>
<span id="cb18-8">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'median mfp2 similarity'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-9">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="399ccbcf" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">np.quantile([x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> sims2.values()],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([0.48979592, 0.65753425, 0.7       , 0.78703901])</code></pre>
</div>
</div>
<div id="f1306f06" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">np.quantile([x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.values()],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>array([0.10227273, 0.14      , 0.15306122, 0.18390805])</code></pre>
</div>
</div>
</section>
<section id="finding-related-documents" class="level1">
<h1>Finding related documents</h1>
<p>Get the molregnos for the compounds in all the papers. We will use these to identify overlapping compounds and to retrieve the compounds themselves</p>
<div id="9af2b3b6" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">mrns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb23-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> docs:</span>
<span id="cb23-3">    doc_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> doc_id[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb23-4">    pkls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-5">        select molregno <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb23-6">        where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:doc_id</span>
<span id="cb23-7">    mrns[doc_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pkls]</span></code></pre></div>
</div>
<div id="6f97ab56" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(docs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(docs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>199990000</code></pre>
</div>
</div>
<p>I’ll look at 10,000,000 random pairs of documents:</p>
<div id="c3fe1474" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">pairs2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rand_pairs(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(docs),<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000000</span>)</span>
<span id="cb26-2">pairs2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(docs[i][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],docs[j][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pairs2]</span></code></pre></div>
</div>
<p>For each pair calculate the number of compounds in common and the fractions of compound pairs with similarity values above the random and related thresholds.</p>
<div id="855088d9" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">mrn_overlaps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-2">noise_sim_overlaps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-3">related_sim_overlaps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-4"></span>
<span id="cb27-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pairs2)):</span>
<span id="cb27-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> idx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(pairs2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>):</span>
<span id="cb27-7">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Done </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb27-8">    di,dj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pairs2[idx]</span>
<span id="cb27-9">   </span>
<span id="cb27-10">    mrnsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(mrns[di])</span>
<span id="cb27-11">    mrnsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(mrns[dj])</span>
<span id="cb27-12">    mrn_overlaps.append(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(mrnsi.intersection(mrnsj))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(mrnsi)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(mrnsj)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(mrnsi.intersection(mrnsj))))</span>
<span id="cb27-13">    </span>
<span id="cb27-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (di,dj) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> related_sims2:</span>
<span id="cb27-15">        a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-16">        fpsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps2[di]</span>
<span id="cb27-17">        fpsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fps2[dj]</span>
<span id="cb27-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsi)):</span>
<span id="cb27-19">            a.extend(DataStructs.BulkTanimotoSimilarity(fpsi[i],fpsj))</span>
<span id="cb27-20">        inter_sims2[(di,dj)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(a,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.99</span>])</span>
<span id="cb27-21">        related_sims2[(di,dj)] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> a <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsi),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fpsj))   </span>
<span id="cb27-22">    </span>
<span id="cb27-23">    noise,related,ni,nj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> related_sims2[(di,dj)]</span>
<span id="cb27-24">    denom <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ni<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>nj</span>
<span id="cb27-25">    noise_sim_overlaps.append(noise<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>denom)</span>
<span id="cb27-26">    related_sim_overlaps.append(related<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>denom)</span>
<span id="cb27-27">    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done 0
Done 500000
Done 1000000
Done 1500000
Done 2000000
Done 2500000
Done 3000000
Done 3500000
Done 4000000
Done 4500000
Done 5000000
Done 5500000
Done 6000000
Done 6500000
Done 7000000
Done 7500000
Done 8000000
Done 8500000
Done 9000000
Done 9500000</code></pre>
</div>
</div>
<div id="bcfb3652" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(inter_sims2),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.values() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> v[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.27</span>]),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.values() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> v[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>(10474902, 6329, 707)</code></pre>
</div>
</div>
<p>Look at the fraction of exact matches, the fraction of pairs of compounds with similarity above the random threshold, and the fraction of pairs of compounds with similarity above the related threshold:</p>
<div id="91d8e0ef" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb31-2"></span>
<span id="cb31-3">plt.hist([mrn_overlaps,noise_sim_overlaps,related_sim_overlaps],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,log<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb31-4">        label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mrns'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mfp2-nonrandom'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mfp2-related'</span>))</span>
<span id="cb31-5">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'compound overlap'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb31-6">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s look at an example with a high fraction of compounds above the noise level but a low fraction above the related level:</p>
<div id="69de3474" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">[(i,ovl,related_sim_overlaps[i]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,ovl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(noise_sim_overlaps) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ovl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>[(1606, 0.5188034188034188, 0.09487179487179487),
 (5770, 0.5236270753512133, 0.14431673052362706)]</code></pre>
</div>
</div>
<div id="32b04401" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">pairs2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1606</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(66679, 21372)</code></pre>
</div>
</div>
<div id="1af8926f" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">didi,didj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pairs2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1606</span>]</span>
<span id="cb36-2">pklsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-3">   select chembl_id,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-4">    join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-5">    where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:didi</span>
<span id="cb36-6">molsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(x,Chem.Mol(y.tobytes())) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pklsi]</span>
<span id="cb36-7">pklsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-8">   select chembl_id,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-9">    join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-10">    where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:didj</span>
<span id="cb36-11">molsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(x,Chem.Mol(y.tobytes())) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pklsj]</span></code></pre></div>
</div>
<div id="abfcf92c" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(molsi),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(molsj)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>(45, 26)</code></pre>
</div>
</div>
<div id="26874ab1" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">Draw.MolsToGridImage([y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsi][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsi],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="84e2527a" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">Draw.MolsToGridImage([y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsj][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsj],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Anb bibliographic info on those:</p>
<div id="7c5a4df0" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb41-2">    select doc_id,title,authors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> docs where doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (:didi,:didj)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">doc_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">authors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>9752</td>
<td>Synthesis and hypolipidemic activity of 2-substituted isobutyric acid derivatives.</td>
<td>Morishita S, Saito T, Hirai Y, Shoji M, Mishima Y, Kawakami M.</td>
</tr>
<tr class="even">
<td>15546</td>
<td>Synthesis and immunosuppressive activity of 2-substituted 2-aminopropane-1,3-diols and 2-aminoethanols.</td>
<td>Kiuchi M, Adachi K, Kohara T, Minoguchi M, Hanano T, Aoki Y, Mishina T, Arita M, Nakao N, Ohtsuki M, Hoshino Y, Teshima K, Chiba K, Sasaki S, Fujita T.</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Look about a pair with a high fraction of “related” structures but a small number of exact matches:</p>
<div id="46239c91" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">[(i,ovl,noise_sim_overlaps[i],mrn_overlaps[i]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,ovl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(related_sim_overlaps) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ovl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>][:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>[(6704, 0.7841269841269841, 0.9206349206349206, 0.0),
 (34215, 0.5823095823095823, 0.8341523341523341, 0.03508771929824561)]</code></pre>
</div>
</div>
<div id="de53f47d" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1">didi,didj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pairs2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6704</span>]</span>
<span id="cb44-2">pklsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb44-3">   select chembl_id,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb44-4">    join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb44-5">    where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:didi</span>
<span id="cb44-6">molsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(x,Chem.Mol(y.tobytes())) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pklsi]</span>
<span id="cb44-7">pklsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb44-8">   select chembl_id,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb44-9">    join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb44-10">    where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:didj</span>
<span id="cb44-11">molsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(x,Chem.Mol(y.tobytes())) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pklsj]</span>
<span id="cb44-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(molsi),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(molsj)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>(21, 30)</code></pre>
</div>
</div>
<div id="b696debe" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">Draw.MolsToGridImage([y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsi][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsi[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1430fc5c" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1">Draw.MolsToGridImage([y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsj][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsj[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="9800075d" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb48-2">    select doc_id,title,authors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> docs where doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (:didi,:didj)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">doc_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">authors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5559</td>
<td>Synthesis, stereochemical assignment and biological activity of a novel series of C-4" modified aza-macrolides.</td>
<td>Bronk BS, Letavic MA, Bertsche CD, George DM, Hayashi SF, Kamicker BJ, Kolosko NL, Norcia LJ, Rushing MA, Santoro SL, Yang BV.</td>
</tr>
<tr class="even">
<td>62283</td>
<td>Design, synthesis, and in vitro activity of novel 2'-O-substituted 15-membered azalides.</td>
<td>Pešić D, Starčević K, Toplak A, Herreros E, Vidal J, Almela MJ, Jelić D, Alihodžić S, Spaventi R, Perić M.</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Order the document pairs by the median inter-document similarity.</p>
<div id="830cab89" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1">ordered <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>((v[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],k) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k,v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inter_sims2.items())</span>
<span id="cb49-2">ordered.reverse()</span></code></pre></div>
</div>
<div id="2d74865f" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1">[(k,inter_sims2[k],related_sims2[k]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _,k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ordered[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>[((12331, 7482),
  array([0.83809524, 0.91428571, 0.96      , 1.        ]),
  (594, 594, 27, 22)),
 ((93472, 15907),
  array([0.76190476, 0.82279986, 0.85034014, 0.88860906]),
  (1656, 1656, 46, 36)),
 ((14825, 9122),
  array([0.73387097, 0.9380531 , 0.9826087 , 1.        ]),
  (1817, 1817, 79, 23)),
 ((31412, 6280),
  array([0.71590909, 0.77286602, 0.81410256, 0.87204231]),
  (651, 651, 31, 22)),
 ((42121, 13617),
  array([0.71551724, 0.8411215 , 0.86538462, 0.91116191]),
  (1711, 1711, 59, 30)),
 ((2880, 923),
  array([0.71028037, 0.7979798 , 0.82501752, 0.89473684]),
  (2470, 2470, 26, 95)),
 ((65011, 5969),
  array([0.70748299, 0.78516762, 0.82269504, 0.86639801]),
  (1081, 1081, 24, 47)),
 ((46543, 4410),
  array([0.703125  , 0.83928571, 0.85714286, 1.        ]),
  (575, 575, 23, 25)),
 ((98553, 55691),
  array([0.7029703 , 0.84946237, 0.88172043, 0.92391304]),
  (716, 716, 36, 30)),
 ((10959, 923),
  array([0.69194824, 0.83333333, 0.88282071, 1.        ]),
  (4370, 4368, 46, 95))]</code></pre>
</div>
</div>
<div id="0ea01f50" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1">didi,didj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ordered[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb52-2">pklsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb52-3">   select chembl_id,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb52-4">    join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb52-5">    where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:didi</span>
<span id="cb52-6">molsi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(x,Chem.Mol(y.tobytes())) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pklsi]</span>
<span id="cb52-7">pklsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb52-8">   select chembl_id,mol_to_pkl(m) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdk.mols join compound_records using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb52-9">    join chembl_id_lookup on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb52-10">    where doc_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:didj</span>
<span id="cb52-11">molsj <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(x,Chem.Mol(y.tobytes())) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pklsj]</span></code></pre></div>
</div>
<div id="cafe1852" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1">Draw.MolsToGridImage([y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsi][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsi[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="8c90f488" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1">Draw.MolsToGridImage([y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsj][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> molsj[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1_files/figure-html/cell-38-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a9a7adc6" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>localhost<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_35 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb55-2">    select doc_id,title,authors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> docs where doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (:didi,:didj)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<table class="caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">doc_id</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">authors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>7482</td>
<td>Synthesis of peptides by the solid-phase method. 7. Substance P and analogues.</td>
<td>Fournier A, Couture R, Regoli D, Gendreau M, St-Pierre S.</td>
</tr>
<tr class="even">
<td>12331</td>
<td>Design and synthesis of side-chain conformationally restricted phenylalanines and their use for structure-activity studies on tachykinin NK-1 receptor.</td>
<td>Josien H, Lavielle S, Brunissen A, Saffroy M, Torrens Y, Beaujouan JC, Glowinski J, Chassaing G.</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>I looked at a number of different highly ranked document pairs here and they all contain peptides or other fairly large molecules. This makes sense given that I am using a bit vector fingerprint for similarity, but isn’t ideal for what I am trying to do. In a followup post I will explore a bit deeper into the list of highly ranked documents and/or try using count-based fingerprints.</p>


</section>

 ]]></description>
  <category>exploration</category>
  <category>similarity</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-02-02-chembl-document-similarity-1.html</guid>
  <pubDate>Sat, 01 Feb 2025 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/chembl-document-similarity-1-1.png" medium="image" type="image/png" height="80" width="144"/>
</item>
<item>
  <title>A tutorial on properties</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-01-24-property-tutorial.html</link>
  <description><![CDATA[ 




<p>RDKit molecules, atoms, bonds, conformers, and reactions support an interface, we call it the property interface, for storing arbitrary data that is used a lot internally but that can also very useful in other code. This post provides a quick overview of how properties work and what you can do with them</p>
<div id="836e4ab4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.4</code></pre>
</div>
</div>
<section id="property-basics" class="level1">
<h1>Property basics</h1>
<p>The properties are stored in a key:value data structure (similar to a dictionary in Python). The keys must be strings but the values can be various types.</p>
<p>One obvious use of properties is to store the additional data found in an SDF file on the molecule. Here’s an example of that:</p>
<div id="9a6ddf4b" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gzip</span>
<span id="cb3-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> gzip.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/scratch/Data/PubChem/Compound_004500001_005000000.sdf.gz'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> inf:</span>
<span id="cb3-3">    suppl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.ForwardSDMolSupplier(inf)</span>
<span id="cb3-4">    ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(suppl) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)]</span></code></pre></div>
</div>
<p>We can get a list of the properties present:</p>
<div id="de2f3675" class="cell" data-scrolled="true" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb4-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m.GetPropNames())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>['PUBCHEM_COMPOUND_CID',
 'PUBCHEM_COMPOUND_CANONICALIZED',
 'PUBCHEM_CACTVS_COMPLEXITY',
 'PUBCHEM_CACTVS_HBOND_ACCEPTOR',
 'PUBCHEM_CACTVS_HBOND_DONOR',
 'PUBCHEM_CACTVS_ROTATABLE_BOND',
 'PUBCHEM_CACTVS_SUBSKEYS',
 'PUBCHEM_IUPAC_OPENEYE_NAME',
 'PUBCHEM_IUPAC_CAS_NAME',
 'PUBCHEM_IUPAC_NAME_MARKUP',
 'PUBCHEM_IUPAC_NAME',
 'PUBCHEM_IUPAC_SYSTEMATIC_NAME',
 'PUBCHEM_IUPAC_TRADITIONAL_NAME',
 'PUBCHEM_IUPAC_INCHI',
 'PUBCHEM_IUPAC_INCHIKEY',
 'PUBCHEM_XLOGP3_AA',
 'PUBCHEM_EXACT_MASS',
 'PUBCHEM_MOLECULAR_FORMULA',
 'PUBCHEM_MOLECULAR_WEIGHT',
 'PUBCHEM_OPENEYE_CAN_SMILES',
 'PUBCHEM_OPENEYE_ISO_SMILES',
 'PUBCHEM_CACTVS_TPSA',
 'PUBCHEM_MONOISOTOPIC_WEIGHT',
 'PUBCHEM_TOTAL_CHARGE',
 'PUBCHEM_HEAVY_ATOM_COUNT',
 'PUBCHEM_ATOM_DEF_STEREO_COUNT',
 'PUBCHEM_ATOM_UDEF_STEREO_COUNT',
 'PUBCHEM_BOND_DEF_STEREO_COUNT',
 'PUBCHEM_BOND_UDEF_STEREO_COUNT',
 'PUBCHEM_ISOTOPIC_ATOM_COUNT',
 'PUBCHEM_COMPONENT_COUNT',
 'PUBCHEM_CACTVS_TAUTO_COUNT',
 'PUBCHEM_COORDINATE_TYPE',
 'PUBCHEM_BONDANNOTATIONS']</code></pre>
</div>
</div>
<p>And then retrieve the property values themselves with <code>GetProp()</code>:</p>
<div id="bbcdfde7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_MOLECULAR_WEIGHT'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>'516.3'</code></pre>
</div>
</div>
<p><code>GetProp()</code> returns the property values as strings, but we can also get them as specific types by asking for the type:</p>
<div id="e8558c51" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">m.GetDoubleProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_MOLECULAR_WEIGHT'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>516.3</code></pre>
</div>
</div>
<div id="d401b3db" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">m.GetIntProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_HEAVY_ATOM_COUNT'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>31</code></pre>
</div>
</div>
<p>The retrieval functions currently supported on molecules are: - <code>GetProp()</code> -&gt; string - <code>GetDoubleProp()</code> -&gt; floating point - <code>GetIntProp()</code> -&gt; integer - <code>GetUnsignedProp()</code> -&gt; unsigned integer - <code>GetBoolProp()</code> -&gt; boolean</p>
<p>It’s possible to retrieve all of the properties, with the correct types, in one call:</p>
<div id="368ad3b9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">m.GetPropsAsDict()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>{'PUBCHEM_COMPOUND_CID': 4500001,
 'PUBCHEM_COMPOUND_CANONICALIZED': 1,
 'PUBCHEM_CACTVS_COMPLEXITY': 626,
 'PUBCHEM_CACTVS_HBOND_ACCEPTOR': 4,
 'PUBCHEM_CACTVS_HBOND_DONOR': 1,
 'PUBCHEM_CACTVS_ROTATABLE_BOND': 7,
 'PUBCHEM_CACTVS_SUBSKEYS': 'AAADceB7oABHAAAAAAAAAAAAGAAAAWAAAAAwYAAAAAAAAAAB0AAAHgYYAAAADQrF2ySz0IfMEAiqAidydACS0AthB7AdykA4ZoiIKCLBm5HEIAhgnALIyAcQgMAOhABQAAKAABQIAKAABQAAKAAAAAAAAA==',
 'PUBCHEM_IUPAC_OPENEYE_NAME': '2-[[5-[2-(4-chlorophenyl)cyclopropyl]-4-ethyl-1,2,4-triazol-3-yl]sulfanyl]-N-(2,4,5-trichlorophenyl)acetamide',
 'PUBCHEM_IUPAC_CAS_NAME': '2-[[5-[2-(4-chlorophenyl)cyclopropyl]-4-ethyl-1,2,4-triazol-3-yl]thio]-N-(2,4,5-trichlorophenyl)acetamide',
 'PUBCHEM_IUPAC_NAME_MARKUP': '2-[[5-[2-(4-chlorophenyl)cyclopropyl]-4-ethyl-1,2,4-triazol-3-yl]sulfanyl]-&lt;I&gt;N&lt;/I&gt;-(2,4,5-trichlorophenyl)acetamide',
 'PUBCHEM_IUPAC_NAME': '2-[[5-[2-(4-chlorophenyl)cyclopropyl]-4-ethyl-1,2,4-triazol-3-yl]sulfanyl]-N-(2,4,5-trichlorophenyl)acetamide',
 'PUBCHEM_IUPAC_SYSTEMATIC_NAME': '2-[[5-[2-(4-chlorophenyl)cyclopropyl]-4-ethyl-1,2,4-triazol-3-yl]sulfanyl]-N-[2,4,5-tris(chloranyl)phenyl]ethanamide',
 'PUBCHEM_IUPAC_TRADITIONAL_NAME': '2-[[5-[2-(4-chlorophenyl)cyclopropyl]-4-ethyl-1,2,4-triazol-3-yl]thio]-N-(2,4,5-trichlorophenyl)acetamide',
 'PUBCHEM_IUPAC_INCHI': 'InChI=1S/C21H18Cl4N4OS/c1-2-29-20(14-7-13(14)11-3-5-12(22)6-4-11)27-28-21(29)31-10-19(30)26-18-9-16(24)15(23)8-17(18)25/h3-6,8-9,13-14H,2,7,10H2,1H3,(H,26,30)',
 'PUBCHEM_IUPAC_INCHIKEY': 'JGFAHFCLMPEOJM-UHFFFAOYSA-N',
 'PUBCHEM_XLOGP3_AA': 6,
 'PUBCHEM_EXACT_MASS': 515.992593,
 'PUBCHEM_MOLECULAR_FORMULA': 'C21H18Cl4N4OS',
 'PUBCHEM_MOLECULAR_WEIGHT': 516.3,
 'PUBCHEM_OPENEYE_CAN_SMILES': 'CCN1C(=NN=C1SCC(=O)NC2=CC(=C(C=C2Cl)Cl)Cl)C3CC3C4=CC=C(C=C4)Cl',
 'PUBCHEM_OPENEYE_ISO_SMILES': 'CCN1C(=NN=C1SCC(=O)NC2=CC(=C(C=C2Cl)Cl)Cl)C3CC3C4=CC=C(C=C4)Cl',
 'PUBCHEM_CACTVS_TPSA': 85.1,
 'PUBCHEM_MONOISOTOPIC_WEIGHT': 513.995543,
 'PUBCHEM_TOTAL_CHARGE': 0,
 'PUBCHEM_HEAVY_ATOM_COUNT': 31,
 'PUBCHEM_ATOM_DEF_STEREO_COUNT': 0,
 'PUBCHEM_ATOM_UDEF_STEREO_COUNT': 2,
 'PUBCHEM_BOND_DEF_STEREO_COUNT': 0,
 'PUBCHEM_BOND_UDEF_STEREO_COUNT': 0,
 'PUBCHEM_ISOTOPIC_ATOM_COUNT': 0,
 'PUBCHEM_COMPONENT_COUNT': 1,
 'PUBCHEM_CACTVS_TAUTO_COUNT': -1,
 'PUBCHEM_COORDINATE_TYPE': '1\n5\n255',
 'PUBCHEM_BONDANNOTATIONS': '11  14  3\n12  15  3\n15  16  8\n15  17  8\n16  20  8\n17  21  8\n20  22  8\n21  22  8\n26  27  8\n26  28  8\n27  30  8\n28  29  8\n29  31  8\n30  31  8\n7  14  8\n7  19  8\n8  14  8\n8  9  8\n9  19  8'}</code></pre>
</div>
</div>
<p>You can check whether or not a property is there:</p>
<div id="1617f911" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">m.HasProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'foo'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0</code></pre>
</div>
</div>
<p>Asking for a property that’s not present throws an exception:</p>
<div id="e21bbab5" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'foo'</span>)</span></code></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyError</span>                                  Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[9], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">m</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">GetProp</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">foo</span><span style="color:rgb(175,0,0)" class="ansi-yellow-bg">'</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">KeyError</span>: 'foo'</pre>
</div>
</div>
</div>
<p>And you can remove properties:</p>
<div id="d5e9e7df" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">m.ClearProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_HEAVY_ATOM_COUNT'</span>)</span>
<span id="cb17-2">m.HasProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_HEAVY_ATOM_COUNT'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>0</code></pre>
</div>
</div>
</section>
<section id="special-property-types" class="level1">
<h1>Special property types</h1>
<p>Properties whose names start with an underscore - <code>_</code> - are considered to be private and any property can be marked as computed. These properties are not displayed by default by calls to <code>GetPropNames()</code> or <code>GetPropsAsDict()</code> for molecules.</p>
<p>One frequently used private property is <code>_Name</code>, which is read from the header of mol files:</p>
<div id="be698c2d" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_Name'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>'4500001'</code></pre>
</div>
</div>
<p>You can see the full list of property names by passing the <code>includePrivate</code> and <code>includeComputed</code> flags to <code>GetPropNames()</code> or <code>GetPropsAsDict()</code>:</p>
<div id="833de550" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m.GetPropNames(includePrivate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>['__computedProps',
 '_Name',
 '_MolFileInfo',
 '_MolFileComments',
 '_MolFileChiralFlag',
 'numArom',
 '_StereochemDone',
 'PUBCHEM_COMPOUND_CID',
 'PUBCHEM_COMPOUND_CANONICALIZED',
 'PUBCHEM_CACTVS_COMPLEXITY',
 'PUBCHEM_CACTVS_HBOND_ACCEPTOR',
 'PUBCHEM_CACTVS_HBOND_DONOR',
 'PUBCHEM_CACTVS_ROTATABLE_BOND',
 'PUBCHEM_CACTVS_SUBSKEYS',
 'PUBCHEM_IUPAC_OPENEYE_NAME',
 'PUBCHEM_IUPAC_CAS_NAME',
 'PUBCHEM_IUPAC_NAME_MARKUP',
 'PUBCHEM_IUPAC_NAME',
 'PUBCHEM_IUPAC_SYSTEMATIC_NAME',
 'PUBCHEM_IUPAC_TRADITIONAL_NAME',
 'PUBCHEM_IUPAC_INCHI',
 'PUBCHEM_IUPAC_INCHIKEY',
 'PUBCHEM_XLOGP3_AA',
 'PUBCHEM_EXACT_MASS',
 'PUBCHEM_MOLECULAR_FORMULA',
 'PUBCHEM_MOLECULAR_WEIGHT',
 'PUBCHEM_OPENEYE_CAN_SMILES',
 'PUBCHEM_OPENEYE_ISO_SMILES',
 'PUBCHEM_CACTVS_TPSA',
 'PUBCHEM_MONOISOTOPIC_WEIGHT',
 'PUBCHEM_TOTAL_CHARGE',
 'PUBCHEM_ATOM_DEF_STEREO_COUNT',
 'PUBCHEM_ATOM_UDEF_STEREO_COUNT',
 'PUBCHEM_BOND_DEF_STEREO_COUNT',
 'PUBCHEM_BOND_UDEF_STEREO_COUNT',
 'PUBCHEM_ISOTOPIC_ATOM_COUNT',
 'PUBCHEM_COMPONENT_COUNT',
 'PUBCHEM_CACTVS_TAUTO_COUNT',
 'PUBCHEM_COORDINATE_TYPE',
 'PUBCHEM_BONDANNOTATIONS']</code></pre>
</div>
</div>
</section>
<section id="adding-your-own-properties" class="level1">
<h1>Adding your own properties</h1>
<p>I’m demonstrating this for molecules, but the same thing works for the other types.</p>
<div id="405a2e1d" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CCC'</span>)</span>
<span id="cb23-2">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prop1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val1'</span>)</span>
<span id="cb23-3">m.SetIntProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prop2'</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb23-4">m.SetDoubleProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prop3'</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.14159</span>)</span>
<span id="cb23-5"></span>
<span id="cb23-6">m.GetPropsAsDict()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>{'prop1': 'val1', 'prop2': 2, 'prop3': 3.14159}</code></pre>
</div>
</div>
<div id="a2b66cc6" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'computed1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>, computed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb25-2">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_private1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>, computed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb25-3"></span>
<span id="cb25-4">m.GetPropsAsDict()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>{'prop1': 'val1', 'prop2': 2, 'prop3': 3.14159}</code></pre>
</div>
</div>
<div id="7f64ec89" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">m.GetPropsAsDict(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>{'numArom': 0,
 'prop1': 'val1',
 'prop2': 2,
 'prop3': 3.14159,
 'computed1': 'val'}</code></pre>
</div>
</div>
<div id="ea939262" class="cell" data-scrolled="true" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">m.GetPropsAsDict(includePrivate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>{'__computedProps': &lt;rdkit.rdBase._vectNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE at 0x7b88e3f5f040&gt;,
 'numArom': 0,
 '_StereochemDone': 1,
 'prop1': 'val1',
 'prop2': 2,
 'prop3': 3.14159,
 'computed1': 'val',
 '_private1': 'val'}</code></pre>
</div>
</div>
</section>
<section id="properties-and-copyingserializationpickling" class="level1">
<h1>Properties and copying/serialization/pickling</h1>
<div id="ca2d0799" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC'</span>)</span>
<span id="cb31-2">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prop1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'v1'</span>)</span>
<span id="cb31-3">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'computed1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'v2'</span>)</span>
<span id="cb31-4">m.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).SetIntProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'aprop'</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p>Properties are copied when molecules are copied, either using the RDKit’s recommended approach:</p>
<div id="a4923ef2" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(m)</span>
<span id="cb32-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mol:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span>
<span id="cb32-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atom:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mol: ['numArom', 'prop1', 'computed1']
atom: ['aprop']</code></pre>
</div>
</div>
<p>Or using the <code>copy</code> module:</p>
<div id="77d20331" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> copy</span>
<span id="cb34-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(m)</span>
<span id="cb34-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mol:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span>
<span id="cb34-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atom:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mol: ['numArom', 'prop1', 'computed1']
atom: ['aprop']</code></pre>
</div>
</div>
<p>Properties are not, by default, captured when molecules are serialized (converted to binary):</p>
<div id="77abdc83" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(m.ToBinary())</span>
<span id="cb36-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mol:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span>
<span id="cb36-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atom:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mol: []
atom: []</code></pre>
</div>
</div>
<p>But you can change this:</p>
<div id="0d2eb21c" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(m.ToBinary(Chem.PropertyPickleOptions.AllProps))</span>
<span id="cb38-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mol:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span>
<span id="cb38-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atom:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mol: ['numArom', 'prop1', 'computed1']
atom: ['aprop']</code></pre>
</div>
</div>
<p>And finally, Python’s pickling tool does not serialize properties by default:</p>
<div id="5d59efe5" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb40-2"></span>
<span id="cb40-3">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.loads(pickle.dumps(m))</span>
<span id="cb40-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mol:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span>
<span id="cb40-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atom:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mol: []
atom: []</code></pre>
</div>
</div>
<p>But you can change this with a global variable:</p>
<div id="7bc1c20b" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">Chem.SetDefaultPickleProperties(Chem.PropertyPickleOptions.AllProps)</span>
<span id="cb42-2"></span>
<span id="cb42-3">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.loads(pickle.dumps(m))</span>
<span id="cb42-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mol:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span>
<span id="cb42-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'atom:'</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(m2.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).GetPropNames(includeComputed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mol: ['numArom', 'prop1', 'computed1']
atom: ['aprop']</code></pre>
</div>
</div>
</section>
<section id="writing-properties" class="level1">
<h1>Writing properties</h1>
<p>Both the <code>SDWriter</code> and the <code>SmilesWriter</code> can write properties</p>
<div id="0c5cb868" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StringIO</span>
<span id="cb44-2">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC'</span>)</span>
<span id="cb44-3">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prop1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'v1'</span>)</span>
<span id="cb44-4">m.SetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'computed1'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'v2'</span>)</span></code></pre></div>
</div>
<p>The SDWriter will by default write all non-private properties (include computed properties):</p>
<div id="16367d18" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">sio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StringIO()</span>
<span id="cb45-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Chem.SDWriter(sio) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> w:</span>
<span id="cb45-3">    w.write(m)</span>
<span id="cb45-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(sio.getvalue())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     RDKit          2D

  2  1  0  0  0  0  0  0  0  0999 V2000
    0.0000    0.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.2990    0.7500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  1  0
M  END
&gt;  &lt;prop1&gt;  (1) 
v1

&gt;  &lt;computed1&gt;  (1) 
v2

$$$$
</code></pre>
</div>
</div>
<p>But you can control which properties are written:</p>
<div id="911a2929" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1">sio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StringIO()</span>
<span id="cb47-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Chem.SDWriter(sio) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> w:</span>
<span id="cb47-3">    w.SetProps([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prop1'</span>])</span>
<span id="cb47-4">    w.write(m)</span>
<span id="cb47-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(sio.getvalue())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     RDKit          2D

  2  1  0  0  0  0  0  0  0  0999 V2000
    0.0000    0.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
    1.2990    0.7500    0.0000 C   0  0  0  0  0  0  0  0  0  0  0  0
  1  2  1  0
M  END
&gt;  &lt;prop1&gt;  (1) 
v1

$$$$
</code></pre>
</div>
</div>
<p>The <code>SmilesWriter</code> doesn’t write properties by default, but we can tell it to:</p>
<div id="4482c4a0" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1">sio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StringIO()</span>
<span id="cb49-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Chem.SmilesWriter(sio) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> w:</span>
<span id="cb49-3">    w.SetProps(m.GetPropNames())</span>
<span id="cb49-4">    w.write(m)</span>
<span id="cb49-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(sio.getvalue())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SMILES Name prop1 computed1
CC 0 v1 v2
</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>tutorial</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-01-24-property-tutorial.html</guid>
  <pubDate>Thu, 23 Jan 2025 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Efficient molecule editing</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing.html</link>
  <description><![CDATA[ 




<p>This is another tutorial post, this time looking at editing molecules: adding and removing atoms and bonds.</p>
<div id="c2ecfdb3" class="cell" data-scrolled="true" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.4</code></pre>
</div>
</div>
<div id="d0a6c4e1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">IPythonConsole.drawOptions.addAtomIndices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb3-2">IPythonConsole.molSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span></span></code></pre></div>
</div>
<div id="04e159ff" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1c(Cl)cc(F)cc1O'</span>)</span>
<span id="cb4-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="removing-atoms-and-bonds" class="level2">
<h2 class="anchored" data-anchor-id="removing-atoms-and-bonds">Removing atoms and bonds</h2>
<p>If we want to add or remove atoms and bonds we construct an <code>RWMol</code> (a Read/Write molecule) and then call <code>RemoveAtom()</code>:</p>
<div id="a3a333a7" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m)</span>
<span id="cb5-2">rwm.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb5-3">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>To remove bonds, we provide the atom indices:</p>
<div id="5c2c3963" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">rwm.RemoveBond(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb6-2">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This is a bit awkward since atom numbers change when we remove atoms. We can see this by getting a new copy of the original molecule and removing atom 2:</p>
<div id="f83966df" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m)</span>
<span id="cb7-2">rwm.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-3">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now the O is atom 7 instead of being atom 8 and atoms 4 and 5 are no longer connected (the bond we want is between atoms 3 and 4).</p>
<p>So when working this way, we need to be sure to remove the atoms in order of decreasing atomic index, and to remove bonds before we remove atoms. Otherwise we get errors or incorrect results:</p>
<div id="53517ba2" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">rwm.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:24:31] 

****
Range Error
idx
Violation occurred on line 209 in file /home/conda/feedstock_root/build_artifacts/rdkit-meta_1736094075412/work/Code/GraphMol/ROMol.cpp
Failed Expression: 8 &lt; 8
----------
Stacktrace:
 0# Invar::Invariant::toString[abi:cxx11]() const in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libRDKitRDGeneral.so.1
 1# Invar::operator&lt;&lt;(std::ostream&amp;, Invar::Invariant const&amp;) in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libRDKitRDGeneral.so.1
 2# RDKit::ROMol::getAtomWithIdx(unsigned int) in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/../../../../libRDKitGraphMol.so.1
 3# RDKit::RWMol::removeAtom(unsigned int) in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/../../../../libRDKitGraphMol.so.1
 4# 0x0000735214F7531E in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
 5# boost::python::objects::function::call(_object*, _object*) const in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libboost_python312.so.1.86.0
 6# 0x00007353092E0779 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libboost_python312.so.1.86.0
 7# boost::python::detail::exception_handler::operator()(boost::function_n&lt;void&gt; const&amp;) const in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libboost_python312.so.1.86.0
 8# 0x00007352EA17E134 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdChemReactions.so
 9# 0x00007352EA17E184 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdChemReactions.so
10# 0x00007352F7582864 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdDepictor.so
11# 0x0000735300D1DD14 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdmolfiles.so
12# 0x0000735300D1DD64 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdmolfiles.so
13# 0x0000735309C0A8E4 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdCIPLabeler.so
14# 0x0000735214F76EF4 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
15# 0x0000735214F09CBD in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
16# 0x0000735214F0992D in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
17# 0x0000735214F0959D in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
18# 0x0000735214F0920D in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
19# 0x0000735214F08E7D in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/Chem/rdchem.so
20# 0x0000735308652C04 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/rdBase.so
21# 0x0000735308652C54 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/rdBase.so
22# 0x0000735308652CA4 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/rdBase.so
23# 0x0000735308652CF4 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/rdBase.so
24# boost::python::handle_exception_impl(boost::function_n&lt;void&gt;) in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libboost_python312.so.1.86.0
25# 0x00007353092DD3B3 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/site-packages/rdkit/../../../libboost_python312.so.1.86.0
26# _PyObject_MakeTpCall in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
27# 0x000055BEF1BF62F7 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
28# PyEval_EvalCode in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
29# 0x000055BEF1DB9E2E in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
30# 0x000055BEF1BF6BE4 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
31# 0x000055BEF1DB490F in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
32# 0x000055BEF1DB5BC7 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
33# 0x000055BEF1BF7A8E in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
34# 0x000055BEF1D34E4C in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
35# 0x000055BEF1D3492E in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
36# _PyObject_Call in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
37# 0x000055BEF1BF6F8F in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
38# 0x000055BEF1DB490F in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
39# 0x000073530CAA225C in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/lib-dynload/_asyncio.cpython-312-x86_64-linux-gnu.so
40# 0x000073530CAA29E5 in /home/glandrum/mambaforge/envs/rdkit_blog/lib/python3.12/lib-dynload/_asyncio.cpython-312-x86_64-linux-gnu.so
41# 0x000055BEF1D0635C in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
42# 0x000055BEF1E30D5C in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
43# 0x000055BEF1CA7F90 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
44# 0x000055BEF1CFC86B in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
45# 0x000055BEF1BF6F8F in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
46# PyEval_EvalCode in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
47# 0x000055BEF1DB9E2E in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
48# 0x000055BEF1CFC86B in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
49# PyObject_Vectorcall in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
50# 0x000055BEF1BF62F7 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
51# 0x000055BEF1DCEE48 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
52# Py_RunMain in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
53# Py_BytesMain in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
54# 0x000073530D829D90 in /lib/x86_64-linux-gnu/libc.so.6
55# __libc_start_main in /lib/x86_64-linux-gnu/libc.so.6
56# 0x000055BEF1D87131 in /home/glandrum/mambaforge/envs/rdkit_blog/bin/python
----------
****
</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[7], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-yellow-bg">rwm</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">RemoveAtom</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">8</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">RuntimeError</span>: Range Error
    idx
    Violation occurred on line 209 in file Code/GraphMol/ROMol.cpp
    Failed Expression: 8 &lt; 8
    RDKIT: 2024.09.4
    BOOST: 
</pre>
</div>
</div>
</div>
<div id="a8c055b4" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">rwm.RemoveBond(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># nothing happens since there is no bond to remove</span></span>
<span id="cb10-2">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Since that’s all kind of a pain, a few years ago we added functionality to allow you to batch the removal of atoms and bonds. The atoms and bonds are not removed until the batch is finished:</p>
<div id="8a2b4020" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m)</span>
<span id="cb11-2">rwm.BeginBatchEdit() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># start a batch</span></span>
<span id="cb11-3">rwm.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb11-4">rwm.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb11-5">rwm.RemoveBond(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb11-6">rwm.CommitBatchEdit()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># finish the batch</span></span>
<span id="cb11-7">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This has the added benefit of being a bit faster.</p>
<p>Finally, when we are done modifying the molecule, we can easily convert back to standard RDKit molecule:</p>
<div id="75fe9862" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetMol()</span>
<span id="cb12-2">Chem.SanitizeMol(m2)</span>
<span id="cb12-3">m2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adding-atoms-and-bonds" class="level2">
<h2 class="anchored" data-anchor-id="adding-atoms-and-bonds">Adding atoms and bonds</h2>
<p>Here’s there’s no equivalent of batch editing, but it’s less important</p>
<div id="57f6549e" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccc(O)cc1'</span>)</span>
<span id="cb13-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4346af3c" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m)</span>
<span id="cb14-2"></span>
<span id="cb14-3">rwm.AddAtom(Chem.Atom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>7</code></pre>
</div>
</div>
<p>That’s the new atom index, which we can directly use:</p>
<div id="2e200958" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">rwm.AddBond(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,Chem.BondType.SINGLE)</span>
<span id="cb16-2">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the chemistry is wrong here (it’s still showing an implicit H on the O), but sanitization will clear this up:</p>
<div id="d5c0d57b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetMol()</span>
<span id="cb17-2">Chem.SanitizeMol(m2)</span>
<span id="cb17-3">m2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="replacing-atoms-and-bonds" class="level1">
<h1>Replacing atoms and bonds</h1>
<p>This is an easy onea</p>
<div id="c7354cad" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccc(C(O)C)cc1'</span>)</span>
<span id="cb18-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ae9b4197" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m)</span>
<span id="cb19-2">rwm.ReplaceAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,Chem.Atom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>))</span>
<span id="cb19-3">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>ReplaceBond()</code> is marginally trickier since, for technical reasons, it’s not possible to directly construct a bond in Python:</p>
<div id="150268e5" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">tempMol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C=C"</span>)</span>
<span id="cb20-2">bnd <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tempMol.GetBondWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb20-3"></span>
<span id="cb20-4">rwm.ReplaceBond(rwm.GetBondBetweenAtoms(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>).GetIdx(),bnd)</span>
<span id="cb20-5">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="some-gotchas" class="level2">
<h2 class="anchored" data-anchor-id="some-gotchas">Some gotchas</h2>
<p>The most likely way to end up with molecules that are in an unhappy state, even though you’ve done (mostly) everything right, involve aromatic heteroatoms. This will come as no surprise if you’ve spent much time working with chemistry in the computer.</p>
<p>Here’s an example:</p>
<div id="7e980b20" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1cccn1C'</span>)</span>
<span id="cb21-2">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d1a14d5c" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m)</span>
<span id="cb22-2">rwm.BeginBatchEdit()</span>
<span id="cb22-3">rwm.RemoveAtom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb22-4">rwm.CommitBatchEdit()</span>
<span id="cb22-5">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>That looks ok, but we can’t sanitize it:</p>
<div id="09eb5f80" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetMol()</span>
<span id="cb23-2">Chem.SanitizeMol(m2)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:24:37] Can't kekulize mol.  Unkekulized atoms: 0 1 2 3 4</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KekulizeException</span>                         Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[20], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> m2 <span style="color:rgb(98,98,98)">=</span> rwm<span style="color:rgb(98,98,98)">.</span>GetMol()
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">Chem</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">SanitizeMol</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">m2</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">KekulizeException</span>: Can't kekulize mol.  Unkekulized atoms: 0 1 2 3 4</pre>
</div>
</div>
</div>
<p>This fails because we removed a bond from the aromatic N without updating its implicit H count. We can fix that:</p>
<div id="6d653d56" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">at <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) </span>
<span id="cb25-2">at.SetNoImplicit(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb25-3">at.SetNumExplicitHs(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb25-4"></span>
<span id="cb25-5">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetMol()</span>
<span id="cb25-6">Chem.SanitizeMol(m2)</span>
<span id="cb25-7">m2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>A similar problem happens when we add bonds to aromatic heteroatoms:</p>
<div id="714dfb82" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m2)</span>
<span id="cb26-2">aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.AddAtom(Chem.Atom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb26-3">rwm.AddBond(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,aid,Chem.BondType.SINGLE)</span>
<span id="cb26-4">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ce4345ce" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetMol()</span>
<span id="cb27-2">Chem.SanitizeMol(m3)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:24:38] Explicit valence for atom # 4 N, 5, is greater than permitted</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AtomValenceException</span>                      Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[23], line 2</span>
<span class="ansi-green-fg ansi-bold">      1</span> m3 <span style="color:rgb(98,98,98)">=</span> rwm<span style="color:rgb(98,98,98)">.</span>GetMol()
<span class="ansi-green-fg">----&gt; 2</span> <span class="ansi-yellow-bg">Chem</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">SanitizeMol</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">m3</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg">AtomValenceException</span>: Explicit valence for atom # 4 N, 5, is greater than permitted</pre>
</div>
</div>
</div>
<p>The fix, once again, is to update the implicit H parameters on the aromatic heteroatom:</p>
<div id="e8036ec3" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">rwm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RWMol(m2)</span>
<span id="cb29-2">aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.AddAtom(Chem.Atom(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb29-3">rwm.AddBond(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,aid,Chem.BondType.SINGLE)</span>
<span id="cb29-4">at <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetAtomWithIdx(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb29-5">at.SetNumExplicitHs(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb29-6">at.SetNoImplicit(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb29-7">rwm</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ef501ce9" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rwm.GetMol()</span>
<span id="cb30-2">Chem.SanitizeMol(m3)</span>
<span id="cb30-3">m3</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As usual, I hope this was useful.</p>


</section>
</section>

 ]]></description>
  <category>tutorial</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-01-18-efficient-molecule-editing.html</guid>
  <pubDate>Fri, 17 Jan 2025 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Using custom atom and bond invariants with fingerprint generators</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2025-01-10-fp-generators-and-invariants.html</link>
  <description><![CDATA[ 




<p>When using the RDKit fingerprint generators - there is a <a href="https://greglandrum.github.io/rdkit-blog/posts/2023-01-18-fingerprint-generator-tutorial.html">tutorial on using these</a> - it’s possible to change the invariants that are used to describe the atoms and/or bonds. This post provides a short intro to how to do that.</p>
<div id="3f29d538" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdFingerprintGenerator</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataStructs</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.4</code></pre>
</div>
</div>
<p>For this blog post I’m going to use the Morgan fingerprint generator, but this approach works for any fingerprint generator.</p>
<div id="d9e41629" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator()</span></code></pre></div>
</div>
<p>We’ll start by looking at atom invariants, so construct two molecules that differ in a single atom:</p>
<div id="ca2d381c" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1'</span>)</span>
<span id="cb4-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccn1'</span>)</span></code></pre></div>
</div>
<p>Generate fingerprints for those and calculate the similarity between them:</p>
<div id="5b5d32f1" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpg.GetFingerprint(m) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (m1,m2)]</span>
<span id="cb5-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(DataStructs.TanimotoSimilarity(fps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],fps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2727272727272727</code></pre>
</div>
</div>
<p>The <code>GetFingerprint()</code> function takes an optional argument, <code>customAtomInvariants</code>, that allows you to provide the atom invariants that are used.</p>
<p>Here’s how that works. We’ll use a simple function that just uses the explicit degree (number of explicit bonds) of the atom as its invariant:</p>
<div id="8ab1262d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">atomGen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> atom: atom.GetDegree()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate fingerprints using the custom invariants:</span></span>
<span id="cb7-4">fps_ats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpg.GetFingerprint(m,customAtomInvariants<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[atomGen(at) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> at <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> m.GetAtoms()]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (m1,m2)]</span>
<span id="cb7-5"></span>
<span id="cb7-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(DataStructs.TanimotoSimilarity(fps_ats[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],fps_ats[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0</code></pre>
</div>
</div>
<p>Now the fingerprints are identical</p>
<p>We can do the same thing for bond invariants.</p>
<p>To simplify the demonstration, I will just kekulize the first molecule so that it has alternating single and double bonds instead of aromatic bonds:</p>
<div id="e91a8753" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">m3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(m1)</span>
<span id="cb9-2">Chem.Kekulize(m3,clearAromaticFlags<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>By default, the similarity between these is quite low:</p>
<div id="f5037cef" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpg.GetFingerprint(m) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (m1,m3)]</span>
<span id="cb10-2"></span>
<span id="cb10-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(DataStructs.TanimotoSimilarity(fps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],fps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.14285714285714285</code></pre>
</div>
</div>
<p>However, if we define a bond invariant which treats all conjugated bonds the same, the molecules are identical:</p>
<div id="c3a4936b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">bondGen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> bond: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> bond.GetIsConjugated() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>bond.GetBondTypeAsDouble())</span>
<span id="cb12-2"></span>
<span id="cb12-3">fps_bnds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpg.GetFingerprint(m,customBondInvariants<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[bondGen(b) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> b <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> m.GetBonds()]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (m1,m3)]</span>
<span id="cb12-4"></span>
<span id="cb12-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(DataStructs.TanimotoSimilarity(fps_bnds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],fps_bnds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.0</code></pre>
</div>
</div>
<p>Finally, an example to show how to combine multiple components into the atom invariants. This is a silly one, but it hopefully demonstrates the idea.</p>
<p>The important things here is to make sure that the different pieces of information are stored in different parts of the invariant, so we multiple the degree by 1000 (to ensure a number larger than any possible atomic number) and then add the atomic number.</p>
<div id="bb72f986" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define an invariant generator that combines atom degree and atomic number:</span></span>
<span id="cb14-2">atomGen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> atom: atom.GetDegree()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> atom.GetAtomicNum()</span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate fingerprints using the custom invariants:</span></span>
<span id="cb14-5">fps_ats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpg.GetFingerprint(m,customAtomInvariants<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[atomGen(at) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> at <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> m.GetAtoms()]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (m1,m2)]</span>
<span id="cb14-6"></span>
<span id="cb14-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(DataStructs.TanimotoSimilarity(fps_ats[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],fps_ats[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.2727272727272727</code></pre>
</div>
</div>
<p>That’s it for this one, I hope this brief intro was useful!</p>



 ]]></description>
  <category>fingerprints</category>
  <category>tutorial</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2025-01-10-fp-generators-and-invariants.html</guid>
  <pubDate>Thu, 09 Jan 2025 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Introducing Synthon Searching</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search.html</link>
  <description><![CDATA[ 




<section id="rapid-searching-of-synthon-spaces" class="level1">
<h1>Rapid Searching of Synthon Spaces</h1>
<p><strong>Note</strong> this is a guest post written by Dave Cosgrove (GitHub: <span class="citation" data-cites="DavidACosgrove">@DavidACosgrove</span>).</p>
<p>There are a number of combinatorial libraries now available offering compounds made to order from a vast array of possibilities, such as <a href="https://enamine.net/compound-collections/real-compounds/real-database">Enamine’s REAL</a> or <a href="https://chem-space.com/compounds/freedom-space">ChemSpace’s FreedomSpace</a>. The enumerated versions of these databases run to billions of compounds making them expensive and difficult to manage and search. Several groups have proposed algorithms for the rapid search of these libraries in synthon rather than enumerated form (e.g.&nbsp;<a href="https://doi.org/10.1021/acs.jcim.0c00850">Spacelight</a> and <a href="https://doi.org/10.1021/acs.jcim.3c00290">Liphardt and Sander</a>). This blogpost describes the implementation of substructure and similarity search methods based on the ideas in the latter.</p>
<p>The examples use the FreedomSpace 2023 library of some 9 billion compounds. The new module, available starting in the 2024.09.3 release, is rdSynthonSpaceSearch. Timings are from my Mac mini M4 Pro (very nice, you should get one!).</p>
<blockquote class="blockquote">
<p>Obligatory new functionality disclaimer: this is completely new RDKit functionality and is still a bit experimental. The API and results may change over the next couple of releases as we do more testing and get more feedback from the community</p>
</blockquote>
<div id="9e1b6c1c-3bf8-411d-aa34-c760d9c79e5e" class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdSynthonSpaceSearch, rdFingerprintGenerator</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolDraw2D, rdDepictor</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SVG</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdBase</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb1-9"></span>
<span id="cb1-10">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdBase.rdkitVersion)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.09.3</code></pre>
</div>
</div>
<p>Load the library and print some information about it.</p>
<div id="8c96075c-e9a9-4313-a2b3-5fc45501cdf4" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb3-2">synthonspace <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSynthonSpaceSearch.SynthonSpace()</span>
<span id="cb3-3">synthonspace.ReadTextFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/david/Projects/FreedomSpace/2023-05_Freedom_synthons.txt"</span>)</span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of reactions : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>synthonspace<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetNumReactions()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb3-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of products : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>synthonspace<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetNumProducts()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb3-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to load : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of reactions : 10
Number of products : 9360696185
Time to load : 26.47 seconds.</code></pre>
</div>
</div>
<p>There’s a binary format that loads much more quickly.</p>
<div id="903b5221-0dc6-410d-8986-26ef60b6ae0f" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">synthonspace.WriteDBFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/david/Projects/FreedomSpace/2023-05_Freedom_synthons.spc"</span>)</span>
<span id="cb5-2">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb5-3">synthonspace.ReadDBFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/david/Projects/FreedomSpace/2023-05_Freedom_synthons.spc"</span>)</span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to load : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to load : 4.47 seconds.</code></pre>
</div>
</div>
<p>If you want more information about the library:</p>
<div id="b1f00c62-a0ce-457c-97f0-a244408629f2" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">synthonspace.Summarise()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Read from file /Users/david/Projects/FreedomSpace/2023-05_Freedom_synthons.spc
Number of reactions : 10
Reaction name a1
  Synthon set 0 has 18662 synthons
  Synthon set 1 has 16838 synthons
Reaction name a2
  Synthon set 0 has 18540 synthons
  Synthon set 1 has 1503 synthons
Reaction name a3
  Synthon set 0 has 492 synthons
  Synthon set 1 has 4700 synthons
Reaction name a4
  Synthon set 0 has 17547 synthons
  Synthon set 1 has 4539 synthons
Reaction name a5
  Synthon set 0 has 6420 synthons
  Synthon set 1 has 810 synthons
Reaction name a6
  Synthon set 0 has 5126 synthons
  Synthon set 1 has 11636 synthons
Reaction name a7
  Synthon set 0 has 320 synthons
  Synthon set 1 has 1148 synthons
  Synthon set 2 has 9608 synthons
Reaction name a77
  Synthon set 0 has 80 synthons
  Synthon set 1 has 5890 synthons
  Synthon set 2 has 8366 synthons
Reaction name a8
  Synthon set 0 has 10060 synthons
  Synthon set 1 has 34 synthons
Reaction name a80
  Synthon set 0 has 20 synthons
  Synthon set 1 has 8366 synthons
  Synthon set 2 has 8366 synthons
Approximate number of molecules in SynthonSpace : 9360696185</code></pre>
</div>
</div>
<p>##&nbsp;Substructure Searching</p>
<div id="4feda823-f48c-4832-b2f7-3b72b5b0e30a" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">qmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c12ccc(C)cc1[nH]nc2C(=O)NCc1cncs1"</span>)</span>
<span id="cb9-2">qmol</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b7bc6431-d9c5-408f-9838-6c55c1c96119" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb10-2">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.SubstructureSearch(qmol)</span>
<span id="cb10-3">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb10-4">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb10-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb10-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 0.33 seconds.
Number of hits : 108</code></pre>
</div>
</div>
<div id="804b28b3-ba17-42f5-af20-3df82a081dd3" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> hits:</span>
<span id="cb12-2">    img <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolsToGridImage(hits[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hit_names[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb12-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb12-4">    img <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"No Hits"</span></span>
<span id="cb12-5">img</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The molecule names are made up of the reaction name and the synthons for that reaction. So the first hit above is made from synthons 2700 and 25231 and reaction a1.</p>
<p>Complex SMARTS queries are supported, though can take a little longer to run. The maximum number of hits to be returned is capped at 1000 by default. You can obtain an upper bound on the maximum number of hits possible; there may be fewer hits than this in practice, as duplicate matches are counted but not returned and for other more subtle reasons.</p>
<div id="7f79cbb5-dff1-4b7e-a5e7-af28d77f85a8" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">qmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c1c[n,s,o][n,s,o,c]c1C(=O)[$(N1CCCCC1),$(N1CCCC1)]"</span>)</span>
<span id="cb13-2">qmol</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="5d145188-7547-4bd1-a7d8-292beb253cc7" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb14-2">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.SubstructureSearch(qmol)</span>
<span id="cb14-3">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb14-4">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb14-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb14-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb14-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Maximum number of hits possible : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetMaxNumResults<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 0.19 seconds.
Number of hits : 1000
Maximum number of hits possible : 2358187</code></pre>
</div>
</div>
<p>You can control the number of hits returned, and also get a random sample of the hits, rather than the first N in the list:</p>
<div id="d6da6906-bd2c-4678-8a92-5677bdb8d050" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSynthonSpaceSearch.SynthonSpaceSearchParams()</span>
<span id="cb16-2">params.maxHits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb16-3">params.randomSample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb16-4">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb16-5">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.SubstructureSearch(qmol, params)</span>
<span id="cb16-6">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb16-7">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb16-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb16-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Maximum number of hits possible : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetMaxNumResults<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-11">Draw.MolsToGridImage(hits[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hit_names[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 0.13 seconds.
Number of hits : 12
Maximum number of hits possible : 2358187</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Having looked at the first 1000 hits, you might want to get the next set in the list. Here we get the 1000 starting at 2000.</p>
<div id="aac848ef-ff4d-4750-8658-1b84de535f3d" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSynthonSpaceSearch.SynthonSpaceSearchParams()</span>
<span id="cb18-2">params.maxHits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb18-3">params.hitStart <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span></span>
<span id="cb18-4">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb18-5">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.SubstructureSearch(qmol, params)</span>
<span id="cb18-6">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb18-7">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb18-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb18-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb18-10">Draw.MolsToGridImage(hits[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hit_names[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 0.19 seconds.
Number of hits : 1000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-12-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>It is possible to check the upper bound on the number of hits without building them, just to get an idea of whether you need to refine the search or not.</p>
<div id="423e46c2-5b53-44f4-9fd8-721abbbedb62" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">qmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"c12ccc(C)cc1[nH]nc2C(=O)NCc1cncs1"</span>)</span>
<span id="cb20-2">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSynthonSpaceSearch.SynthonSpaceSearchParams()</span>
<span id="cb20-3">params.buildHits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb20-4">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.SubstructureSearch(qmol, params)</span>
<span id="cb20-5">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb20-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb20-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Maximum number of hits possible : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetMaxNumResults<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of hits : 0
Maximum number of hits possible : 108</code></pre>
</div>
</div>
<p>##&nbsp;Similarity Searching Any of the RDKit fingerprint generators can be used, although the similarity metric is hard-coded as Tanimoto on a hashed fingerprint. The search structure is <a href="https://en.wikipedia.org/wiki/Osimertinib">Osimertinib</a> which is paying my pension so deserves acknowledgement. Similarity values are returned in the property “Similarity” on each molecule. If the binary file doesn’t contain fingerprints, they will need to be generated. This can be done ahead of time or it will be done as part of the first search.</p>
<div id="f5878504-c918-4896-9878-87c4ade063ee" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">fpgen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetRDKitFPGenerator(fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb22-2">synthonspace.BuildSynthonFingerprints(fpgen)</span>
<span id="cb22-3">qmol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C=CC(=O)Nc1cc(Nc2nccc(-c3cn(C)c4ccccc34)n2)c(OC)cc1N(C)CCN(C)C"</span>)</span>
<span id="cb22-4">qmol</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[11:01:56] Building the fingerprints may take some time.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-14-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a3907cdc-c9b4-4afe-99f7-b0e4c2bf009e" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb24-2">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.FingerprintSearch(qmol, fpgen)</span>
<span id="cb24-3">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb24-4">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>m<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similarity"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb24-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb24-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb24-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Maximum number of hits possible : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetMaxNumResults<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb24-8">Draw.MolsToGridImage(hits[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hit_names[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 20.29 seconds.
Number of hits : 1000
Maximum number of hits possible : 35911098</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-15-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The extra runtime is due to 2 factors. The first is that osimertinib is a largish molecule, so many fragments are generated that all need to be compared with the synthons. The second is that the screenout by fingerprint is less efficient, as you can see from the fact that 35911098 hits were possible having passed the initial fragment screening, although many of those won’t make the similarity cutoff when the potential hit molecule is built and checked.</p>
<p>The similarity cutoff can be raised from the default 0.5 however this can result in large search times if there are few hits that meet the threshold - it may have to check all 35911098 potential hits. Note that in the search below we take a random sample of the results, so the hits are not the same as above.</p>
<div id="780d92fc-45e0-4546-8eb5-f419a6c26221" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSynthonSpaceSearch.SynthonSpaceSearchParams()</span>
<span id="cb26-2">params.maxHits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb26-3">params.randomSample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb26-4">params.similarityCutoff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.55</span></span>
<span id="cb26-5">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb26-6">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.FingerprintSearch(qmol, fpgen, params)</span>
<span id="cb26-7">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb26-8">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>m<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similarity"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb26-9"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb26-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Maximum number of hits possible : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetMaxNumResults<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-12">Draw.MolsToGridImage(hits[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hit_names[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 15.84 seconds.
Number of hits : 12
Maximum number of hits possible : 3925204</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-16-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Tanimoto similarities between small molecules with sparsely populated fingerprints are known to be be lower and more granular than similiarties for larger entities. This is relevant because the search starts by comparing fragments from the query molecule with synthons in the database. Only synthons that match the fragment within the cutoff are considered as a basis for a hit. There is a parameter that lowers the similarity cutoff for the fragment comparison compared to the global cutoff, which defaults to 0.1. Thus, if your similarityCutoff is set to 0.5, synthons are considered a match to a fragment if their Tanimoto similarities are above 0.4. If you want a faster search and don’t mind possibly missing some hits, you can lower that difference.</p>
<div id="d537a3a3-5c0f-420e-b231-9a6a13109db2" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdSynthonSpaceSearch.SynthonSpaceSearchParams()</span>
<span id="cb28-2">params.maxHits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span></span>
<span id="cb28-3">params.randomSample <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb28-4">params.similarityCutoff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb28-5">params.fragSimilarityAdjuster <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb28-6">start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.perf_counter()</span>
<span id="cb28-7">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> synthonspace.FingerprintSearch(qmol, fpgen, params)</span>
<span id="cb28-8">hits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results.GetHitMolecules()</span>
<span id="cb28-9">hit_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>m<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_Name"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(m.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Similarity"</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> hits]</span>
<span id="cb28-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Time to search : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>time<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>perf_counter() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:4.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds."</span>)</span>
<span id="cb28-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Number of hits : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(hits)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb28-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Maximum number of hits possible : </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>GetMaxNumResults<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb28-13">Draw.MolsToGridImage(hits[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>hit_names[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>], molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time to search : 15.74 seconds.
Number of hits : 12
Maximum number of hits possible : 690134</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search_files/figure-html/cell-17-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As you can see, the potential number of hits it had to check went down to 690134.</p>
<section id="working-with-synthon-spaces-yourself" class="level2">
<h2 class="anchored" data-anchor-id="working-with-synthon-spaces-yourself">Working with synthon spaces yourself</h2>
<p>In order to use this functionality, you obviously need access to a synthon description of the space you want to search. Due to the size of the files, we don’t include a space description with the RDKit itself, so you need to get the data elsewhere.</p>
<p>ChemSpace’s FreedomSpace 3.0 and Enamine’s REAL are available on request via the links above. If you just want to experiment then there are small test spaces <a href="https://github.com/rdkit/rdkit/tree/master/Code/GraphMol/SynthonSpaceSearch/data">here</a>. The <a href="https://github.com/rdkit/rdkit/blob/master/Code/GraphMol/SynthonSpaceSearch/data/Syntons_5567.csv">Syntons_5567.csv</a> file is a substantial random extract from the FreedomSpace 2023 library.</p>
<p>We don’t currently know of any others, but we will update this post as if/when we learn about more. Please leave a comment or get in touch some other way if you have a space you want to share. If you work with a provider of make-on-demand libraries or DELs, ask them if they can provide their libraries in synthon form, and we will add the link above. I (Dave) can work with providers on getting the data in the appropriate format.</p>
</section>
<section id="acknowledgements" class="level2">
<h2 class="anchored" data-anchor-id="acknowledgements">Acknowledgements</h2>
<p>Thanks to Greg for pointing me (Dave) at the problem and providing valuable insight and discussions.<br>
Thanks are also due to Olga Tarkhanova and colleagues at ChemSpace for providing the FreedomSpace 2023 library in synthon and enumerated forms for me to use during development and testing, and also to Yurii Moroz at Enamine for help and discussions.</p>


</section>
</section>

 ]]></description>
  <category>release</category>
  <category>tutorial</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-12-03-introducing-synthon-search.html</guid>
  <pubDate>Mon, 02 Dec 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Using lwreg with the RDKit cartridge</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-10-31-lwreg-and-the-cartridge.html</link>
  <description><![CDATA[ 




<p>We recently published an <a href="https://pubs.acs.org/doi/full/10.1021/acs.jcim.4c01133">application note</a> introducing <a href="https://github.com/rinikerlab/lightweight-registration">lwreg</a>, an open-source chemical registration system with a simple Python API that can be easily integrated into computational workflows. We think lwreg is really useful and hope others agree with us.</p>
<p>One of the key ideas behind lwreg is that it should not require any chemical intelligence in the database it uses to store its results. See the paper for more details, but the kinds of identity queries (i.e.&nbsp;“is this molecule or something closely related already registered?”) that a registration system needs to support can be answered with standard text queries. Having said that, there are times when it’s useful to ask questions like “Are there any registered molecules in the database that contain this substructure?”. One easy way to allow this kind of query is to install the RDKit cartridge in the database.</p>
<p>This post shows how to use the RDKit cartridge together with an lwreg instance that is using PostgreSQL as the database backend. Since installing PostgreSQL and the cartridge can be challenging for a normal user, I also show how to do that installation and get a database that’s suitable for local use. The instructions below should work on Windows, Linux, or the Mac.</p>
<p>Many thanks to Jessica Braun, the other main lwreg developer, for her feedback on a draft of this post, which will eventually end up, in some modified form, in the lwreg documentation.</p>
<section id="setting-up-a-local-postgresql-installation" class="level1">
<h1>Setting up a local PostgreSQL installation</h1>
<p>You probably wouldn’t want to use this setup in any very serious way, but it’s great for learning and could certainly work as a way to configure a personal database. I put this notebook together in Windows on my laptop, but it should work on Linux or the Mac too.</p>
<blockquote class="blockquote">
<p><strong>Aside</strong> If you want to do this more seriously without a huge amount of complication, your best bet is probably to setup a docker container that runs postgresql and the cartridge and to use that within lwreg. I will try to put together a post showing how to do this in the not-too-distant future.</p>
</blockquote>
<p>As usual, I assume that you’re using conda since it makes installing the RDKit and all other dependencies incredibly easy.</p>
<p>Create a conda environment using the lwreg environment.yml file:</p>
<pre><code>conda env create -f https://github.com/rinikerlab/lightweight-registration/raw/refs/heads/main/environment.yml</code></pre>
<p>This creates an environment named <code>py311_lwreg</code>. Activate that and install lwreg, postgresql, and the rdkit-postgresql cartridge:</p>
<pre><code>conda activate py311_lwreg
python -m pip install git+https://github.com/rinikerlab/lightweight-registration
conda install postgresql
conda install rdkit-postgresql</code></pre>
<p>We need an environment for postgresql to use to store its database files, create that and then tell postgresql to initialize that directory, you will obviously need to pick a different path:</p>
<pre><code>mkdir c:/users/glandrum/database
initdb -D /c/Users/glandrum/database/psql17</code></pre>
<p>Start the postgresql server:</p>
<pre><code>pg_ctl -D /c/Users/glandrum/database/psql17 -l /c/Users/glandrum/database/psql17.log start</code></pre>
<blockquote class="blockquote">
<p><strong>Note</strong> If you run the server this way, it will be killed when the shell you launched it from exits. You will need to run this start command each time you want to start using lwreg.</p>
</blockquote>
<p>Finally create the database that we’re going to work with here:</p>
<pre><code>createdb gl_structuredemo</code></pre>
<p>Now everything is set up, let’s get started!</p>
<div id="9a3b7958" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:09:39.332071Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:09:39.224564Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> lwreg <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> utils</span></code></pre></div>
</div>
<p>Set up our the configuration we’re going to use for lwreg:</p>
<div id="d0aa46f1" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:09:40.114736Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:09:40.112260Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">cfg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> utils.defaultConfig()</span>
<span id="cb7-2">cfg[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'host'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'localhost'</span></span>
<span id="cb7-3">cfg[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbtype'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'postgresql'</span></span>
<span id="cb7-4">cfg[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dbname'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gl_structuredemo'</span></span>
<span id="cb7-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for this use case we're going to be registering 3D structures and want to keep the conformers:</span></span>
<span id="cb7-6">cfg[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'registerConformers'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb7-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we don't want lwreg to do any standardization of the molecules when we load them:</span></span>
<span id="cb7-8">cfg[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'standardization'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span></span>
<span id="cb7-9">utils.set_default_config(cfg)</span></code></pre></div>
</div>
<div id="6a3c0c09" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:09:42.685683Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:09:40.639774Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">utils.initdb()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>This will destroy any existing information in the registration database.
  are you sure? [yes/no]:  yes</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>True</code></pre>
</div>
</div>
<p>Start by loading some structures (these are some subsets of molecules I’ve extracted from the COD for another project). You obviously won’t have these files, but you can provide any SDF files that contain 3D molecules.</p>
<div id="a1f3db81" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:09:54.140270Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:09:43.439889Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">mrns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> utils.bulk_register(sdfile<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c:/users/glandrum/ETH/Datasets/COD/COD_2024Feb14.organic.chembl_selected.sdf'</span>)</span>
<span id="cb11-2">mrns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> utils.bulk_register(sdfile<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c:/users/glandrum/ETH/Datasets/COD/COD_2024Feb14.organic.macrocycles.sdf'</span>)</span>
<span id="cb11-3">mrns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> utils.bulk_register(sdfile<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c:/users/glandrum/ETH/Datasets/COD/COD_2024Feb14.organic.cages.sdf'</span>)</span></code></pre></div>
</div>
<div id="c8da5cca" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:09:54.144985Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:09:54.141497Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(utils.get_all_registry_numbers())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>2416</code></pre>
</div>
</div>
</section>
<section id="using-the-rdkit-cartridge-with-data-from-the-lwreg-tables." class="level1">
<h1>Using the RDKit cartridge with data from the lwreg tables.</h1>
<p>We start by installing the cartridge in our database (if it’s not already installed) and create a new schema to hold the RDKit tables.</p>
<div id="2ded2d3f" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:10:00.483038Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:10:00.479904Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">cn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> utils.<span class="ex" style="color: null;
background-color: null;
font-style: inherit;">connect</span>(config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cfg)</span>
<span id="cb14-2">curs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cn.cursor()</span>
<span id="cb14-3">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create extension if not exists rdkit'</span>)</span>
<span id="cb14-4">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create schema if not exists rdk'</span>)</span>
<span id="cb14-5">cn.commit()</span></code></pre></div>
</div>
<p>Now create the <code>rdk.mols</code> table to hold RDKit molecules, populate it with molecules created from the mol blocks in lwreg’s <code>molblocks</code> table, and then create an index on the molecule column to allow us to quickly do substructure searches.</p>
<div id="7807ada4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:10:03.636493Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:10:02.448169Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop table if exists rdk.mols cascade'</span>)</span>
<span id="cb15-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the second argument to mol_from_ctab() here tells the cartridge to not store the molecule's conformers, we don't need them</span></span>
<span id="cb15-3">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'select molregno, mol_from_ctab(molblock::cstring,false) m into rdk.mols from molblocks'</span>)</span>
<span id="cb15-4">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'create index molidx on rdk.mols using gist(m)'</span>)</span>
<span id="cb15-5">cn.commit()</span></code></pre></div>
</div>
<p>Now let’s do some queries.</p>
<p>Start by looking for one of the torsions that’s used for ETKDGv3:</p>
<div id="61f1139b-3455-4f4c-9139-5ef2101c23b5" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">smi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[cH0:1][c:2]([cH1])!@;-[O:3][C:4]'</span></span>
<span id="cb16-2">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"select * from rdk.mols where m @&gt; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">::qmol"</span>,(smi,))</span>
<span id="cb16-3">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> curs.fetchall()</span>
<span id="cb16-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>99</code></pre>
</div>
</div>
<p>And look at the results with just the torsion substructure highlighted:</p>
<div id="a903497b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:10:14.912387Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:10:14.896591Z&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(smi)</span>
<span id="cb18-2">labelledAts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.GetIdx() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> q.GetAtoms() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x.GetAtomMapNum()]</span>
<span id="cb18-3"></span>
<span id="cb18-4">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> d]</span>
<span id="cb18-5">ats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb18-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb18-7">    matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m.GetSubstructMatches(q)</span>
<span id="cb18-8">    tl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb18-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> tm <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches:</span>
<span id="cb18-10">        tl.extend([tm[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> labelledAts])</span>
<span id="cb18-11">    ats.append(tl)</span>
<span id="cb18-12">    </span>
<span id="cb18-13">Draw.MolsToGridImage(ms[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>],subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>),highlightAtomLists<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ats)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-10-31-lwreg-and-the-cartridge_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s do a query to retrieve conformers for the molecules that match that substructure:</p>
<div id="463447a6-5639-4e21-8943-59efbab0b1df" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"select molregno,conf_id,molblock from rdk.mols join conformers using (molregno) where m@&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">::qmol"</span>,(smi,))</span>
<span id="cb19-2">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> curs.fetchall()</span>
<span id="cb19-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>106</code></pre>
</div>
</div>
<p>And collect information about the values of the dihedral that we’re interested in across those conformers:</p>
<div id="0cd5fc4a-add6-4e8f-b57f-6b53a336f3fd" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolTransforms</span>
<span id="cb21-2"></span>
<span id="cb21-3">q <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmarts(smi)</span>
<span id="cb21-4">labelledAts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.GetIdx() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> q.GetAtoms() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x.GetAtomMapNum()]</span>
<span id="cb21-5"></span>
<span id="cb21-6">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromMolBlock(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],removeHs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> d]</span>
<span id="cb21-7">vals <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb21-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb21-9">    matches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m.GetSubstructMatches(q)</span>
<span id="cb21-10">    conf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m.GetConformer()</span>
<span id="cb21-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> tm <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> matches:</span>
<span id="cb21-12">        aids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [tm[i] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> labelledAts]</span>
<span id="cb21-13">        vals.append(rdMolTransforms.GetDihedralDeg(conf,<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>aids))    </span></code></pre></div>
</div>
<div id="706d3e04-97a4-4844-90f3-2e4853d72e4d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(vals)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>219</code></pre>
</div>
</div>
<p>Do a histogram of the dihedral values:</p>
<div id="89e38ead-c4da-4ff1-8604-bd59b1b1c31a" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb24-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb24-3"></span>
<span id="cb24-4">plt.hist(vals,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb24-5">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dihedral'</span>)</span>
<span id="cb24-6">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'count'</span>)</span>
<span id="cb24-7">plt.title(smi)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-10-31-lwreg-and-the-cartridge_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="keeping-the-rdkit-tables-up-to-date-when-molecules-are-added-to-lwreg" class="level1">
<h1>Keeping the RDKit tables up-to-date when molecules are added to lwreg</h1>
<p>Our next step is to make sure that RDKit tables in the database are automatically updated when new molecules are added to lwreg. We can do this in PostgreSQL by adding a <code>trigger</code> to the <code>molblock</code> table that is called after a new row is inserted into the <code>molblock</code> table. The trigger is called with the data from the new row, so we can just insert the new molregno and the molecule constructed from the new molblock into the <code>rdk.mols</code> table.</p>
<p>Note: if using this in production, you probably would need to do some error handling in the trigger. That’s beyond the scope of this blog post (in this case that means: “I don’t know how to do it”).</p>
<p>The PostgreSQL docs have <a href="https://www.postgresql.org/docs/current/sql-createtrigger.html">more information about creating triggers</a>.</p>
<div id="4257ff88" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:16:21.299002Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:16:21.295452Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''CREATE OR REPLACE FUNCTION copy_new_mol() RETURNS TRIGGER AS</span></span>
<span id="cb25-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$BODY$</span></span>
<span id="cb25-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">BEGIN</span></span>
<span id="cb25-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    INSERT INTO</span></span>
<span id="cb25-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        rdk.mols(molregno,m)</span></span>
<span id="cb25-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        VALUES(new.molregno,mol_from_ctab(new.molblock::cstring,false));</span></span>
<span id="cb25-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">           RETURN new;</span></span>
<span id="cb25-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">END;</span></span>
<span id="cb25-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$BODY$</span></span>
<span id="cb25-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">language plpgsql;'''</span>)</span>
<span id="cb25-11">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''CREATE OR REPLACE TRIGGER mol_insert_trigger</span></span>
<span id="cb25-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">     AFTER INSERT ON molblocks</span></span>
<span id="cb25-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">     FOR EACH ROW</span></span>
<span id="cb25-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">     EXECUTE FUNCTION copy_new_mol();'''</span>)</span>
<span id="cb25-15"></span></code></pre></div>
</div>
<p>Demonstrate that this worked by creating two new molecules that share a core, generating a conformer for each one, and registering each one.</p>
<div id="bc9f4e8b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:16:22.597143Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:16:22.558824Z&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDistGeom</span>
<span id="cb26-2">newMol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddHs(Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1c(O)csn1'</span>))</span>
<span id="cb26-3">rdDistGeom.EmbedMolecule(newMol,randomSeed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb26-4">tm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(newMol)</span>
<span id="cb26-5">utils.register(mol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tm)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(2792, 2792)</code></pre>
</div>
</div>
<div id="8b544293" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:16:23.239172Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:16:23.215311Z&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">newMol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddHs(Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1c(OC)csn1'</span>))</span>
<span id="cb28-2">rdDistGeom.EmbedMolecule(newMol,randomSeed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb28-3">tm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(newMol)</span>
<span id="cb28-4">utils.register(mol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tm)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>(2793, 2793)</code></pre>
</div>
</div>
<p>Now show that we can retrieve those two just-registered molecules with a substructure query for the core:</p>
<div id="dc7292d9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:16:26.029405Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:16:26.023016Z&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">sma <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1c(O)csn1'</span></span>
<span id="cb30-2">curs.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"select * from rdk.mols where m@&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">::qmol limit 10"</span>,(sma,))</span>
<span id="cb30-3">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> curs.fetchall()</span>
<span id="cb30-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(d)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>2</code></pre>
</div>
</div>
<div id="6ebf30a8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T11:16:28.809396Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T11:16:28.807000Z&quot;}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>(2792, 'Oc1cnsc1')</code></pre>
</div>
</div>
<div id="49e139f1-b071-4f82-94dd-85d4c890db81" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">d[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(2793, 'COc1cnsc1')</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>cartridge</category>
  <category>tutorial</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-10-31-lwreg-and-the-cartridge.html</guid>
  <pubDate>Wed, 30 Oct 2024 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Using the ACS1996 drawing style in PandasTools</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-10-22-using-acs1996-style-in-pandastools.html</link>
  <description><![CDATA[ 




<p>This is a short one showing how to improve the legibility of small structure drawings in Pandas DataFrames displayed in the notebook.</p>
<div id="ecb0a026" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T02:35:27.758296Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T02:35:21.709014Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PandasTools</span>
<span id="cb1-5">PandasTools.RenderImagesInAllDataFrames(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>Start by reading in an SDF:</p>
<div id="47db2857" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T02:36:28.353567Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T02:36:17.435740Z&quot;}" data-scrolled="true" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PandasTools.LoadSDF(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/chembl26_very_active.sdf.gz'</span>)</span>
<span id="cb2-2">df.head()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[04:36:24] Warning: ambiguous stereochemistry - zero final chiral volume - at atom 50 ignored
[04:36:25] Warning: ambiguous stereochemistry - overlapping neighbors  - at atom 7 ignored
[04:36:25] Warning: ambiguous stereochemistry - overlapping neighbors  - at atom 9 ignored
[04:36:25] Warning: ambiguous stereochemistry - overlapping neighbors  - at atom 9 ignored</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">compound_chembl_id</th>
<th data-quarto-table-cell-role="th">assay_chembl_id</th>
<th data-quarto-table-cell-role="th">target_chembl_id</th>
<th data-quarto-table-cell-role="th">pref_name</th>
<th data-quarto-table-cell-role="th">standard_relation</th>
<th data-quarto-table-cell-role="th">standard_value</th>
<th data-quarto-table-cell-role="th">standard_units</th>
<th data-quarto-table-cell-role="th">standard_type</th>
<th data-quarto-table-cell-role="th">ID</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ROMol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>CHEMBL86971</td>
<td>CHEMBL690412</td>
<td>CHEMBL243</td>
<td>Human immunodeficiency virus type 1 protease</td>
<td>=</td>
<td>0.8</td>
<td>nM</td>
<td>Ki</td>
<td></td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>CHEMBL6710</td>
<td>CHEMBL621508</td>
<td>CHEMBL324</td>
<td>Serotonin 2c (5-HT2c) receptor</td>
<td>=</td>
<td>0.26</td>
<td>nM</td>
<td>Ki</td>
<td></td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>CHEMBL314218</td>
<td>CHEMBL677606</td>
<td>CHEMBL248</td>
<td>Leukocyte elastase</td>
<td>=</td>
<td>0.03</td>
<td>nM</td>
<td>Ki</td>
<td></td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>CHEMBL438897</td>
<td>CHEMBL877834</td>
<td>CHEMBL1855</td>
<td>Gonadotropin-releasing hormone receptor</td>
<td>=</td>
<td>0.24</td>
<td>nM</td>
<td>Ki</td>
<td></td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>CHEMBL15928</td>
<td>CHEMBL616937</td>
<td>CHEMBL1983</td>
<td>Serotonin 1d (5-HT1d) receptor</td>
<td>=</td>
<td>0.7</td>
<td>nM</td>
<td>Ki</td>
<td></td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Move the molecule to the first column</p>
<div id="b9def282" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T02:38:36.369240Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T02:38:36.239838Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">cols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(df.columns)</span>
<span id="cb4-2">cols.insert(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,cols.pop(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb4-3">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[cols]</span>
<span id="cb4-4">df.head()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ROMol</th>
<th data-quarto-table-cell-role="th">compound_chembl_id</th>
<th data-quarto-table-cell-role="th">assay_chembl_id</th>
<th data-quarto-table-cell-role="th">target_chembl_id</th>
<th data-quarto-table-cell-role="th">pref_name</th>
<th data-quarto-table-cell-role="th">standard_relation</th>
<th data-quarto-table-cell-role="th">standard_value</th>
<th data-quarto-table-cell-role="th">standard_units</th>
<th data-quarto-table-cell-role="th">standard_type</th>
<th data-quarto-table-cell-role="th">ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL86971</td>
<td>CHEMBL690412</td>
<td>CHEMBL243</td>
<td>Human immunodeficiency virus type 1 protease</td>
<td>=</td>
<td>0.8</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL6710</td>
<td>CHEMBL621508</td>
<td>CHEMBL324</td>
<td>Serotonin 2c (5-HT2c) receptor</td>
<td>=</td>
<td>0.26</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL314218</td>
<td>CHEMBL677606</td>
<td>CHEMBL248</td>
<td>Leukocyte elastase</td>
<td>=</td>
<td>0.03</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL438897</td>
<td>CHEMBL877834</td>
<td>CHEMBL1855</td>
<td>Gonadotropin-releasing hormone receptor</td>
<td>=</td>
<td>0.24</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL15928</td>
<td>CHEMBL616937</td>
<td>CHEMBL1983</td>
<td>Serotonin 1d (5-HT1d) receptor</td>
<td>=</td>
<td>0.7</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The default drawing style doesn’t look great when the molecule images are small like this; the ACS1996 style really works a lot better.</p>
<p>We can use the ACS996 style in the DataFrame by setting the drawing options for <code>PandasTools</code>. We do this by creating a new drawing options instance, setting that to ACS1996 mode, and then setting the <code>drawOptions</code> variable in the <code>PandasTools</code> module.</p>
<div id="4d351926" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T02:43:13.006397Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T02:43:12.998859Z&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">dopts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDrawOptions()</span>
<span id="cb5-2">Draw.SetACS1996Mode(dopts,Draw.MeanBondLength(df.ROMol[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))</span>
<span id="cb5-3"></span>
<span id="cb5-4">PandasTools.drawOptions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dopts</span></code></pre></div>
</div>
<p>The new options are now used when we show the DataFrame:</p>
<div id="6980761e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T02:43:51.293107Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T02:43:51.230658Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">df.head()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">ROMol</th>
<th data-quarto-table-cell-role="th">compound_chembl_id</th>
<th data-quarto-table-cell-role="th">assay_chembl_id</th>
<th data-quarto-table-cell-role="th">target_chembl_id</th>
<th data-quarto-table-cell-role="th">pref_name</th>
<th data-quarto-table-cell-role="th">standard_relation</th>
<th data-quarto-table-cell-role="th">standard_value</th>
<th data-quarto-table-cell-role="th">standard_units</th>
<th data-quarto-table-cell-role="th">standard_type</th>
<th data-quarto-table-cell-role="th">ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAABmJLR0QA/wD/AP+gvaeTAAAVuElEQVR4nO3deVAT5xsH8GAiHhU5qlVivfAYb3EUFKbM1ItWa0esIJeIoiQgiqBgEZEAP9F6oIDYanUQBEXxqIZS5RBPqAhY1EEh3CIgR0SuhJz7++Od7jAUQxLyBoLP569syLv7JHzZ3ew+u2gRBEEBQNUG9XUBYGCCYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFgACwgWwAKCBbCAYAEsIFh9TCQS9XUJWECw+gxBEDExMd98880PP/zw8uXLvi5HxSBYfSMvL8/Ozm7QoEHZ2dmJiYkpKSkeHh61tbV9XZfKaBEE0dc1fF64XO7x48eHDx/u6+vL5/MTEhK2b99OoVCqq6vR835+fjo6On1dZq8RQF2EQmF4eLijo2N5eblEIomNjXVwcCgoKOj8mry8PEdHx7Nnz4rF4r6qUyUgWGqSnp5ubW2dkpJCEER2drajo2NSUtKnXpyWlrZhw4Y/xTjQWqGAQLuzdv3qxZs+bXX38Vi8XV1dVubm5BQUEdHR2yR4lEotOnT1tYWHz48EE9daoWra83xQNfdHS0tbW1vb390aNH3717FxgYaGho2OMoGo22ffv24uLi8vJyfX19NdSpWvCtELuZM2dOnz6dSqVaWlqePn1anlRRKJTg4ODGxkY6na6hO/IQLOxoNJpYLKZSqQsXLpR/lFAoJDT5CzsECzsUrL6uQt0gWNhBsAAWECyABQQLYEGj0SQSSV9XoW4QLOyoVCqssYDqkZtCjT58oCgIFnZksNzd3S9duiRnvPbt2zdq1KiGhgYej4e5QCyUDJZUKt2zZ8/Zs2dVW83A8/79+5iYmOTk5KKiojNnzowcOdLOzi4rK6vHgSNGjEhJSXn48OHYsWPVUKfKKROsZ8+ebd68edq0aTweDzV+qLysAUAkEkVERPj4+LBYrHPnzl2/fn3v3r0WFhZxcXF5eXk7dux4/79p8ZWVVXt2rWLw+FkZWWNGTNGnWWrjEKnrN+9e+fu7k6enBcIBB8+fAgICNi5c2dDQwOGc+RqIhQKb9++fe7cueLiYpXMMD093dHR8eHDh52f5HA4zs7O4eHhqM3B29s7ODiYz+d3fg2PxwsODmYwGPX19SqppK/IGywej3fkyJHt27fX1taiZxobG21tbW/cuEEQRFFREZPJjIiIEIlEuCrFRiQSffvtt+7u7uHh4XPnzmWz2b2ZW3FxMfooPtWpl5aWtnHjRpS5zMxMFxcX8pVsNtvGxubp06e9KaCfkCtYbDZ7w4YNWVlZXZ6XSqWJiYkbNmz4+++/CYJIT0+3sbGR0b/WP12+fHnTpk3ocWlp6YwZM5SbT1tbW3BwsKura48rG9RKunHjxvLycvRMUVHR5s2bz549K5FIlFt6f9NDsPLy8uzt7WNjY6VS6ade097ejlZmNTU1qOPW0dHxxYsXqi4Vl127dl24cIGcnDhxYlNTk0JzkEqlwcHBy5cvV+hd19XVeXp6MhgMFxcXPz+/5uZmhRbaz8kKVmxs7NKlS9va2uSZ0bt379BOA4/Ha2pqWrJkSXJysoqK7Bn6zkVORkREVFRUyDmWyWReuXKFnJw5cya5uZfT/Pnzhw0bFhERodAo5I8/kD9yv3N69evY2JilB4u61uhvr6+t7c3j8crLy/v8UvAuHHjTpw4YWlpuXfvXj09PQ8PjxEjRqjuO0YPqqur7969S04mJSXV1dXJOXbixIklJSXosVAo5HK5o0aNUmjpVCqVz+d/fXXCo1CrKysLC0tlRiIm1AobGtrU3p4z4cbCgsLnzx5IufslixZcurUKaWr6RP29vYxMTGFhYVisTg0NNTKyopGU6xjW09PT0tLa/r06Zgq/JSioiJnZ2dLS8vDhw8retYoPT3dwsJiwYIFXl5eHR0dKq9t4Bx5Lygo8PsXuQaSx6RJk6Kjo3fu3GliYtLa2hoeHq7oovX09HR1dceNG6fowN7gcrlr1qxxdHSMjY2tra319vaWf2xJScn27dtjY2NzcnKGDx++e/dulZc3cC6mMDQ0XLNmDXp87949hcZaWFikpaUpvWh9fX1dXV09PT2l56CExMREcjN67NixyZMnHz9+fMiQIfKMvXTpkqurq5GREYVCYbFYEyZMiIqKGjRIlWuZgbPGMjAw+OZfiv6OCYI4dOgQhULZv3+/EovW09NDW0MlxiqttLR05syZ6PGQIUPGjh1bU1Mj59i3b99OnTqVHDty5MimpibVljdwgtUbWlpalZWVFAqlsbFRieEoWKouqgdUKlUoFJKTIpFI/l3DoUOHdt4x5/F4Q4cOVW15AyRYkyZNsrGxIScdHBzodLralq6np6f+S/+MjY3Jk9lcLre5uZlOp7e3tzs7O3e+dw15mySRSHTy5Mno6GgKhbJ48eKMjAz0PIfDMTAw+OKLL1RbXv8KlkAgCAgIMDMzW79+fX5+vvwDuVxuXFycQCBAk8+fP29ubsZTYzcmTZok586NCllbW5eWlgYGBt68eXPDhg3+/v5UKpVKpUZFRSUlJYlEoqSkpIULF65cuXLJkiX5+fkFBQULFixwcXFpa2uzt7evqKhgMpknTpxYv3798ePHVV5e/wrWrl27hEJhamrqnj17rK2t5T8W1drampqa+r/Q9NFhcXt7e3Yyuzq2nTplGpVLUtDhk8eHBaWtrEiRNfvXrFYrHc3NxaWlpcXFxu3brl7+8/ePBgBoORmpr64MGDiIgINzc3Y2PjmTNnuru737hxA41du3atgYFBUlLSd999p/Lyet4q6+rqfvXVV3LOTiQS3bx509bWVolS+Hw+m82uqKjQ1tY2Nze3tra+du3ajh075By+cuVKNpu9bt06ha4LVQk6na7c0dFeGj58+NatW8nJkSNHXr58+c6dOwRBaGlp6enp3bt3z9ra2tTU9OrVq+g1Bw4cQDsJNBpt9erV+GqTtcaqqqrKy8ubN2+enIlGvSLoknAul6vojnBtba2hoaG2tjaanD59ujxH/ElDhw49c+aMq6urcjdfrKqq+vbbbz98+KDoQKlUGh0dff/+ffnXr4qKj4+X/5Z/q1atQgcOkpKSrly5Mnv27KNHj6JuwTFjxsi56ykWi9lsdl5entLfFmUFy9bWtqioKCAgoLW1VfZc0CHggoKChIQEY2NjDw+PxsbGrKys/fv3t7S0yFmKtrZ250PAAoGADJmczM3NzczMFN1jqK2tdXd3nzNnzvXr142MjBgMRkNDg5xjc3NznZ2d6XT69evXg4ODg4ODyf283tu9ezf69NatW3fr1i0mkymjN/C/pk6devPmzYyMjNra2s4rth5lZGQ4ODiYmJj4+/vv27cvMjJSmYtBejyb+ObNGycnJ9Se9t+fcrlcHx+f3bt3f/z4EfVsbd26lTwBXFhYuGnTpk+N7UIikUycOLGmpgZNOjk5Xb16lSAIGY0ViEAgyMjIWLt2LUEQLS0t06dPnzZtWnZ2do9LRO0rDg4OlZWV5JPFxcUMBoNsqKqrq+v80xcvXqDOlpqaGi8vr5CQkM6detnZ2Rs3bkxMTOxx0TKIxeJ3794RBFFQUHD8+HHy+aqqKtRl2aU3sIsPHz68ePGCw+GYm5ujj66hocHIyIggiEePHqHiS0tLO7c0PnjwgHzv/+2rQ91Qd+/eVehdyNvol5aW1qUlUigUnj17dsuWLSUlJcS/PVuZmZndjt24cePjx4+7nTOfzw8NDT1/jxBEPHx8aampjExMT4+PhYWFkKhsLa21t7e/lMpKSsr27ZtW3JyMhksgiDS09O1tLTIIT4+Pt3G+v79++vXr09NTe12zn/99ZetrW1hYWFkZOSoUaPIFqtx48a1t7f/vvvTCYT/fq7IBuHXr161e2ceyQUCu3s7D7155SdnW1ra9ttI5NYLP7tt982b97M4XAIgvDy8lq2bJmvry86gUsQRFJSkp2dXUVFBYvFotPpZHeQvr4+QRBHjhzx8fHp9nZcIpEI/a5LS0vlfBcKtCaT7WllZWUEQXz8+BElPScnx87OTnbPFnmXxC7dLGlpaQ4ODp3j+Pz587CwsEuXLpF/lwKBIDIy0sXFpfOao729HbXw1tXVEQRRV1f35MkT8qd37tzhcrkEQTx79iwsLCw2NhbVjFRXV6M/fYFAIOP9CgSCtra2yMjI8ePHOzk5oSdRsHps2GptbT148KCiHdsFBQVoRSJ7nYT6K21tbVF/JfLgwQMbG5suNwFsamp6+vQp+ojINyUQCFgs1pQpUxgMBnoSBau1tVV2eeTWqaWlpcf3ovAd/RobG9Hcm5ubUQ9WSEgIj8eTZ2xDQ4Ofnx96fXFxsfxbSYIgUJP4gQMHeDxeXFzcpk2b8vPzexwllUrFYvGNGzdqamqSkpL4fH5kZKSHh8f79+/lWShBEJGRkf7+/hYWFrdu3SL+DZacYzkcDpPJDA0NbWtrE8iEPoSWlpYef7sksr/y7t27np6eR44ckf130hmLxTp27JipqSlaYaNgyen169dbtmzpsdlVybsm5+fne3p66uvrnzlzRs47iZFycnK8vLyMjY0PHjyo6AFrKysrdJ1damqqQgMpFIpEIlm4cOGJEyeWLVsm/6hTp07V19c7OTmtXr06Nzd3zpw5HA5n+PDh8s8hIiIiOTlZRlNNR0fHmzdvMjMz5Z8nicPhBAcHh4eHjx49Wv5RQUFBurq6K1assLa2zsvLmzBhgqJfh9ls9vfffy/r25X8Ue0P0NqbXIcrytXVVdEhkZGRAQEBBEH88ssvTCZToTUWKTY2VsYof3/ly9fKjrP3mCxWCdOnEAPvLy8FFpjyal/HXnvz/bs2fP8+fP6+nolxi5dupTBYHQ+Z0wqKyvr6OiYO3durwtUhr+/3797strJc0LFiE2m9/oKuri7bXNBrt/PnzEyZMUKI9xtDQ0MbGZtu2bf+97czBgwf37dunmlrlRqfT0XWw2tra586dmz9/vsoXMXAa/TBZuHAhn89Hj+fNmxcUFKToYVsKhUKj0YYNG3bhwoUupxQzMjKMjY0VbbHvPQaDQT42MTFRbvdONg1bY5FrC7WtujIyMm7fvk1O+vr6Knds3dLS8r8nqkeOHOnu7t6r+nqhubn5yJEjmGaukWssdCszRS956Cfq6+vv379vYGCwbNmyRYsW9WElEolE5Y2jJA373Zw8eZJCoRw7dkydqXr9+vWVK1fQ415e0JKVlbVlyxZHR8fKysrQ0NDU1FQlNqwaQcOClZKSkpycPHr0aA8PD7V1qvB4PLJTQyqV9mZWe/bsiY+PNzExoVAoDAbj0qVLW7ZsUUGJ/Y8mBSsqKio5OTkwMLC0tHTFihWZmZlffvll72fL4/FycnIeP35cXl4+fvz4oKCgLi9YtGgR2RYWGhqq9IJEIlFxcTFKFYVCWb58+b179yBYfYwgiGPHjuXm5o4ePdrMzOz169dxcXFeXl7Kze39+/c5OTmZmZk1NTVDhgwxMTFZt27drFmzsF5p09HR0fmQvY6OjoberU8eGhOs5ubmQYMGkScujI2NFb14UCgUvn371s3NTSgU0ul0c3NzPz+/Hq+umTRpUufXLF++XOkuZB0dnY6ODh6Ph+JVUVHRJ32npLt37+JrTtSYYKETBcqNlUgkcXFxqampZmZmEokkJCRE/rE/vhj58n4+HjlakDs7e1DQkIOHz7c2Nh45syZixcv9mZuSmtsbAwLC6PRaGFhYbiWofKTRPhMmDCB7ADx9/dHZ7s6e/ToUVRUVEpKCtnAI5VK2Wy2vb19YmIievLixYthYWHqLLszPp+/c+fOuXPnmpqaXr9+Xf0FfKp/SeU0KViRkZGrVq3Kzs5OSEiYMWNGl1anwMBAa2vr+Ph4Z2dnNzc3giDS09NtbW0TEhK6NHicOnUK9RV+bmR3XKqWJgWLIIibN29u3brVz8+vc9MfMmfOHHSDPKlUamVlJZFIXr169albV7JYrF42EGuWoqIihbrfek/DgiXDoUOHTE1Nb9y4Ied9UH/++WdF+7g1UVNTU0BAgK+v78ePH9W5XI0PVltb29u3b9HjrKwsZ2fnyZMn3759u8eBUqnUw8Ojc0PzgBQdHY1a4NVMyQ7SvlVRUZGVlfXs2bOWlhYdHR0rKytzc/N79+6hKzCrq6sXL15cWVkpFAo5HI6MnhCJRMJgMDw9PXH0jXzu1J/l3ggJCXFxcQkJCUlPT+/c0i8Wi6dOnYouyigsLBw/frxEIuHz+f7+/uj22lKp9J9/snNze2yI8/j8ezt7TtfagFUQiPXWN0qLi4ODQ2tqKgYMWLEgQMHDAwMnj596uTkRKFQWlpaVq9eTafTaTRaaWnpnTt3DAwMyIHoqpDZs2f3Xe0D0AAJVn19vYGBQZeWh4SEBCMjo8WLFwcGBlKpVBaLRaFQwsLCampqMB4YBEhfrzJVA10Wxmazu70iz8zMrKCgAD0uKytbsGCBeqv7HGnMKR3Z0FkaiUTS7Z3pmpubyevM9PX11XnrrM+WxgervLz82rVrNBrNzs7Oysqq29eMGTOmqqoKXf9YXV2tqf9PS6NoWM97F/n5+atWrRo1atTQoUOXLl1aVlbW7ctsbGwiIiLQucKoqKh169apuc7PUV9vi3vlp59+Iv8n1Pnz593d3bt9mVgs9vb2njVr1pw5c5hMplAoVGONnynN/lZoZGSUm5uLjh0UFBS4urrK+Oel6A2r9m7m4FM0ex9LJBINHjwYPR4yZIjs+4NpaWmp+VbsnzPN/vOdMmXKmzdv0OOioiL0rxZAf6DZwfLw8PD19a2srCwpKQkKCup8gS/oW5q9j0WhUBITE2NiYqhUKpPJJP+XDuhzGh8s0D9p9qYQ9FsQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtgAcECWECwABYQLIAFBAtg8X/9Y3TNttcdJQAAAll6VFh0cmRraXRQS0wgcmRraXQgMjAyNC4wOS4xAAB4nJVSz28SQRR+M7MsS/kh2AoKbAsLwgLGg9RGL+2u6cVDD7Zy3xNOPJu0UQ9NNCYmHjwYDdtgvArRv6CWauINmho9eCIm/gGY+A84s7M7kFg1TvL2ffP2m2++93YnB2/GwFaSBQaxLrC4yGIXaVDg9aSXVNVLigrLvIh8gJAi3/t7FUwGyJQQBsoLGM0AfoRMmQ7XxEHWRP2f+U98USdIZEROzuw+y7/fOsnHDN/yfDPBv4D/4f4GoigBCgbCHmxcIQwqQDhS0AhoEVDmFBxFEJsrqHEFJ+JwCmk4ySIV0vBpFvNhE2sLCjoTM3E6VshE4SyGcxiyIcilIb8Aeg4Wo7CUgUIGinmKjbxT0iku6875RaiUnGqZYrPo1AyK6zWnUXVUAnWT4kqD4muEW2QfSy2a9ZqRV0uVRrWsZ7Lsh0EQ/DRoHLGpsXvIN2h8yQa44uG9Vt8CeOjhW+vEbrc3Zb3Z3PIwNZ5Z1HjqYXc7KTnU+GAFOnh/IvHlyVdrpb8pz3ZTV339VXl2pX/XIjtbvp+c9ONuVyWH87sp3cdV2+3ovmbPardfHorWnlh7rde+h/dMk0g/ASY795h/0WM3tSH9HPWuz8zhHdN54eOPrJf7Hj5ev8Pwc19nieGbclZu59OA48/739fczrRHt/NA6jebwsNyqiX7OuolZurEtuZveDrhH4/WAn2uORoq8nuNhmL+Gz/frt4ei7s4fzT8MhA6WfvV4+OBmGGC8YcHQT3+bWMQnA00078AgLG1qNmTfxYAAAMgelRYdE1PTCByZGtpdCAyMDI0LjA5LjEAAHichVZLctswDN37FLyAOQQIkeKiizhOM51O7JkmzR267/2nD5QE0q6paLwgqCf88eCD0+fX+eefv84ePh8OzoWdXynFfcYQwuHN6cGdXl5/XNzzx9Npu3m+/r58vDsRJwnfBEe32KeP69t2Q+7qZp8o5RDcUXwIwjgFHPRxZobduyPylIu+P7Kf8xQeIqN7dpOPU1UElcQDoAA4e14sHqPnqvIBcLrRGH1c3/8HTHBSfOKymp5G0WRoLD6swB3TM4DJh7TkZyfqAmD2UugrIAV3gcqczfbyzQMkAdnCgc4hkoFEdVbAXkCk5Ym+rBXXZA5yRFKTlOXrkLRAFLyk9KX5hIbrPGUv08h+VmjYAApNPNA6A4oOsTYu06BDqAApPi6hHKdx9jkAidKb9TBylOmu9mMkQyeSbw1Ky+kBMlbkNhw7tWctE7FPDTqqEy+DVCxNeWg+1b4nK2iJg4Jyrv00m840Kj3rLLGlCZ1Hg3JyuWEG8mlkXdnOkQ0T+zKihqhF6hoPuR+Zj3yf0TBqp6jTRNE6b6fz40J3W/L3lE4VSaunYUvuA2Sq4YfGjMOY8l2iwpC+5yVRG9ODRUcEHrVOwUdjiDLiEgk3jqKio1EWqqyzkR5tpwdIXhK6VglEMaq9xBudSOjQT7mLaJiml8v5ZpEuq/V0vZzbaiVsTZraBiVsstjWJGEDItrvr9/sUipmbouPsNPsbYKY2zbHEfuJul1FWEPSNpKK7TWFqpzuTJL6iQXC3TIhXRNkhlRQa3L3pXoL7iczCYGV4puupBe5u8h6MbvUUTcrK7eLgguQryWBQw2EF7/NKdbsglDJ/FFBibO7UcdBkGT2VVAebBDNMXdJZs0yWM0cYs0zyIsbRDPN6lLHWOTqm46ZSEmnmVZBuYUtXVEdBoV0NxEtAKbg0tGGKCN0N5PewOOeBkQnPPbjTjrJ0TyEIDqw0eKCIDqYMXdTKjqA0fwR7VEMWrQuhiA6UGJxqVD/bPZTpP3StEzrN+aNpMUbMYzOUz89Km9/anE+/AMSUw6IzQwqVQAAAW56VFh0U01JTEVTIHJka2l0IDIwMjQuMDkuMQAAeJxdUjFuwzAM/EpHGVAIkbIkK0aAAOqQKR6KTkWmPKJLHl+SohKnAQL5eOTxSKm1q2uuTW36cqdtkn9rP+18vtxws5OPy821O97lh9O1SVonXQfbixU1J3JN1U7bx8MhApZK/jBDouRXxkvFIhjxLRCBliIBghxmriD4j4PACBHzPn90GPlDkGBOXLdi6B8SyNqSA3kvUaHMvcJgIBEc9AJZO84QxAhjUkODLzDXXfkLhrRPR8ixy1WV6/NUyNoM+/nEARZrVrWaPQtAlWZSJNYMpZhTiTMOOb+c5O7g6SRBTN149Otsjaiva41mi0ltzJj6xaEaizbGyCcbU+5Dt2peCKqAMDopGSDahnWaHQ56Z5bOS8jvWkoP32JFYbX7KOosA9p1Vl3wmIyfnE2yWH5eTM5w1WwpOqS+wsn/fh7lSQXPLw3JExPF/34fkbunxx9aaqjyz+rnAwAAAABJRU5ErkJggg==" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL86971</td>
<td>CHEMBL690412</td>
<td>CHEMBL243</td>
<td>Human immunodeficiency virus type 1 protease</td>
<td>=</td>
<td>0.8</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL6710</td>
<td>CHEMBL621508</td>
<td>CHEMBL324</td>
<td>Serotonin 2c (5-HT2c) receptor</td>
<td>=</td>
<td>0.26</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL314218</td>
<td>CHEMBL677606</td>
<td>CHEMBL248</td>
<td>Leukocyte elastase</td>
<td>=</td>
<td>0.03</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL438897</td>
<td>CHEMBL877834</td>
<td>CHEMBL1855</td>
<td>Gonadotropin-releasing hormone receptor</td>
<td>=</td>
<td>0.24</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td style="text-align: center;"><div style="width: 200px; height: 200px" data-content="rdkit/molecule">
<img src="https://greglandrum.github.io/rdkit-blog/posts/data:image/png;base64,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" class="img-fluid" alt="Mol">
</div></td>
<td>CHEMBL15928</td>
<td>CHEMBL616937</td>
<td>CHEMBL1983</td>
<td>Serotonin 1d (5-HT1d) receptor</td>
<td>=</td>
<td>0.7</td>
<td>nM</td>
<td>Ki</td>
<td></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The ACS1996 style will also be used when we do things like generate an XLSX file:</p>
<div id="f9b6b50e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T02:47:45.735938Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T02:47:44.832365Z&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">PandasTools.SaveXlsxFromFrame(df.head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/output.xlsx'</span>)</span></code></pre></div>
</div>
<p>As an aside: we can also set ACS1996 mode for the rendering in the notebook;</p>
<div id="b7e7aa96" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T03:18:11.467045Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T03:18:11.428734Z&quot;}" data-execution_count="18">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">Draw.SetACS1996Mode(IPythonConsole.drawOptions,Draw.MeanBondLength(df.ROMol[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))</span>
<span id="cb8-2"></span>
<span id="cb8-3">df.ROMol[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-10-22-using-acs1996-style-in-pandastools_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>That style is also used in <code>Draw.MolsToGridImage()</code>:</p>
<div id="3c6628d8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-10-22T03:19:15.483671Z&quot;,&quot;start_time&quot;:&quot;2024-10-22T03:19:15.420304Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">Draw.MolsToGridImage(df.ROMol[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-10-22-using-acs1996-style-in-pandastools_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>



 ]]></description>
  <category>documentation</category>
  <category>tutorial</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-10-22-using-acs1996-style-in-pandastools.html</guid>
  <pubDate>Mon, 21 Oct 2024 22:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/acs1996-style-in-pandas-1.png" medium="image" type="image/png" height="56" width="144"/>
</item>
<item>
  <title>What’s new in 2024.09.1, part II</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-10-10-whats-new-2024-09-2.html</link>
  <description><![CDATA[ 




<p>This is the second of a short series of posts providing brief introductions to new functionality in the RDKit 2024.09.1 release (added since the 2024.03.1 release).</p>
<div id="bc9ae709" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-2">rdkit.__version__</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>'2024.09.1'</code></pre>
</div>
</div>
<div id="e64587b3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span></code></pre></div>
</div>
<section id="improvements-to-rms-filtering-in-conformer-generation" class="level1">
<h1>Improvements to RMS filtering in conformer generation</h1>
<p>Here’s a simple molecule for demonstration purposes:</p>
<div id="bc208d1d" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">IPythonConsole.molSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb4-2">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CCc1cc(C(=O)O)cc(C(=O)O)c1'</span>)</span>
<span id="cb4-3">m</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-10-10-whats-new-2024-09-2_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d5e0eb11" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDistGeom</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolAlign</span>
<span id="cb5-3"></span>
<span id="cb5-4">mh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddHs(m)</span>
<span id="cb5-5">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb5-6">ps.randomSeed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xa100f</span></span>
<span id="cb5-7">cids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.EmbedMultipleConfs(mh,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,ps)</span>
<span id="cb5-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cids))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100</code></pre>
</div>
</div>
<div id="61fe949b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> py3Dmol</span>
<span id="cb7-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> drawit(ms, p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, confIds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, removeHs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cyanCarbon'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'blueCarbon'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'redCarbon'</span>)):</span>
<span id="cb7-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> confIds <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb7-4">            confIds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ms)</span>
<span id="cb7-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb7-6">            p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> py3Dmol.view(width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>, height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb7-7">        p.removeAllModels()</span>
<span id="cb7-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,(m,confId) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ms,confIds)):</span>
<span id="cb7-9">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> removeHs:</span>
<span id="cb7-10">                m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(m)</span>
<span id="cb7-11">            IPythonConsole.addMolToView(m,p,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>confId)</span>
<span id="cb7-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(ms):</span>
<span id="cb7-13">            p.setStyle({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'model'</span>:i,},</span>
<span id="cb7-14">                            {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'stick'</span>:{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'colorscheme'</span>:colors[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(colors)]}})</span>
<span id="cb7-15">        p.zoomTo()</span>
<span id="cb7-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> p.show()</span></code></pre></div>
</div>
<p>First a quick intro to the <code>symmetrizeConjugatedTerminalGroups</code> argument to <code>GetBestRMS()</code></p>
<div id="20a323e8" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb8-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb8-3">rms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolAlign.GetBestRMS(m1,m2,symmetrizeConjugatedTerminalGroups<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb8-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rms<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb8-5">drawit([m1,m2])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.86</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17284452507970846" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17284452507970846" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17284452507970846 = null;
var warn = document.getElementById("3dmolwarning_17284452507970846");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17284452507970846 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17284452507970846"),{backgroundColor:"white"});
viewer_17284452507970846.zoomTo();
    viewer_17284452507970846.removeAllModels();
    viewer_17284452507970846.addModel("\n     RDKit          3D\n\n 14 14  0  0  0  0  0  0  0  0999 V2000\n    2.9083   -1.1662    0.7671 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0149   -1.2542   -0.4246 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7447   -0.5041   -0.2932 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.3453   -1.1475    0.2326 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.5723   -0.5167    0.3898 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.7280   -1.2100    0.9509 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8513   -0.6608    1.1038 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5747   -2.5397    1.3325 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.6583    0.7992   -0.0073 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5956    1.4961   -0.5422 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7312    2.8973   -0.9521 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2505    3.5134   -1.4374 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9311    3.5390   -0.8065 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.5945    0.8149   -0.6724 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  6  7  2  0\n  6  8  1  0\n  5  9  2  0\n  9 10  1  0\n 10 11  1  0\n 11 12  2  0\n 11 13  1  0\n 10 14  2  0\n 14  3  1  0\nM  END\n","sdf");
    viewer_17284452507970846.setStyle({"stick": {}});
    viewer_17284452507970846.addModel("\n     RDKit          3D\n\n 14 14  0  0  0  0  0  0  0  0999 V2000\n    2.9462   -1.0221    0.7345 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0490   -1.1739   -0.4793 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7396   -0.5316   -0.2946 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.3639   -1.1701    0.2328 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.5722   -0.5209    0.3855 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.7372   -1.1997    0.9437 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8382   -0.6322    1.0904 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6564   -2.5350    1.3404 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7049    0.7991    0.0089 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.6007    1.4368   -0.5184 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7581    2.8320   -0.9114 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8761    3.3873   -0.7558 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2742    3.5854   -1.4539 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.6238    0.8057   -0.6816 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  6  7  2  0\n  6  8  1  0\n  5  9  2  0\n  9 10  1  0\n 10 11  1  0\n 11 12  2  0\n 11 13  1  0\n 10 14  2  0\n 14  3  1  0\nM  END\n","sdf");
    viewer_17284452507970846.setStyle({"stick": {}});
    viewer_17284452507970846.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17284452507970846.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17284452507970846.zoomTo();
viewer_17284452507970846.render();
});
</script>
</div>
</div>
<p>You can see here that one of the carboxylic acids is flipped. That’s why the calculated RMSD is pretty high even though the overlay is quite good.</p>
<p>Using <code>symmetrizeConjugatedTerminalGroups=True</code> (which is the default), the RMSD calculate treats the two oxygens of the carboxylic acid as equivalent and we get a much lower RMSD value:</p>
<div id="56ab8982" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">rms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolAlign.GetBestRMS(m1,m2)</span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rms<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.08</code></pre>
</div>
</div>
<p>If we look across a varietyof conformer pairs we can see that this frequently makes a difference in the RMSDs:</p>
<div id="1a5f0b7f" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>):</span>
<span id="cb12-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(i):</span>
<span id="cb12-3">        m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cids[i]))</span>
<span id="cb12-4">        m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cids[j]))</span>
<span id="cb12-5">        rms1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolAlign.GetBestRMS(m1,m2)</span>
<span id="cb12-6">        rms2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolAlign.GetBestRMS(m1,m2,symmetrizeConjugatedTerminalGroups<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb12-7">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>j<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rms1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rms2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1, 0: 0.08, 0.86
2, 0: 0.08, 0.86
2, 1: 0.09, 0.09
3, 0: 0.06, 0.85
3, 1: 0.08, 0.08
3, 2: 0.04, 0.04
4, 0: 0.08, 0.86
4, 1: 0.07, 0.58
4, 2: 0.12, 0.58
4, 3: 0.10, 0.58</code></pre>
</div>
</div>
<p>The <code>symmetrizeConjugatedTerminalGroups</code> option was added (and made the default) in the 2022.09.1 release of the RDKit. In the 2024.03.1 release we added support for this behavior to the RMSD pruning done during conformer generation and made it the default.</p>
<p>So if we turn on RMSD pruning for our simple test molecule, we now get only one conformer:</p>
<div id="8975b2b9" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb14-2">ps.randomSeed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xa100f</span></span>
<span id="cb14-3">ps.pruneRmsThresh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb14-4">cids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.EmbedMultipleConfs(mh,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,ps)</span>
<span id="cb14-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cids))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1</code></pre>
</div>
</div>
<p>The symmetrization can be disabled:</p>
<div id="b1dfd62c" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">ps.symmetrizeConjugatedTerminalGroupsForPruning<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb16-2">cids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.EmbedMultipleConfs(mh,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,ps)</span>
<span id="cb16-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cids))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3</code></pre>
</div>
</div>
</section>
<section id="interface-fo-the-pubchem-shape-based-alignment-code" class="level1">
<h1>Interface fo the PubChem shape-based alignment code</h1>
<p>The PubChem team has recently published <a href="https://github.com/ncbi/pubchem-align3d/">pubchem-align3d</a>, an open-source library for doing fast shape-based alignment of molecules.</p>
<p>We’ve put an RDKit wrapper around this and added it as an optional RDKit feature.</p>
<p>The API here is likely to evolve over the next couple of releases.</p>
<p>Start by reading in a set of test molecules. We’re using one of the sets from the paper “An Extensive and Diverse Set of Molecular Overlays for the Validation of Pharmacophore Programs” by <a href="https://doi.org/10.1021/ci400020a">Ilena Giangreco and coworkers</a></p>
<div id="e68e6334" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gzip</span>
<span id="cb18-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb18-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDistGeom</span>
<span id="cb18-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb18-5">IPythonConsole.ipython_3d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb18-6"></span>
<span id="cb18-7">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> Chem.ForwardSDMolSupplier(gzip.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/AZ_overlays/P27487.sdf.gz'</span>),removeHs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span>
<span id="cb18-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ms)</span>
<span id="cb18-9"></span>
<span id="cb18-10">ref <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ms.pop(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb18-11">ref</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[07:11:49] Explicit valence for atom # 21 C, 5, is greater than permitted
[07:11:49] ERROR: Could not sanitize molecule ending on line 1352
[07:11:49] ERROR: Explicit valence for atom # 21 C, 5, is greater than permitted</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728537109109565" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728537109109565" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728537109109565 = null;
var warn = document.getElementById("3dmolwarning_1728537109109565");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728537109109565 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728537109109565"),{backgroundColor:"white"});
viewer_1728537109109565.zoomTo();
    viewer_1728537109109565.removeAllModels();
    viewer_1728537109109565.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_1728537109109565.setStyle({"stick": {}});
    viewer_1728537109109565.setBackgroundColor("0xeeeeee");
    viewer_1728537109109565.zoomTo();
viewer_1728537109109565.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">

</div>
</div>
<p>Generate conformers for each of the molecules so that we have something to align</p>
<div id="7e35cf61" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb20-2">ps.randomSeed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xa100f</span></span>
<span id="cb20-3">ps.numThreads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span></span>
<span id="cb20-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb20-5">    rdDistGeom.EmbedMultipleConfs(m,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,ps)</span></code></pre></div>
</div>
<div id="0c0ad37b" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ms)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>37</code></pre>
</div>
</div>
<p>Make a copy of the molecules so that we can play with them</p>
<div id="62e14fcb" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> copy</span>
<span id="cb23-2">ms_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(ms)</span></code></pre></div>
</div>
<div id="cad1cae9" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(ms_save)</span></code></pre></div>
</div>
<p>Look at the two molecules to align, just to see where we are starting.</p>
<div id="7327395f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">drawit([ref,ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]])</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728537170695931" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728537170695931" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728537170695931 = null;
var warn = document.getElementById("3dmolwarning_1728537170695931");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728537170695931 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728537170695931"),{backgroundColor:"white"});
viewer_1728537170695931.zoomTo();
    viewer_1728537170695931.removeAllModels();
    viewer_1728537170695931.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_1728537170695931.setStyle({"stick": {}});
    viewer_1728537170695931.addModel("1rwq_lig_5AP\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    1.8235    1.7553    1.5163 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n    2.8830    1.5354    0.1130 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.8773    2.4564   -0.1761 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7040    2.2782   -1.2731 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.9704    3.4346   -1.6556 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n    4.5428    1.1601   -2.1051 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.5364    0.2259   -1.8147 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.7236    0.4184   -0.7204 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.6535   -0.4946   -0.3375 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8573   -1.8485   -0.1210 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.1990   -2.3941   -0.2877 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.9286   -2.4804    0.7989 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7806   -2.6198    0.2515 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.0400   -4.0120    0.4645 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4214    0.0151   -0.1778 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.6143   -0.7624    0.1880 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4389   -2.0754    0.4024 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9143   -0.1108    0.3297 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0313   -0.7835    0.7867 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.2073   -0.1017    0.9117 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3824   -0.7293    1.3740 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2530   -2.1060    1.6992 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.3458    1.2445    0.6016 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.2423    1.9233    0.1462 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.0700    1.2206    0.0282 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.2415    3.2656   -0.1988 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.0788    3.9278   -0.6692 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.9856    3.3100    0.4788 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1883    1.0076   -2.9719 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3797   -0.6468   -2.4325 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.5926   -2.7168   -1.2579 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8990   -2.8639    0.7390 H   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5665   -4.4937   -0.3210 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7269   -4.4783    1.3246 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.9588   -1.8257    1.0351 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2429   -2.4626    2.1079 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.8952   -2.7294    0.8629 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.5382   -2.2485    2.5468 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2609    1.7900    0.6956 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.1855    1.7534   -0.3345 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3272    4.0657    0.1193 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.6440    3.3298   -1.5264 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4071    4.8668   -1.1409 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  2  8  1  0\n  3  4  1  0\n  3 28  1  0\n  4  5  1  0\n  4  6  2  0\n  6  7  1  0\n  6 29  1  0\n  7  8  2  0\n  7 30  1  0\n  8  9  1  0\n  9 10  2  0\n  9 15  1  0\n 10 11  1  0\n 10 13  1  0\n 11 12  2  0\n 11 31  1  0\n 12 32  1  0\n 13 14  1  0\n 13 17  2  0\n 14 33  1  0\n 14 34  1  0\n 15 16  2  0\n 16 17  1  0\n 16 18  1  0\n 18 19  2  0\n 18 25  1  0\n 19 20  1  0\n 19 35  1  0\n 20 21  1  0\n 20 23  2  0\n 21 22  1  0\n 22 36  1  0\n 22 37  1  0\n 22 38  1  0\n 23 24  1  0\n 23 39  1  0\n 24 25  2  0\n 24 26  1  0\n 25 40  1  0\n 26 27  1  0\n 27 41  1  0\n 27 42  1  0\n 27 43  1  0\nM  END\n","sdf");
    viewer_1728537170695931.setStyle({"stick": {}});
    viewer_1728537170695931.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_1728537170695931.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_1728537170695931.zoomTo();
viewer_1728537170695931.render();
});
</script>
</div>
</div>
<p>Now align those and show the results:</p>
<div id="9722dea2" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdShapeAlign</span>
<span id="cb26-2">tpl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.AlignMol(ref,ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb26-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(tpl)</span>
<span id="cb26-4"></span>
<span id="cb26-5">drawit([ref,ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.4333876003130784, 0.03657366774970186)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285371717767177" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285371717767177" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285371717767177 = null;
var warn = document.getElementById("3dmolwarning_17285371717767177");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285371717767177 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285371717767177"),{backgroundColor:"white"});
viewer_17285371717767177.zoomTo();
    viewer_17285371717767177.removeAllModels();
    viewer_17285371717767177.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_17285371717767177.setStyle({"stick": {}});
    viewer_17285371717767177.addModel("1rwq_lig_5AP\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n   37.1332   53.0833   35.0233 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n   38.4229   52.9806   33.8125 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.6169   54.0007   32.8948 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.6281   53.9159   31.9519 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8901   55.1991   30.7806 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n   40.4687   52.7932   31.9164 C   0  0  0  0  0  0  0  0  0  0  0  0\n   40.2743   51.7586   32.8445 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.2644   51.8590   33.7749 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9850   50.8387   34.7781 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9419   50.3685   35.6639 C   0  0  0  0  0  0  0  0  0  0  0  0\n   41.2941   50.9090   35.5919 C   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5623   51.9084   36.3981 N   0  0  0  0  0  0  0  0  0  0  0  0\n   39.5693   49.4138   36.5818 C   0  0  0  0  0  0  0  0  0  0  0  0\n   40.5913   48.9594   37.4760 N   0  0  0  0  0  0  0  0  0  0  0  0\n   37.7358   50.3504   34.8447 N   0  0  0  0  0  0  0  0  0  0  0  0\n   37.3983   49.4168   35.7533 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.3092   48.9479   36.6199 N   0  0  0  0  0  0  0  0  0  0  0  0\n   36.0144   48.9484   35.7391 C   0  0  0  0  0  0  0  0  0  0  0  0\n   35.5258   48.0612   36.6789 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.2153   47.6847   36.6126 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.6547   46.7845   37.5420 O   0  0  0  0  0  0  0  0  0  0  0  0\n   34.5429   46.3063   38.5423 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.3362   48.1481   35.6431 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.8107   49.0303   34.7038 C   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1301   49.3966   34.7878 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.0429   49.5689   33.6834 O   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5746   50.4749   32.7305 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.9591   54.8576   32.9405 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.2698   52.7148   31.1791 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8995   50.8772   32.8480 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.0549   50.5165   34.9083 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.5159   52.3358   36.3894 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4972   48.6662   37.0072 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.4274   48.9326   38.4897 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.1794   47.6829   37.4423 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.9544   45.6489   39.2462 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.4346   45.7975   38.1397 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.9042   47.1453   39.1867 H   0  0  0  0  0  0  0  0  0  0  0  0\n   32.3076   47.8615   35.5807 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.5172   50.0988   34.0430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.7978   51.4579   33.1661 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.5104   50.0215   32.2834 H   0  0  0  0  0  0  0  0  0  0  0  0\n   32.8685   50.5116   31.8866 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  2  8  1  0\n  3  4  1  0\n  3 28  1  0\n  4  5  1  0\n  4  6  2  0\n  6  7  1  0\n  6 29  1  0\n  7  8  2  0\n  7 30  1  0\n  8  9  1  0\n  9 10  2  0\n  9 15  1  0\n 10 11  1  0\n 10 13  1  0\n 11 12  2  0\n 11 31  1  0\n 12 32  1  0\n 13 14  1  0\n 13 17  2  0\n 14 33  1  0\n 14 34  1  0\n 15 16  2  0\n 16 17  1  0\n 16 18  1  0\n 18 19  2  0\n 18 25  1  0\n 19 20  1  0\n 19 35  1  0\n 20 21  1  0\n 20 23  2  0\n 21 22  1  0\n 22 36  1  0\n 22 37  1  0\n 22 38  1  0\n 23 24  1  0\n 23 39  1  0\n 24 25  2  0\n 24 26  1  0\n 25 40  1  0\n 26 27  1  0\n 27 41  1  0\n 27 42  1  0\n 27 43  1  0\nM  END\n","sdf");
    viewer_17285371717767177.setStyle({"stick": {}});
    viewer_17285371717767177.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17285371717767177.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17285371717767177.zoomTo();
viewer_17285371717767177.render();
});
</script>
</div>
</div>
<p>Find the conformer from each molecule that aligns with the highest feature score (the code calls it “color” score in analogy to the terminology that’s used in ROCS) and see how long that takes.</p>
<div id="cf22dad6" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb28-2">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(ms_save)</span>
<span id="cb28-3">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb28-4">nAligns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb28-5">bestScores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb28-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb28-7">    best <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e8</span></span>
<span id="cb28-8">    bestConf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb28-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> conf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> m.GetConformers():</span>
<span id="cb28-10">        nAligns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb28-11">        shapeTani,colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.AlignMol(ref,m,probeConfId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>conf.GetId())</span>
<span id="cb28-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> best:</span>
<span id="cb28-13">            best <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colorTani</span>
<span id="cb28-14">            bestConf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conf.GetId()</span>
<span id="cb28-15">    bestScores.append((best,bestConf))</span>
<span id="cb28-16">t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb28-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds for </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nAligns<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> alignments, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>nAligns<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">s per alignment'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.50 seconds for 3700 alignments, 0.0004s per alignment</code></pre>
</div>
</div>
<div id="6b365762" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>([(tpl,i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,tpl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(bestScores)],reverse<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb30-2">order[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>[((0.41623472182088234, 53), 10),
 ((0.38375118479238873, 83), 14),
 ((0.343586129348326, 5), 1),
 ((0.3286720498960583, 87), 17),
 ((0.305952661317346, 20), 13)]</code></pre>
</div>
</div>
<div id="9522e9be" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">whichMol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> order[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb32-2">bestConf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bestScores[whichMol][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb32-3"></span>
<span id="cb32-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(bestScores[whichMol])</span>
<span id="cb32-5">drawit([ref,ms[whichMol]],confIds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,bestConf))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.41623472182088234, 53)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728537285213021" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728537285213021" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728537285213021 = null;
var warn = document.getElementById("3dmolwarning_1728537285213021");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728537285213021 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728537285213021"),{backgroundColor:"white"});
viewer_1728537285213021.zoomTo();
    viewer_1728537285213021.removeAllModels();
    viewer_1728537285213021.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_1728537285213021.setStyle({"stick": {}});
    viewer_1728537285213021.addModel("2iiv_lig_565\n     RDKit          3D\n\n 45 46  0  0  1  0  0  0  0  0999 V2000\n   43.6722   52.6471   34.1521 C   0  0  0  0  0  0  0  0  0  0  0  0\n   42.6306   51.7211   34.1936 C   0  0  0  0  0  0  0  0  0  0  0  0\n   42.1722   51.1973   35.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n   42.8235   51.6560   36.5320 C   0  0  0  0  0  0  0  0  0  0  0  0\n   43.8456   52.5640   36.4941 C   0  0  0  0  0  0  0  0  0  0  0  0\n   44.2964   53.0839   35.2983 C   0  0  0  0  0  0  0  0  0  0  0  0\n   44.4165   52.9522   37.6588 F   0  0  0  0  0  0  0  0  0  0  0  0\n   42.1075   51.3396   33.0071 F   0  0  0  0  0  0  0  0  0  0  0  0\n   41.0755   50.2626   35.5564 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.6954   50.9483   35.5780 C   0  0  2  0  0  0  0  0  0  0  0  0\n   38.6742   49.8702   35.7838 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2783   50.3539   35.8752 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2590   49.4386   35.9842 N   0  0  0  0  0  0  0  0  0  0  0  0\n   39.4501   51.5767   34.2773 N   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9794   51.5921   35.8584 O   0  0  0  0  0  0  0  0  0  0  0  0\n   36.3590   48.0281   36.0098 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2603   47.3405   34.6248 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.8888   47.9194   34.1491 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.9334   47.6131   35.1765 N   0  0  0  0  0  0  0  0  0  0  0  0\n   33.9335   48.7287   36.2240 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.8244   49.9643   36.0994 C   0  0  1  0  0  0  0  0  0  0  0  0\n   34.6703   50.7474   37.3622 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.1825   48.5816   37.1692 O   0  0  0  0  0  0  0  0  0  0  0  0\n   45.3063   53.9764   35.3182 F   0  0  0  0  0  0  0  0  0  0  0  0\n   44.0364   53.0641   33.2177 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.5071   51.2784   37.5056 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.0273   49.4774   34.7686 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.1720   49.7423   36.5224 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.7000   51.7130   36.3528 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.7653   49.1751   34.9156 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9066   49.3552   36.7286 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4395   51.8197   34.1976 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.5827   50.8232   33.5521 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9894   52.4362   34.1306 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.6051   47.5212   36.6416 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.3768   47.7053   36.3650 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.1782   46.2842   34.7906 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.0094   47.6303   33.9304 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6705   47.2631   33.2336 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.9085   48.9055   33.7994 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.3310   46.8647   35.3044 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6244   50.5160   35.1961 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.9950   50.1326   38.2382 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2031   51.7050   37.3251 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5789   50.9209   37.5083 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  1  6  1  0\n  1 25  1  0\n  2  3  1  0\n  2  8  1  0\n  3  4  2  0\n  3  9  1  0\n  4  5  1  0\n  4 26  1  0\n  5  6  2  0\n  5  7  1  0\n  6 24  1  0\n  9 10  1  0\n  9 27  1  0\n  9 28  1  0\n 10 11  1  0\n 10 14  1  0\n 10 29  1  1\n 11 12  1  0\n 11 30  1  0\n 11 31  1  0\n 12 13  1  0\n 12 15  2  0\n 13 16  1  0\n 13 21  1  0\n 14 32  1  0\n 14 33  1  0\n 14 34  1  0\n 16 17  1  0\n 16 35  1  0\n 16 36  1  0\n 17 18  1  0\n 17 37  1  0\n 17 38  1  0\n 18 19  1  0\n 18 39  1  0\n 18 40  1  0\n 19 20  1  0\n 19 41  1  0\n 20 21  1  0\n 20 23  2  0\n 21 22  1  0\n 21 42  1  6\n 22 43  1  0\n 22 44  1  0\n 22 45  1  0\nM  CHG  1  14   1\nM  END\n","sdf");
    viewer_1728537285213021.setStyle({"stick": {}});
    viewer_1728537285213021.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_1728537285213021.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_1728537285213021.zoomTo();
viewer_1728537285213021.render();
});
</script>
</div>
</div>
<p>Since the reference molecule remains the same in each of these alignments, we can save a bit of time by precomputing the shape of the reference:</p>
<div id="a45a14f0" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(ms_save)</span>
<span id="cb34-2"></span>
<span id="cb34-3">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb34-4">refShape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.PrepareConformer(ref)</span>
<span id="cb34-5"></span>
<span id="cb34-6">nAligns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb34-7">bestScores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb34-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb34-9">    best <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e8</span></span>
<span id="cb34-10">    bestConf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb34-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> conf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> m.GetConformers():</span>
<span id="cb34-12">        nAligns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb34-13">        shapeTani,colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.AlignMol(refShape,m,probeConfId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>conf.GetId())</span>
<span id="cb34-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> best:</span>
<span id="cb34-15">            best <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colorTani</span>
<span id="cb34-16">            bestConf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> conf.GetId()</span>
<span id="cb34-17">    bestScores.append((best,bestConf))</span>
<span id="cb34-18">t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb34-19"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> seconds for </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nAligns<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> alignments, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>(t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>nAligns<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2g}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">s per alignment'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.35 seconds for 3700 alignments, 0.00036s per alignment</code></pre>
</div>
</div>
<p>This, of course, does not change the results:</p>
<div id="cd00c908" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>([(tpl,i) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,tpl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(bestScores2)],reverse<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb36-2">order[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[((0.41623472182088234, 53), 10),
 ((0.38375118479238873, 83), 14),
 ((0.343586129348326, 5), 1),
 ((0.3286720498960583, 87), 17),
 ((0.305952661317346, 20), 13)]</code></pre>
</div>
</div>
<section id="about-the-features" class="level2">
<h2 class="anchored" data-anchor-id="about-the-features">About the features</h2>
<p>The default feature definitions used for scoring the alignments are a slightly modified version of the <a href="https://doi.org/10.1002/(SICI)1097-0290(199824)61:1%3C47::AID-BIT9%3E3.0.CO;2-Z">Gobbi and Poppinger</a> features used elsewhere in the RDKit.</p>
<p>If the molecules have property that <a href="https://pubchem.ncbi.nlm.nih.gov/docs/pubchem3d">PubChem3D</a> uses to indicate pharmacophore features - <code>PUBCHEM_PHARMACOPHORE_FEATURES</code> - those features will be used instead.</p>
<p>Here’s an example showing this with conformers downloaded from PubChem3D:</p>
<div id="df9a74ce" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb38-2">sdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://pubchem.ncbi.nlm.nih.gov/rest/pug/conformers/000011F200000003/SDF'</span>).content</span>
<span id="cb38-3">suppl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SDMolSupplier()</span>
<span id="cb38-4">suppl.SetData(sdf,removeHs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb38-5">omeprazole <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(suppl)</span>
<span id="cb38-6">omeprazole</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285427875475228" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285427875475228" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285427875475228 = null;
var warn = document.getElementById("3dmolwarning_17285427875475228");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285427875475228 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285427875475228"),{backgroundColor:"white"});
viewer_17285427875475228.zoomTo();
    viewer_17285427875475228.removeAllModels();
    viewer_17285427875475228.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_17285427875475228.setStyle({"stick": {}});
    viewer_17285427875475228.setBackgroundColor("0xeeeeee");
    viewer_17285427875475228.zoomTo();
viewer_17285427875475228.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">

</div>
</div>
<p>Look at the feature definitions;</p>
<div id="e2790203" class="cell" data-scrolled="true" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(omeprazole.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9
1 2 acceptor
1 3 acceptor
1 4 acceptor
1 5 donor
1 7 acceptor
3 5 6 11 cation
5 5 6 11 12 14 rings
6 12 14 17 19 20 21 rings
6 7 9 10 13 15 18 rings</code></pre>
</div>
</div>
<div id="a5b6bc46" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">sdf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://pubchem.ncbi.nlm.nih.gov/rest/pug/conformers/0005DA1100000001/SDF'</span>).content</span>
<span id="cb41-2">suppl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SDMolSupplier()</span>
<span id="cb41-3">suppl.SetData(sdf,removeHs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb41-4">mol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(suppl)</span>
<span id="cb41-5">mol</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285429342695057" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285429342695057" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285429342695057 = null;
var warn = document.getElementById("3dmolwarning_17285429342695057");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285429342695057 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285429342695057"),{backgroundColor:"white"});
viewer_17285429342695057.zoomTo();
    viewer_17285429342695057.removeAllModels();
    viewer_17285429342695057.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n   -0.4311    0.0004    1.0847 S   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9631   -2.3738   -0.2994 F   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9627    2.3737   -0.2998 F   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6642    2.3679    0.0662 F   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6641   -2.3681    0.0660 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.0189   -0.0006    0.2501 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0905    0.0007    1.4806 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5226   -0.0002   -0.6683 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9371    0.0000   -0.3028 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4491   -0.0001   -0.5050 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.2747    0.0003    0.7891 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8935   -0.0001   -0.5498 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.0736    0.0002    0.5669 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6181   -1.2079   -0.2099 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6183    1.2081   -0.2111 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.6059    0.0003    1.2071 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.8861   -0.0005   -1.5444 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.0005    1.2082   -0.0238 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.0003   -1.2079   -0.0225 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6916    0.0001    0.0705 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.5807   -0.0003    0.2038 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2293   -0.0005   -1.1480 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.1499    0.8780   -1.0895 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.1499   -0.8786   -1.0889 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.9868    0.0011    2.4864 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8761    0.0006    2.2569 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.6234   -0.0009   -2.5975 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6316   -0.0004    0.4825 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.0096   -0.0009   -1.9048 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_17285429342695057.setStyle({"stick": {}});
    viewer_17285429342695057.setBackgroundColor("0xeeeeee");
    viewer_17285429342695057.zoomTo();
viewer_17285429342695057.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">

</div>
</div>
<div id="92fafc6c" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(mol.GetProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5
1 7 donor
3 7 8 13 cation
5 7 8 11 12 13 rings
6 11 12 16 17 21 22 rings
6 9 14 15 18 19 20 rings</code></pre>
</div>
</div>
<p>Align the molecules:</p>
<div id="38b2186e" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1">shapeTani,colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.AlignMol(omeprazole,mol)</span>
<span id="cb44-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(shapeTani,colorTani)</span>
<span id="cb44-3">drawit([omeprazole,mol])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8584853463904615 0.5117278196011656</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285431073726847" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285431073726847" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285431073726847 = null;
var warn = document.getElementById("3dmolwarning_17285431073726847");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285431073726847 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285431073726847"),{backgroundColor:"white"});
viewer_17285431073726847.zoomTo();
    viewer_17285431073726847.removeAllModels();
    viewer_17285431073726847.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_17285431073726847.setStyle({"stick": {}});
    viewer_17285431073726847.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n    0.2156    0.7254   -0.7293 S   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4853    1.8433    1.8943 F   0  0  0  0  0  0  0  0  0  0  0  0\n    2.8046   -1.8088   -1.1222 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4873   -1.3794   -1.3485 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1682    2.2634    1.6612 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.6732    0.6557    0.0410 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4486    0.7871   -1.0868 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8171   -0.5363    0.5835 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6193    0.0133    0.3880 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1415   -0.2210    0.5152 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6086    0.2639   -0.5758 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.1879   -0.5588    0.4653 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4068    0.2797   -0.3614 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.2143    1.0500    1.0971 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3772   -0.8092   -0.4372 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9488    0.4345   -0.9244 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1476   -1.2608    1.2140 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7500   -0.5918   -0.5550 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.5871    1.2675    0.9793 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3550    0.4466    0.1534 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8906   -0.2716   -0.1685 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.4992   -1.1048    0.8819 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9200   -1.2889    0.4026 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8017    0.0626    1.5183 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3756    1.4329   -1.8614 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2501    1.0817   -1.7401 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8538   -1.9105    2.0323 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.9471   -0.1694   -0.4040 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2544   -1.6407    1.4512 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_17285431073726847.setStyle({"stick": {}});
    viewer_17285431073726847.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17285431073726847.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17285431073726847.zoomTo();
viewer_17285431073726847.render();
});
</script>
</div>
</div>
<p>If we remove the properties, the code uses the RDKit feature definitions, so we get a different feature score:</p>
<div id="d6db5a70" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(omeprazole)</span>
<span id="cb46-2">t1.ClearProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>)</span>
<span id="cb46-3">t2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(mol)</span>
<span id="cb46-4">t2.ClearProp(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>)</span>
<span id="cb46-5">shapeTani,colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.AlignMol(t1,t2)</span>
<span id="cb46-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(shapeTani,colorTani)</span>
<span id="cb46-7">drawit([t1,t2])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8584733801282853 0.4440077489499693</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728543170085571" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728543170085571" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728543170085571 = null;
var warn = document.getElementById("3dmolwarning_1728543170085571");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728543170085571 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728543170085571"),{backgroundColor:"white"});
viewer_1728543170085571.zoomTo();
    viewer_1728543170085571.removeAllModels();
    viewer_1728543170085571.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_1728543170085571.setStyle({"stick": {}});
    viewer_1728543170085571.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n    0.2128    0.7236   -0.7300 S   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4829    1.8459    1.8914 F   0  0  0  0  0  0  0  0  0  0  0  0\n    2.8017   -1.8113   -1.1189 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4843   -1.3824   -1.3463 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1658    2.2656    1.6571 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.6705    0.6551    0.0395 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4514    0.7847   -1.0872 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8197   -0.5359    0.5854 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6167    0.0134    0.3882 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1389   -0.2207    0.5160 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6114    0.2624   -0.5751 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.1905   -0.5586    0.4674 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4095    0.2785   -0.3611 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.2118    1.0512    1.0954 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3745   -0.8105   -0.4357 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9517    0.4324   -0.9237 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1502   -1.2593    1.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7472   -0.5934   -0.5541 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.5845    1.2685    0.9771 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3523    0.4462    0.1524 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8933   -0.2724   -0.1665 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.5018   -1.1038    0.8853 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9173   -1.2888    0.4053 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7992    0.0647    1.5187 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3786    1.4291   -1.8629 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2530    1.0782   -1.7406 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8562   -1.9076    2.0368 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.9498   -0.1706   -0.4020 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2569   -1.6387    1.4556 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_1728543170085571.setStyle({"stick": {}});
    viewer_1728543170085571.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_1728543170085571.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_1728543170085571.zoomTo();
viewer_1728543170085571.render();
});
</script>
</div>
</div>
<p>As a final note, it’s possible to disable the use of features in the scoring entirely:</p>
<div id="c5e6347a" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1">shapeTani,colorTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdShapeAlign.AlignMol(t1,t2,useColors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb48-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(shapeTani,colorTani)</span>
<span id="cb48-3">drawit([t1,t2])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8584733855324804 0.0</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285434059751809" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285434059751809" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285434059751809 = null;
var warn = document.getElementById("3dmolwarning_17285434059751809");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285434059751809 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285434059751809"),{backgroundColor:"white"});
viewer_17285434059751809.zoomTo();
    viewer_17285434059751809.removeAllModels();
    viewer_17285434059751809.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_17285434059751809.setStyle({"stick": {}});
    viewer_17285434059751809.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n    0.2128    0.7236   -0.7300 S   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4829    1.8459    1.8914 F   0  0  0  0  0  0  0  0  0  0  0  0\n    2.8017   -1.8113   -1.1189 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4843   -1.3824   -1.3463 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1658    2.2656    1.6571 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.6705    0.6551    0.0395 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4514    0.7847   -1.0872 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8197   -0.5359    0.5854 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6167    0.0134    0.3882 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1389   -0.2207    0.5160 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6114    0.2624   -0.5751 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.1905   -0.5586    0.4674 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4095    0.2785   -0.3611 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.2118    1.0512    1.0954 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3745   -0.8105   -0.4357 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9517    0.4324   -0.9237 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1502   -1.2593    1.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7472   -0.5934   -0.5541 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.5845    1.2685    0.9771 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3523    0.4462    0.1524 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8933   -0.2724   -0.1665 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.5018   -1.1038    0.8853 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9173   -1.2888    0.4053 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7992    0.0647    1.5187 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3786    1.4291   -1.8629 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2530    1.0782   -1.7406 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8562   -1.9076    2.0368 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.9498   -0.1706   -0.4020 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2569   -1.6387    1.4556 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_17285434059751809.setStyle({"stick": {}});
    viewer_17285434059751809.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17285434059751809.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17285434059751809.zoomTo();
viewer_17285434059751809.render();
});
</script>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>documentation</category>
  <category>release</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-10-10-whats-new-2024-09-2.html</guid>
  <pubDate>Wed, 09 Oct 2024 22:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/2024_09_whatsnew_2.png" medium="image" type="image/png" height="77" width="144"/>
</item>
<item>
  <title>What’s new in 2024.09.1, part I</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-09-29-whats-new-2024-09-1.html</link>
  <description><![CDATA[ 




<p>The 2024.09.1 version of the RDKit was released on the 27th of September. This is the first in a short series of posts providing brief introductions to new functionality added to the RDKit since the 2024.03.1 release.</p>
<div id="bc9ae709" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-2">rdkit.__version__</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>'2024.09.1'</code></pre>
</div>
</div>
<div id="e64587b3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span></code></pre></div>
</div>
<section id="rdmolprocessing" class="level1">
<h1>rdMolProcessing</h1>
<p>The idea of the <code>rdMolProcessing</code> package is to make it easy and fast to carry out common operations on molecules read from files.</p>
<p>In this initial release the only function provided generates fingerprints, but we will add additional capabilities in future releases.</p>
<div id="d5e0eb11" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolProcessing</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdFingerprintGenerator</span></code></pre></div>
</div>
<div id="61fe949b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">fname <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/BLSets_actives.txt'</span></span></code></pre></div>
</div>
<div id="18b2d5e9" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator()</span>
<span id="cb6-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit suppl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.SmilesMolSupplier(fname,delimiter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpg.GetFingerprint(m) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> suppl <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>16.4 s ± 35.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<p><code>rdMolProcessing.GetFingerprintsForMolsInFile()</code> does the same work, but operates entirely in C++ and uses multiple threads to read the molecules and generate the fingerprints in parallel.</p>
<div id="c47e0d61" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolProcessing.GetFingerprintsForMolsInFile(fname)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.73 s ± 12.6 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<p>Here’s a larger demonstration: generating fingerprints for all 2.3 million molecules in the ChEMBL 31 SDF file. Notice that we don’t need to uncompress the SDF file.</p>
<div id="78bd9439" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RDLogger</span>
<span id="cb10-2">RDLogger.DisableLog(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rdApp.*'</span>)</span>
<span id="cb10-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb10-4">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb10-5">fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolProcessing.GetFingerprintsForMolsInFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/scratch/Data/ChEMBL/chembl_31.sdf.gz'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb10-6">t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>time.time()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span> </span>
<span id="cb10-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>t1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>81.94</code></pre>
</div>
</div>
<p>The fingerprints are generated immediately after each molecule is parsed and then the molecule is discarded, so it’s only necessary to be able to store all of the fingerprints in memory, not all of the molecules.</p>
<p><code>GetFingerprintsForMolsInFile()</code> can figure out the file format automatically (as we saw above), but you can, if necessary, provide options controlling how the file is read.</p>
<div id="9759dbb4" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>head <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> ..<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>herg_data.txt</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>canonical_smiles molregno activity_id standard_value standard_units
N[C@@H]([C@@H]1CC[C@H](CC1)NS(=O)(=O)c2ccc(F)cc2F)C(=O)N3CC[C@H](F)C3 29272 671631 49000 nM
N[C@@H](C1CCCCC1)C(=O)N2CCSC2 29758 674222 28000 nM</code></pre>
</div>
</div>
<div id="c545e83d" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">opts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolProcessing.SupplierOptions()</span>
<span id="cb14-2">opts.delimiter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span></span>
<span id="cb14-3">fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolProcessing.GetFingerprintsForMolsInFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/herg_data.txt'</span>,options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>opts)</span>
<span id="cb14-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(fps)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>1090</code></pre>
</div>
</div>
<p>The default is to generate 2048 bit Morgan fingerprints with a radius of 3, but we can change this by providing a fingerprint generator to the call:</p>
<div id="6e6b603c" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetRDKitFPGenerator(maxPath<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb16-2">fps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolProcessing.GetFingerprintsForMolsInFile(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/herg_data.txt'</span>,options<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>opts,generator<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg)</span></code></pre></div>
</div>
</section>
<section id="rdmolalign.getallconformerbestrms" class="level1">
<h1>rdMolAlign.GetAllConformerBestRMS()</h1>
<p>The new function <code>GetAllConformerBestRMS()</code> makes it easy to calculate the RMSDs between all of the conformers of a molecule.</p>
<div id="a892dd29" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDistGeom</span>
<span id="cb17-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolAlign</span></code></pre></div>
</div>
<div id="418f3e91" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb18-2">ps.randomSeed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xa100f</span></span>
<span id="cb18-3">ps.numThreads <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb18-4"></span>
<span id="cb18-5">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddHs(Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'N[C@@H]([C@@H]1CC[C@H](CC1)NS(=O)(=O)c2ccc(F)cc2F)C(=O)N3CC[C@H](F)C3'</span>))</span>
<span id="cb18-6">rdDistGeom.EmbedMultipleConfs(m,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>,ps)</span>
<span id="cb18-7">m.GetNumConformers()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>100</code></pre>
</div>
</div>
<div id="6ccc44d8" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generating RMSDs with Hs generally doesn't make sense:</span></span>
<span id="cb20-2">m_noh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.RemoveHs(m)</span>
<span id="cb20-3">rmsds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolAlign.GetAllConformerBestRMS(m_noh)</span></code></pre></div>
</div>
<div id="e6d53145" class="cell" data-scrolled="true" data-execution_count="23">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(rmsds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>4950</code></pre>
</div>
</div>
<p>You can also run the calculation using multiple threads to speed things up:</p>
<div id="f50b3585" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit rmsds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolAlign.GetAllConformerBestRMS(m_noh,numThreads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.17 ms ± 49 μs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>documentation</category>
  <category>release</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-09-29-whats-new-2024-09-1.html</guid>
  <pubDate>Sat, 28 Sep 2024 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Additive fingerprints</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1.html</link>
  <description><![CDATA[ 




<p>This is a reformatted and lightly revised version of a <a href="https://rdkit.blogspot.com/2019/11/additive-fingerprints.html">blog post from 2019</a>.</p>
<p>The goal here is to evaluate one strategy for enabling similarity search of virtual libraries defined via molecular fragments that can be combined using simple rules. One obvious approach is to just enumerate the molecules in the library, generate their fingerprints, and the calculate similarity. This is clearly impractical if the libraries are really big, so I want to see if it’s possible to make things faster by skipping the enumeration step and approximating the fingerprint of a molecule with the sum of the fingerprints that make it up plus constant correction terms.</p>
<p>For example, suppose I form a molecule by combining the two fragments <code>c1ccccc1-[16*]</code> and <code>CCCCO-[3*]</code> to make <code>c1ccccc1-OCCCC</code>, I want to see how closely I can approximate the fingerprint of the final molecule by adding the fingerprints of the two fragments together with a correction term that is characteristic of the bond type being formed (in this case the <code>16-3</code> combination rule). This obviously won’t work well with fingerprints like Atom Pairs that include terms encompassing the entire molecule, but may be useful for more “local” descriptors like the Morgan fingerprint, topological torsions, or the RDKit fingerprint.</p>
<p>This isn’t a really new idea - it’s inspired by the idea behind <a href="http://pubs.acs.org/doi/abs/10.1021/ci0504871">Truchon and Bayly’s GLARE algorithm</a> and I’ve explored it a bit in the past - but I haven’t seen it published and never really dug into it. That’s what this post (likely a series of posts) is for.</p>
<p>Demonstrating that this really works requires a fair amount of effort, but we can get a good initial readout by comparing the calculated similarities between a bunch of real molecules calculated with their “real” fingerprints and then with the “additive” fingerprints. I’ll start here with the Morgan fingerprint, since that’s one of the more popular ones in the RDKit (and one where the approach seems likely to work). If that goes well, I’ll try another fingerprint type or two and maybe do some more comprehensive validation.</p>
<blockquote class="blockquote">
<p>Since the original post was published, a <a href="https://pubs.acs.org/doi/full/10.1021/acs.jcim.0c00850">paper from Matthias Rarey’s group</a> explored an efficient strategy for searching combinatorial library spaces using topological fingerprints.</p>
</blockquote>
<div id="cell-2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:59.978449Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:59.965723Z&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataStructs</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdFingerprintGenerator</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.MolStandardize <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolStandardize</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BRICS</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-12"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.03.5</code></pre>
</div>
</div>
<p>Start by reading in the set of molecules we’ll work with. This dataset was described in a recent <a href="https://rdkit.blogspot.com/2019/10/a-new-lessel-and-briem-like-dataset.html">RDKit blog post</a>.</p>
<p>Bring in the molecules and do salt stripping:</p>
<div id="cell-4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:14.197264Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:08.117933Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdBase</span>
<span id="cb3-2">rdBase.DisableLog(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rdApp.info'</span>)</span>
<span id="cb3-3">ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [rdMolStandardize.FragmentParent(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> Chem.SmilesMolSupplier(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/BLSets_selected_actives.txt'</span>)]</span>
<span id="cb3-4">_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.GetSymmSSSR(m) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms]</span>
<span id="cb3-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ms)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>6359</code></pre>
</div>
</div>
<p>In order to fragment the molecules we’re going to be using the <a href="http://doi.wiley.com/10.1002/cmdc.200800178">BRICS fragmentation rules</a> as implemented in the RDKit. Note that the RDKit implementation has differs from the published BRICS rules in that atom types 2 and 5 (both Ns) have been combined with each other. This is, unfortunately not (yet) documented outside of the code itself, but there’s an explanation here: https://github.com/rdkit/rdkit/blob/master/Code/GraphMol/ChemTransforms/MolFragmenter.cpp#L101</p>
<p>For the purposes of this evaluation as to whether or not additive fingerprints work, we will only be using the ten most common BRICS bonds in the dataset. Let’s start by finding those.</p>
<p>This is what the list of BRICS bonds for each molecule looks like:</p>
<div id="cell-6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:14.202874Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:14.198923Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(BRICS.FindBRICSBonds(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>[((2, 1), ('1', '5')),
 ((8, 7), ('1', '5')),
 ((6, 7), ('4', '5')),
 ((15, 20), ('5', '12')),
 ((8, 10), ('6', '13')),
 ((6, 30), ('8', '15')),
 ((23, 24), ('8', '16'))]</code></pre>
</div>
</div>
<p>The first element of each tuple contains the indices of the atoms defining the bond, the second element has the BRICS atom types of those atoms. For example, the first BRICS bond in the molecule above is between atom 2 (BRICS type 1) and atom 1 (BRICS type 5).</p>
<p>Loop over all the molecules and count the number of times each bond type occurs:</p>
<div id="cell-8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:16.710986Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:14.203972Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict, Counter</span>
<span id="cb7-2">cntr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Counter()</span>
<span id="cb7-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb7-4">    bbnds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BRICS.FindBRICSBonds(m)</span>
<span id="cb7-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aids,lbls <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> bbnds:</span>
<span id="cb7-6">        cntr[lbls] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb7-7">freqs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>([(y,x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cntr.items()],reverse<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb7-8">freqs[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[(7337, ('4', '5')),
 (4619, ('1', '5')),
 (3488, ('8', '16')),
 (2599, ('3', '16')),
 (1817, ('5', '16')),
 (1507, ('3', '4')),
 (997, ('6', '16')),
 (853, ('5', '15')),
 (789, ('8', '14')),
 (714, ('8', '15'))]</code></pre>
</div>
</div>
<p>The top two bond types are <code>4-5</code>(alkyl C - amine) and <code>1-5</code> (the amide bond).</p>
<p>Keep those top 10:</p>
<div id="cell-10" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:16.714314Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:16.712437Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">bondsToKeep <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> freqs[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]]</span></code></pre></div>
</div>
<p>In order to clarify what the more complex code below does, here’s a worked example demonstrating fragmenting a single molecule along two bonds, both between BRICS atom types 1 and 5 (these bonds and the types come from the example above where we found the molecule’s BRICS bonds):</p>
<div id="cell-12" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:18.088028Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:16.715288Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">tm<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Chem.FragmentOnSomeBonds(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].GetBondBetweenAtoms(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).GetIdx(),ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].GetBondBetweenAtoms(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>).GetIdx()],</span>
<span id="cb10-2">                         dummyLabels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]])</span>
<span id="cb10-3">[Chem.MolToSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tm]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>['[1*]C(=O)C(=O)C(NC(=O)[C@@H]1CC[C@H]2CN(S(=O)(=O)Cc3ccccc3)CC(=O)N21)[C@H]1CC[C@H](N)CC1.[5*]NC',
 '[1*]C(=O)[C@@H]1CC[C@H]2CN(S(=O)(=O)Cc3ccccc3)CC(=O)N21.[5*]NC(C(=O)C(=O)NC)[C@H]1CC[C@H](N)CC1']</code></pre>
</div>
</div>
<p>To make it visual, here’s a drawing of the two fragmentations:</p>
<div id="cell-14" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:18.262798Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:18.092745Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">fms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.FragmentOnSomeBonds(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],[ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].GetBondBetweenAtoms(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).GetIdx(),ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].GetBondBetweenAtoms(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>).GetIdx()],</span>
<span id="cb12-2">                         dummyLabels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>],[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]])</span>
<span id="cb12-3">Draw.MolsToGridImage(fms,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Let’s define some functions that we’ll use for the rest of this:</p>
<div id="cell-16" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:18.348232Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:18.264046Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> splitMol(mol,bondsToKeep):</span>
<span id="cb13-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">''' fragments a molecule on a particular set of BRICS bonds. </span></span>
<span id="cb13-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Partially sanitizes the results </span></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    '''</span></span>
<span id="cb13-5">    bbnds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BRICS.FindBRICSBonds(mol)</span>
<span id="cb13-6">    bndsToTry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb13-7">    lbls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb13-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aids,lbl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> bbnds:</span>
<span id="cb13-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> lbl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> bondsToKeep:</span>
<span id="cb13-10">            bndsToTry.append(mol.GetBondBetweenAtoms(aids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],aids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).GetIdx())</span>
<span id="cb13-11">            lbls.append([<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lbl])</span>
<span id="cb13-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> bndsToTry:</span>
<span id="cb13-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []</span>
<span id="cb13-14">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.FragmentOnSomeBonds(mol,bndsToTry,dummyLabels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>lbls)</span>
<span id="cb13-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We need at least a partial sanitization for the rest of what we will be doing:</span></span>
<span id="cb13-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> res:</span>
<span id="cb13-17">        entry.UpdatePropertyCache(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb13-18">        Chem.FastFindRings(entry)</span>
<span id="cb13-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res</span>
<span id="cb13-20"></span>
<span id="cb13-21"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> getDifferenceFPs(mol,bondsToKeep,fpgen):</span>
<span id="cb13-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">''' generates the difference fingerprint between the molecule</span></span>
<span id="cb13-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    and each of its fragmentations based on the BRICS bond types passed in.</span></span>
<span id="cb13-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb13-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This calculates the sum of the fragment fingerprints by just generating the</span></span>
<span id="cb13-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    fingerprint of the fragmented molecule, so whole-molecule fingerprints like</span></span>
<span id="cb13-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    atom pairs will not work here. That's fine since they are unlikely to be useful</span></span>
<span id="cb13-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    with this approach anyway</span></span>
<span id="cb13-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    '''</span></span>
<span id="cb13-30">    frags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> splitMol(mol,bondsToKeep)</span>
<span id="cb13-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> frags:</span>
<span id="cb13-32">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> []</span>
<span id="cb13-33">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb13-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># get the fingerprint for the molecule:</span></span>
<span id="cb13-35">    molfp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgen.GetCountFingerprint(mol)</span>
<span id="cb13-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now loop over each fragmentation</span></span>
<span id="cb13-37">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> frag <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags:</span>
<span id="cb13-38">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># generate the fingerprint of the fragmented molecule</span></span>
<span id="cb13-39">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (equivalent to the sum of the fingerprints of the fragments)</span></span>
<span id="cb13-40">        ffp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgen.GetCountFingerprint(frag)</span>
<span id="cb13-41">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and keep the difference</span></span>
<span id="cb13-42">        res.append(molfp<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>ffp)</span>
<span id="cb13-43">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res</span>
<span id="cb13-44"></span>
<span id="cb13-45"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> getSumFP(fragMol,fpgen,delta):</span>
<span id="cb13-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">''' Constructs the sum fingerprint for a fragmented molecule using</span></span>
<span id="cb13-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    delta as a constant offset</span></span>
<span id="cb13-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb13-49"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    note that any elements of the fingerprint that are negative after adding the</span></span>
<span id="cb13-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    constant offset will be set to zero</span></span>
<span id="cb13-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb13-52"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    '''</span></span>
<span id="cb13-53">    ffp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgen.GetCountFingerprint(fragMol)</span>
<span id="cb13-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx,v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> delta.GetNonzeroElements().items():</span>
<span id="cb13-55">        tv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ffp[idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> v</span>
<span id="cb13-56">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb13-57">            tv <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb13-58">        ffp[idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tv</span>
<span id="cb13-59">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ffp</span>
<span id="cb13-60">        </span></code></pre></div>
</div>
<div id="cell-17" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:18.450797Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:18.379029Z&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># demonstrate what splitMol returns:</span></span>
<span id="cb14-2">frags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> splitMol(ms[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],bondsToKeep[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb14-3">Draw.MolsToGridImage(frags)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now walk through the analysis with a single bond type: <code>1-5</code></p>
<p>The first thing we need to do is determine the constant offset term for this bond type. We will do that by generating difference fingerprints for all the fragmentations it generates and then averaging those difference fingerprints.</p>
<p>Start by generating the difference fingerprints for all the fragmentations using that bond type:</p>
<div id="cell-19" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:22.585306Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:19.109765Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for this analysis we will use a 4096 "bit" count-based Morgan fingerprints with a radius of 2</span></span>
<span id="cb15-2">fpgen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4096</span>)</span>
<span id="cb15-3">dfps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb15-5">    dfps.extend(getDifferenceFPs(m,bondsToKeep[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],fpgen))</span></code></pre></div>
</div>
<p>Now find the average value of the difference fingerprint, being careful to keep only integer values:</p>
<div id="cell-21" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:22.628417Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:22.586574Z&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">delta1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dfps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb16-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> dfp <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dfps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]:</span>
<span id="cb16-3">    delta1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> dfp</span>
<span id="cb16-4">nfps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dfps)</span>
<span id="cb16-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k,v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> delta1.GetNonzeroElements().items():</span>
<span id="cb16-6">    delta1[k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>nfps)</span>
<span id="cb16-7">delta1.GetNonzeroElements()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>{226: -2, 264: -1, 1831: -1}</code></pre>
</div>
</div>
<p>To quickly summarize that this is telling us: We can simulate the MFP2 fingerprint for a molecule by adding the MFP2 fingerprints of its bond type <code>1-5</code> fragments and then substracting one each from the values for bits 264 and 1831 and two from the value for bit 226.</p>
<p>Let’s look at how well that works across all the molecules. We start by generating the full FP and the <code>1-5</code> fragment FP for every molecule that has a <code>1-5</code> fragment:</p>
<div id="cell-23" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:26.476872Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:22.629421Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">allfps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb18-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb18-3">    frags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> splitMol(m,bondsToKeep[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb18-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> frags:</span>
<span id="cb18-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb18-6">    fp1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgen.GetCountFingerprint(m)</span>
<span id="cb18-7">    ffps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [getSumFP(x,fpgen,delta1) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags]</span>
<span id="cb18-8">    allfps.append((fp1,ffps))</span></code></pre></div>
</div>
<div id="cell-24" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:26.481011Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:26.478207Z&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>2801</code></pre>
</div>
</div>
<p>And calculate the similarity of each molecule to itself by calculating the Tanimoto similarity between the full fingerprint and the fragment fingerprint:</p>
<div id="cell-26" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:26.588111Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:26.481896Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">self_tanis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb21-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fp1,ffps <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> allfps:</span>
<span id="cb21-3">    self_tanis.extend([DataStructs.TanimotoSimilarity(fp1,x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ffps])</span></code></pre></div>
</div>
<p>Visualize those:</p>
<div id="cell-28" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:34.867463Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:34.751222Z&quot;}" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">plt.hist(self_tanis,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb22-2">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"self similarity, fusion 1-5"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Though that’s interesting, and good to see that the self-similarities aren’t all too far from 1.0, we’re actually more interested in using the fingerprints for comparing different molecules to each other.</p>
<p>Look at a bunch of random pairs of molecules that are at least 0.3 similar to each other (the <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-05-18-fingerprint-thresholds1.html">noise threshold</a> for count-based MFP2 is around 0.3), and then look at how different the similarities between their normal and fragment fingerprints are.</p>
<div id="cell-30" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:20:40.232712Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:20:39.588025Z&quot;}" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb23-2">random.seed(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb23-3">ps1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)))</span>
<span id="cb23-4">random.shuffle(ps1)</span>
<span id="cb23-5">ps1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ps1[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>]</span>
<span id="cb23-6">ps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)))</span>
<span id="cb23-7">random.shuffle(ps2)</span>
<span id="cb23-8">ps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ps2[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>]</span>
<span id="cb23-9"></span>
<span id="cb23-10">nCompared <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb23-11">other_tanidiff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb23-12"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps1:</span>
<span id="cb23-13">    fp1,frags1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> allfps[i]</span>
<span id="cb23-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps2:</span>
<span id="cb23-15">        fp2,frags2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> allfps[j]</span>
<span id="cb23-16">        refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataStructs.TanimotoSimilarity(fp1,fp2)</span>
<span id="cb23-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>:</span>
<span id="cb23-18">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb23-19">        nCompared <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb23-20">        ltanis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb23-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f1 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags1:</span>
<span id="cb23-22">            ltanis.extend(DataStructs.BulkTanimotoSimilarity(f1,frags2))</span>
<span id="cb23-23">        other_tanidiff.extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ltanis])</span>
<span id="cb23-24"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"considered </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nCompared<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> fingerprint pairs from </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>considered 15382 fingerprint pairs from 7845601</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T05:22:06.692154Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T05:22:06.476816Z&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">median <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.median(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff))</span>
<span id="cb25-2">bins <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff),[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>])</span>
<span id="cb25-3">iqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb25-4">plt.hist(other_tanidiff,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-5">gzero <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.array(other_tanidiff)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(other_tanidiff)</span>
<span id="cb25-6">plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'MAD=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>median<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, IQR=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>iqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>gzero<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&gt;-.005'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-7">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Delta$Similarity'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-8">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'count'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The title of the plot shows statistics about the similarity differences: the median absolute deviation (MAD), the inter-quartile range (IQR), the 90% and 95% bins of the absolute deviations, and the fraction of the differences which are greater than -0.005 (I chose 0.005 as an conservative tolerance value for considering the similarities identical).</p>
<p>That looks pretty good. For at least the <code>1-5</code> fragmentation, the similarity calculated with the fragment fingerprint is quite similar to that calculated with the full fingerprint. Even better: most of the deviation happens to the high-similarity side (87% exceed the -0.005 tolerance value), so we should be able to safely use the fragment-fingerprint similarity as a filter to identify interesting molecules.</p>
<section id="validation" class="level1">
<h1>Validation</h1>
<p>Repeat that analysis for each of the top 10 fragmentations:</p>
<div id="cell-34" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T03:30:09.764668Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T03:28:44.748774Z&quot;}" data-execution_count="91">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb26-2">random.seed(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb26-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict</span>
<span id="cb26-4">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb26-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> bondsToKeep:</span>
<span id="cb26-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Doing </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-7">    fpgen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4096</span>)</span>
<span id="cb26-8">    dfps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb26-10">        dfps.extend(getDifferenceFPs(m,[btk],fpgen))</span>
<span id="cb26-11"></span>
<span id="cb26-12">    delta1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dfps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb26-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> dfp <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dfps[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]:</span>
<span id="cb26-14">        delta1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> dfp</span>
<span id="cb26-15">    nfps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(dfps)</span>
<span id="cb26-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k,v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> delta1.GetNonzeroElements().items():</span>
<span id="cb26-17">        delta1[k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(v<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>nfps)</span>
<span id="cb26-18"></span>
<span id="cb26-19">    allfps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb26-21">        frags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> splitMol(m,[btk])</span>
<span id="cb26-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> frags:</span>
<span id="cb26-23">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb26-24">        fp1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgen.GetCountFingerprint(m)</span>
<span id="cb26-25">        ffps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [getSumFP(x,fpgen,delta1) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags]</span>
<span id="cb26-26">        allfps.append((fp1,ffps))</span>
<span id="cb26-27"></span>
<span id="cb26-28">    self_tanis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fp1,ffps <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> allfps:</span>
<span id="cb26-30">        self_tanis.extend([DataStructs.TanimotoSimilarity(fp1,x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ffps])</span>
<span id="cb26-31">        </span>
<span id="cb26-32">    ps1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)))</span>
<span id="cb26-33">    random.shuffle(ps1)</span>
<span id="cb26-34">    ps1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ps1[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]</span>
<span id="cb26-35">    ps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)))</span>
<span id="cb26-36">    random.shuffle(ps2)</span>
<span id="cb26-37">    ps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ps2[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]</span>
<span id="cb26-38"></span>
<span id="cb26-39">    nCompared <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb26-40">    other_tanidiff1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb26-41">    other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb26-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps1:</span>
<span id="cb26-43">        fp1,frags1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> allfps[i]</span>
<span id="cb26-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps2:</span>
<span id="cb26-45">            fp2,frags2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> allfps[j]</span>
<span id="cb26-46">            refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataStructs.TanimotoSimilarity(fp1,fp2)</span>
<span id="cb26-47">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>:</span>
<span id="cb26-48">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb26-49">            nCompared <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb26-50">            ltanis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb26-51">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f1 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags1:</span>
<span id="cb26-52">                ltanis.extend(DataStructs.BulkTanimotoSimilarity(f1,frags2))</span>
<span id="cb26-53">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> thresh <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>):</span>
<span id="cb26-54">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> thresh:</span>
<span id="cb26-55">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb26-56">                other_tanidiff1[thresh].extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ltanis])</span>
<span id="cb26-57">                other_tanidiff2[thresh].extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> DataStructs.BulkTanimotoSimilarity(fp1,frags2)])</span>
<span id="cb26-58">                other_tanidiff2[thresh].extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> DataStructs.BulkTanimotoSimilarity(fp2,frags1)])</span>
<span id="cb26-59"></span>
<span id="cb26-60">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"considered </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nCompared<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> fingerprint pairs from </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-61">    results[btk] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (self_tanis,other_tanidiff1,other_tanidiff2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Doing ('4', '5')
considered 66995 fingerprint pairs from 18326961
Doing ('1', '5')
considered 63242 fingerprint pairs from 7845601
Doing ('8', '16')
considered 54070 fingerprint pairs from 6095961
Doing ('3', '16')
considered 95650 fingerprint pairs from 4260096
Doing ('5', '16')
considered 217114 fingerprint pairs from 2725801
Doing ('3', '4')
considered 112805 fingerprint pairs from 1537600
Doing ('6', '16')
considered 98275 fingerprint pairs from 790321
Doing ('5', '15')
considered 53490 fingerprint pairs from 640000
Doing ('8', '14')
considered 43291 fingerprint pairs from 502681
Doing ('8', '15')
considered 35148 fingerprint pairs from 352836</code></pre>
</div>
</div>
<p>Start, again, by looking at self similarities.</p>
<div id="cell-36" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T03:30:32.384729Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T03:30:31.317658Z&quot;}" data-execution_count="92">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb28-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(results.keys()):</span>
<span id="cb28-3">    plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb28-4">    self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb28-5">    plt.hist(self_tanis,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb28-6">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"self similarity, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span>    </span>
<span id="cb28-7">    plt.xlim((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The differences here aren’t huge, but we definitely aren’t getting self-similarities of 1.</p>
<p>Still, we aren’t really interested in self-similarity. How does the method do when we compute fragment-fragment similarities? This time we plot the difference between the similarities calculated with the full fingerprint and the fragment fingerprints.</p>
<div id="cell-39" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T03:30:39.576749Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T03:30:35.989374Z&quot;}" data-execution_count="93">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb29-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(results.keys()):</span>
<span id="cb29-3">    plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb29-4">    self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb29-5">    other_tanidiff1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other_tanidiff1[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>]</span>
<span id="cb29-6">    other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other_tanidiff2[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>]</span>
<span id="cb29-7">    plt.hist(other_tanidiff1,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'fragfp-fragfp </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-8">    plt.legend()</span>
<span id="cb29-9">    median <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.median(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff1))</span>
<span id="cb29-10">    std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.std(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff1))</span>
<span id="cb29-11">    bins <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff1),[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>])</span>
<span id="cb29-12">    iqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb29-13">    gzero <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.array(other_tanidiff1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(other_tanidiff1)</span>
<span id="cb29-14">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'MAD=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>median<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, IQR=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>iqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>gzero<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&gt;-.005'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-15">    plt.xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-16">plt.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Those look good! In general the difference in similarities is within 0.05.</p>
<p>And, finally, since we could also query the collection of fragment molecules with a full fingerprint, look at the difference between the full FP similarity and the full FP - fragment FP similarity:</p>
<div id="cell-42" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T03:30:51.488192Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T03:30:47.368017Z&quot;}" data-execution_count="94">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb30-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(results.keys()):</span>
<span id="cb30-3">    plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb30-4">    self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb30-5">    other_tanidiff1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other_tanidiff1[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>]</span>
<span id="cb30-6">    other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> other_tanidiff2[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>]</span>
<span id="cb30-7">    plt.hist(other_tanidiff2,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'fp-fragfp </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-8">    plt.legend()</span>
<span id="cb30-9">    median <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.median(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff2))</span>
<span id="cb30-10">    std <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.std(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff2))</span>
<span id="cb30-11">    bins <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">abs</span>(other_tanidiff2),[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>])</span>
<span id="cb30-12">    iqr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb30-13">    gzero <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(np.array(other_tanidiff2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.005</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(other_tanidiff2)</span>
<span id="cb30-14">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'MAD=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>median<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, IQR=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>iqr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>gzero<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">&gt;-.005'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-15"></span>
<span id="cb30-16">    plt.xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb30-17">plt.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here the differences are larger than when we search with the fragment fps, but they still aren’t huge. This form of the query also has the characteristic that the similarity calculated against the fragment fps is usually lower than that calculated against the full fp.</p>
<section id="tolerances-for-searching" class="level2">
<h2 class="anchored" data-anchor-id="tolerances-for-searching">Tolerances for searching</h2>
<p>Suppose we want to use the fragment fingerprints for similarity searching with a threshold and be sure that we don’t miss any results. How would we need to adjust the threshold?</p>
<div id="cell-45" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-20T03:32:37.594990Z&quot;,&quot;start_time&quot;:&quot;2024-09-20T03:32:37.324895Z&quot;}" data-execution_count="97">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> thresh <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>):</span>
<span id="cb31-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Threshold: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>thresh<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb31-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'            </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   frag-frag</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">   fp-frag'</span>)</span>
<span id="cb31-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(results.keys()):</span>
<span id="cb31-5">        self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb31-6">        bins1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(other_tanidiff1[thresh],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>])</span>
<span id="cb31-7">        bins2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(other_tanidiff2[thresh],[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>])</span>
<span id="cb31-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: 6.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: 6.3f}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: 6.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bins2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: 6.3f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb31-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-----------'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Threshold: 0.3
                   frag-frag       fp-frag
('4', '5'): -0.025 -0.015   -0.006  0.000
('1', '5'): -0.022 -0.010   -0.004  0.000
('8', '16'):    -0.032 -0.021   -0.012 -0.007
('3', '16'):    -0.026 -0.021   -0.013 -0.010
('5', '16'):    -0.029 -0.019   -0.016 -0.002
('3', '4'): -0.032 -0.019   -0.018 -0.009
('6', '16'):    -0.043 -0.029   -0.025 -0.015
('5', '15'):    -0.048 -0.026   -0.005 -0.002
('8', '14'):    -0.042 -0.016   -0.010 -0.002
('8', '15'):    -0.053 -0.028   -0.014 -0.003
-----------
Threshold: 0.5
                   frag-frag       fp-frag
('4', '5'): -0.023 -0.008    0.000  0.004
('1', '5'): -0.022 -0.004   -0.003  0.000
('8', '16'):    -0.035 -0.019   -0.012 -0.004
('3', '16'):    -0.030 -0.012   -0.011  0.000
('5', '16'):    -0.028 -0.016    0.008  0.014
('3', '4'): -0.028 -0.009   -0.005  0.004
('6', '16'):    -0.036 -0.028   -0.004  0.006
('5', '15'):    -0.060 -0.020   -0.006  0.026
('8', '14'):    -0.050 -0.016   -0.008  0.000
('8', '15'):    -0.056 -0.035    0.000  0.006
-----------
Threshold: 0.7
                   frag-frag       fp-frag
('4', '5'): -0.016 -0.003    0.000  0.008
('1', '5'): -0.023 -0.002    0.000  0.005
('8', '16'):    -0.035 -0.012   -0.009  0.006
('3', '16'):    -0.034 -0.003   -0.009  0.029
('5', '16'):    -0.029 -0.012    0.011  0.047
('3', '4'): -0.022 -0.006   -0.001  0.014
('6', '16'):    -0.034 -0.009    0.009  0.035
('5', '15'):    -0.026 -0.012    0.036  0.058
('8', '14'):    -0.061 -0.021    0.000  0.028
('8', '15'):    -0.061 -0.032   -0.001  0.017
-----------</code></pre>
</div>
</div>
<p>In order to be sure of retrieving 99% of the actual results when searching using the full fingerprint of the query molecule against the fragment fingerprint of the database molecules (these are the fp-frag results), we’d need to use a search threshold of 0.275 (true threshold = 0.3), 0.488 (true threshold = 0.5), or 0.691 (true threshold = 0.7).</p>
</section>
</section>
<section id="what-about-if-we-dont-use-the-constant-offset" class="level1">
<h1>What about if we don’t use the constant offset?</h1>
<p>I went into this convinced that the constant offset was important. What if we just use the simple additive fingerprints without including that offset?</p>
<div id="cell-49" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-19T17:07:43.102411Z&quot;,&quot;start_time&quot;:&quot;2024-09-19T17:06:17.200690Z&quot;}" data-execution_count="41">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb33-2">random.seed(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb33-3">noconstant_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb33-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> bondsToKeep:</span>
<span id="cb33-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Doing </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb33-6">    fpgen <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4096</span>)</span>
<span id="cb33-7">    dfps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb33-9">        dfps.extend(getDifferenceFPs(m,[btk],fpgen))</span>
<span id="cb33-10"></span>
<span id="cb33-11">    allfps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ms:</span>
<span id="cb33-13">        frags <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> splitMol(m,[btk])</span>
<span id="cb33-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> frags:</span>
<span id="cb33-15">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb33-16">        fp1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgen.GetCountFingerprint(m)</span>
<span id="cb33-17">        ffps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [fpgen.GetCountFingerprint(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags]</span>
<span id="cb33-18">        allfps.append((fp1,ffps))</span>
<span id="cb33-19"></span>
<span id="cb33-20">    self_tanis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> fp1,ffps <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> allfps:</span>
<span id="cb33-22">        self_tanis.extend([DataStructs.TanimotoSimilarity(fp1,x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ffps])</span>
<span id="cb33-23">        </span>
<span id="cb33-24">    ps1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)))</span>
<span id="cb33-25">    random.shuffle(ps1)</span>
<span id="cb33-26">    ps1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ps1[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]</span>
<span id="cb33-27">    ps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)))</span>
<span id="cb33-28">    random.shuffle(ps2)</span>
<span id="cb33-29">    ps2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ps2[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>]</span>
<span id="cb33-30"></span>
<span id="cb33-31">    nCompared <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb33-32">    other_tanidiff1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-33">    other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps1:</span>
<span id="cb33-35">        fp1,frags1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> allfps[i]</span>
<span id="cb33-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ps2:</span>
<span id="cb33-37">            fp2,frags2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> allfps[j]</span>
<span id="cb33-38">            refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataStructs.TanimotoSimilarity(fp1,fp2)</span>
<span id="cb33-39">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> refTani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>:</span>
<span id="cb33-40">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb33-41">            nCompared <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb33-42">            ltanis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb33-43">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f1 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> frags1:</span>
<span id="cb33-44">                ltanis.extend(DataStructs.BulkTanimotoSimilarity(f1,frags2))</span>
<span id="cb33-45">            other_tanidiff1.extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ltanis])</span>
<span id="cb33-46">            other_tanidiff2.extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> DataStructs.BulkTanimotoSimilarity(fp1,frags2)])</span>
<span id="cb33-47">            other_tanidiff2.extend([refTani<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> DataStructs.BulkTanimotoSimilarity(fp2,frags1)])</span>
<span id="cb33-48"></span>
<span id="cb33-49">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"considered </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nCompared<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> fingerprint pairs from </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(allfps)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb33-50">    noconstant_results[btk] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (self_tanis,other_tanidiff1,other_tanidiff2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Doing ('4', '5')
considered 66995 fingerprint pairs from 18326961
Doing ('1', '5')
considered 63242 fingerprint pairs from 7845601
Doing ('8', '16')
considered 54070 fingerprint pairs from 6095961
Doing ('3', '16')
considered 95650 fingerprint pairs from 4260096
Doing ('5', '16')
considered 217114 fingerprint pairs from 2725801
Doing ('3', '4')
considered 112805 fingerprint pairs from 1537600
Doing ('6', '16')
considered 98275 fingerprint pairs from 790321
Doing ('5', '15')
considered 53490 fingerprint pairs from 640000
Doing ('8', '14')
considered 43291 fingerprint pairs from 502681
Doing ('8', '15')
considered 35148 fingerprint pairs from 352836</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-19T17:22:48.750129Z&quot;,&quot;start_time&quot;:&quot;2024-09-19T17:22:47.112204Z&quot;}" data-execution_count="51">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb35-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(noconstant_results.keys()):</span>
<span id="cb35-3">    subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb35-4">    self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb35-5">    self_tanis_2,other_tanidiff1_2,other_tanidiff2_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noconstant_results[btk]</span>
<span id="cb35-6">    plt.hist([self_tanis,self_tanis_2],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'with constant'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'no constant'</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-7">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"self similarity, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb35-8">    plt.legend()</span>
<span id="cb35-9">    plt.xlim((<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>))</span>
<span id="cb35-10">plt.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here the red histograms are clearly shifted to the left; the constant is helping.</p>
<div id="cell-52" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-19T17:22:57.089543Z&quot;,&quot;start_time&quot;:&quot;2024-09-19T17:22:55.280399Z&quot;}" data-execution_count="52">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb36-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(noconstant_results.keys()):</span>
<span id="cb36-3">    plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb36-4">    self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb36-5">    self_tanis_2,other_tanidiff1_2,other_tanidiff2_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noconstant_results[btk]</span>
<span id="cb36-6">    plt.hist([other_tanidiff1,other_tanidiff1_2],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'with constant'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'no constant'</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb36-7">    plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb36-8">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"fragfp-fragfp comparison, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb36-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#yscale('log')</span></span>
<span id="cb36-10">    plt.xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here the differences aren’t as pronounced. It looks like the constant term has the consequence of making the similarity a bit lower(the red histograms are shifted a bit to the left). The difference is, in any case, not large</p>
<div id="cell-54" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-09-19T17:23:03.162915Z&quot;,&quot;start_time&quot;:&quot;2024-09-19T17:23:01.313284Z&quot;}" data-execution_count="53">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb37-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,btk <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(noconstant_results.keys()):</span>
<span id="cb37-3">    plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb37-4">    self_tanis,other_tanidiff1,other_tanidiff2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> results[btk]</span>
<span id="cb37-5">    self_tanis_2,other_tanidiff1_2,other_tanidiff2_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> noconstant_results[btk]</span>
<span id="cb37-6">    plt.hist([other_tanidiff2,other_tanidiff2_2],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'with constant'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'no constant'</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-7">    plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-8">    plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"fp-fragfp comparison, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>btk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb37-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#yscale('log')</span></span>
<span id="cb37-10">    plt.xlim((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here we again have a clear signal: leaving the constant term out causes a larger similarity difference (the red histograms are shifted to the right).</p>
<p>I’m going to wrap this one up here. I think the approach clearly works, but there’s some more to do in a future blog post or two: - look at how well the constants generated on this set work on a completely different set of molecules. - look at fragmenting the molecule multiple times (i.e.&nbsp;combining more than 2 fragments to form a molecule) - look at an asymmetric similarity measure like Tversky. This is what we’d want to use if we were searching a large fragment space and incrementally building up the results molecules (like in the <a href="https://dx.doi.org/10.1023/A:1011144622059">FTrees-FS paper</a>).</p>


</section>

 ]]></description>
  <category>exploration</category>
  <category>similarity</category>
  <category>fingerprints</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-09-20-additive-fingerprints1.html</guid>
  <pubDate>Thu, 19 Sep 2024 22:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/additive-fingerprints-1.png" medium="image" type="image/png" height="111" width="144"/>
</item>
<item>
  <title>Conformer generation and intramolecular H-bonds</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-07-28-confgen-and-intramolecular-hbonds.html</link>
  <description><![CDATA[ 




<p>This <a href="https://github.com/rdkit/rdkit/discussions/7658">question</a> came up recently on the RDKit discussions group: If I know that a molecule has an intramolecular hydrogen bond, how can I make sure that the bond is present in conformers generated by the RDKit? I did a <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-02-22-etkdg-and-distance-constraints.html">longer post</a> about this a few years ago, but I will keep this one short.</p>
<p>Let’s start by looking at a molecule which can have an intra-molecular H bond, 3-hydroxypropanal, and see what the default behavior ETKDGv3 conformers are.</p>
<div id="4f1cb43b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:16.179489Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:15.863983Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-4">IPythonConsole.ipython_3d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDistGeom</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DistanceGeometry <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> DG</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.03.5</code></pre>
</div>
</div>
<p>Here’s malonaldehyde.</p>
<div id="49705d56" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:16.369153Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:16.345789Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">IPythonConsole.drawOptions.addAtomIndices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb3-2">IPythonConsole.molSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span>
<span id="cb3-3">mol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AddHs(Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'O=CCCO'</span>))</span>
<span id="cb3-4">mol</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-07-28-confgen-and-intramolecular-hbonds_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The O–H distance we care about here is that between O(0) and H(10).</p>
<p>Generate 20 conformers using the default ETKDGv3 parameters:</p>
<div id="0074cde3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:17.143452Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:17.120456Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.ETKDGv3()</span>
<span id="cb4-2">params.randomSeed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span></span>
<span id="cb4-3"></span>
<span id="cb4-4">rdDistGeom.EmbedMultipleConfs(mol,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,params)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>&lt;rdkit.rdBase._vecti at 0x7fbf1f40d0c0&gt;</code></pre>
</div>
</div>
<p>Looking at the first conformer we see that there is no intramolecular H bond.</p>
<div id="aad15387" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:17.713764Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:17.680775Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">mol</span></code></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17221779176843417" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17221779176843417" style="background-color:#ffcccc;color:black">You appear to be running in JupyterLab (or JavaScript failed to load for some other reason).  You need to install the 3dmol extension: <br>
        <tt>jupyter labextension install jupyterlab_3dmol</tt></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.0.4/3Dmol-min.js');
}

var viewer_17221779176843417 = null;
var warn = document.getElementById("3dmolwarning_17221779176843417");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17221779176843417 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17221779176843417"),{backgroundColor:"white"});
viewer_17221779176843417.zoomTo();
    viewer_17221779176843417.removeAllModels();
    viewer_17221779176843417.addModel("\n     RDKit          3D\n\n 11 10  0  0  0  0  0  0  0  0999 V2000\n    1.7907   -0.9896    1.0859 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.3205   -0.4350    0.1082 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.3214    0.6623    0.0297 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.0985    0.1742    0.2011 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4762   -0.7399   -0.7511 O   0  0  0  0  0  0  0  0  0  0  0  0\n    1.7246   -0.8374   -0.8381 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.5368    1.4005    0.8417 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4772    1.2128   -0.9204 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7500    1.0587    0.2595 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.1181   -0.3215    1.1963 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7284   -1.1852   -1.2127 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  2  3  1  0\n  3  4  1  0\n  4  5  1  0\n  2  6  1  0\n  3  7  1  0\n  3  8  1  0\n  4  9  1  0\n  4 10  1  0\n  5 11  1  0\nM  END\n","sdf");
    viewer_17221779176843417.setStyle({"stick": {}});
    viewer_17221779176843417.setBackgroundColor("0xeeeeee");
    viewer_17221779176843417.zoomTo();
viewer_17221779176843417.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">

</div>
</div>
<p>We can browse all of the conformers (<a href="https://rdkit.blogspot.com/2016/07/using-ipywidgets-and-py3dmol-to-browse.html">here’s an old blog post about that</a>) and see that none of them have a geometry consistent with an H bond:</p>
<div id="eb3d9c53" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:18.937689Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:18.895495Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> py3Dmol</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ipywidgets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> interact, interactive, fixed</span>
<span id="cb7-3"></span>
<span id="cb7-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> drawit(m,p,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb7-5">    p.removeAllModels()</span>
<span id="cb7-6">    IPythonConsole.addMolToView(m,p,confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>confId)</span>
<span id="cb7-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> p.show()</span>
<span id="cb7-8"></span>
<span id="cb7-9">p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> py3Dmol.view(width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb7-10">interact(drawit, m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fixed(mol),p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fixed(p),confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,mol.GetNumConformers()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ff756eea9df84cc59ced377432987def","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>But the best way to get a sense of whether or not the H bond is present is just to look at the O(0)–H(10) distances:</p>
<div id="8e4fdda8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:26.821075Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:26.733824Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">dists1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(conf.GetAtomPosition(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>conf.GetAtomPosition(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)).Length() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> conf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mol.GetConformers()]</span>
<span id="cb8-2"></span>
<span id="cb8-3">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb8-4">plt.hist(dists1)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb8-5">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'O--H distance'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-07-28-confgen-and-intramolecular-hbonds_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Aside: the rest of this isn’t going to make much sense if you don’t have some familiarity with how the RDKit distance-geometry-based conformer generator works. The manual includes <a href="https://www.rdkit.org/docs/RDKit_Book.html#conformer-generation">an overview</a> along with pointers to the original literature.</p>
</blockquote>
<p>This behavior is not unexpected: the default behavior of the conformer generator is to set the minimal distance between two atoms equal to the sum of their van der Waals radii. We can see this by getting the distance-bounds matrix that the RDKit generates for the molecule and looking at the two entries for the O(0)-H(10) distance:</p>
<div id="81731721" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:27.888168Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:27.885327Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">bounds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdDistGeom.GetMoleculeBoundsMatrix(mol)</span>
<span id="cb9-2">bounds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],bounds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(2.3375, 5.599152703678865)</code></pre>
</div>
</div>
<p>Since the distance-bounds matrix determines which conformers can be generated, we can use it to force conformers that have a distance between O(0) and H(10) consistent with a strong intramolecular H bond.</p>
<p>We start by updating the lower and upper bounds for the distance:</p>
<div id="344a2c9c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:28.381473Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:28.375424Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">bounds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.6</span></span>
<span id="cb11-2">bounds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.8</span></span></code></pre></div>
</div>
<p>And now do triangle bounds smoothing in order to allow that change to propagate to the other distance bounds:</p>
<div id="fb9cf687" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:29.328259Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:29.325521Z&quot;}" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">DG.DoTriangleSmoothing(bounds)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>True</code></pre>
</div>
</div>
<p>The return value shows that the bound smoothing succeeded.</p>
<p>Now we can set that bounds matrix in the ETKDGv3 parameters object and re-generate conformers:</p>
<div id="844c8b03" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:30.507864Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:30.495833Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">params.SetBoundsMat(bounds)</span>
<span id="cb14-2">rdDistGeom.EmbedMultipleConfs(mol,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,params)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;rdkit.rdBase._vecti at 0x7fbe6fd21b40&gt;</code></pre>
</div>
</div>
<p>Look at the molecule’s conformers:</p>
<div id="4f785fc8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:31.773312Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:31.765955Z&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> py3Dmol.view(width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>,height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span>)</span>
<span id="cb16-2">interact(drawit, m<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fixed(mol),p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fixed(p),confId<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,mol.GetNumConformers()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"ccd4b68b6fa04b519efd20fdf442cd97","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
</div>
<p>The distance histogram shows that we’ve got an H bond in every conformer.</p>
<div id="e7cf1327" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:45:37.629902Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:45:37.549849Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">dists2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(conf.GetAtomPosition(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>conf.GetAtomPosition(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)).Length() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> conf <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mol.GetConformers()]</span>
<span id="cb17-2"></span>
<span id="cb17-3">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb17-4">plt.hist(dists2)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb17-5">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'O--H distance'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-07-28-confgen-and-intramolecular-hbonds_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here’s the before and after histogram:</p>
<div id="a8d7e210" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-07-28T14:47:31.782517Z&quot;,&quot;start_time&quot;:&quot;2024-07-28T14:47:31.646775Z&quot;}" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb18-2">plt.hist([dists1,dists2],label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'unconstrained'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'constrained'</span>],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb18-3">plt.legend()</span>
<span id="cb18-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'O--H distance'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-07-28-confgen-and-intramolecular-hbonds_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Manipulating the distance-bounds matrix provides a lot of flexibility in steering conformer generation into particular areas of the conformer space accessible to a molecule.</p>
<p>Here are a couple of examples: 1. <a href="https://github.com/rdkit/UGM_2016/blob/master/Notebooks/Stiefl_RDKitPh4FullPublication.ipynb">Using distance bounds to generate conformers matching a pharmacophore</a>. 2. <a href="https://pubs.acs.org/doi/full/10.1021/acs.jcim.1c01165">Incorporating experimental distance bounds from NOE measurements in conformer generation</a>.</p>



 ]]></description>
  <category>tutorial</category>
  <category>conformers</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-07-28-confgen-and-intramolecular-hbonds.html</guid>
  <pubDate>Sat, 27 Jul 2024 22:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/confgen-intramolecular-hbond-1.png" medium="image" type="image/png" height="123" width="144"/>
</item>
<item>
  <title>The problem(s) with scaffold splits, part 1</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1.html</link>
  <description><![CDATA[ 




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>An unfortunately popular strategy for validating machine-learning models is to do a “scaffold split” of the data. The idea is behind the scaffold split is to identify chemical series/scaffolds in the data set and to move all molecules sharing one or more scaffolds to the test set. The intent here is to see how well a model performs on regions of chemical space which are different from those it was trained on. Scaffold splitting is one of a variety of validation methods proposed to provide a more “realistic” assessment of model performance than random (or bootstrap) splits do. This seems, in principle, like a great idea, particularly for models intended for lead-finding or lead-optimization, where one typically has data for a number of scaffolds which, hopefully, are active (or inactive) for similar reasons. Scaffold splitting, with good scaffold definitions, can also be quite useful in identify systematic problems in global models, like those used for ADME or safety endpoints.</p>
<p>The problem with doing a realistic scaffold split is that the definition of “scaffold” is specific to the particular data set (or project). A 2020 paper by Franziska Kruger and a couple of former colleagues at Novartis looked at the challenges here and published a tool which provides suggestions for what the chemical series might be in a particular data set: https://doi.org/10.1021/acs.jcim.0c00204. As an aside, a followup paper by Maximilian Beckers and the same two former colleagues applied this series-finding approach to an interesting historical analysis of med-chem project data: https://doi.org/10.1021/acs.jcim.2c00785</p>
<p>Given that Franziska’s method is time-consuming and cannot be fully automated, the standard approach in the literature for doing a scaffold split is to use Bemis-Murcko scaffolds, commonly just called “Murcko scaffolds” (https://doi.org/10.1021/jm9602928). Briefly, the algorithm behind these scaffolds is to iteratively remove all degree-one atoms from a molecule, leaving the “central” set of rings and the atoms which connect them.</p>
<blockquote class="blockquote">
<p>Aside: The RDKit implementation of “Murcko scaffolds” uses a slight variation of the original algorithm. Degree-one atoms with double bonds to atoms in the scaffold are also preserved. The logic behind this variation is that these atoms have a very strong impact on the shape and properties of the scaffold, so they should be part of the scaffold.</p>
</blockquote>
<p>I think that doing a Murcko decomposition is a useful exercise for organizing a collection of molecules, particularly as part of either a scaffold network analysis or the type of scaffold-finding algorithm in Franziska’s paper, but that it is poorly suited for use in either actually identifying the type of scaffold that medicinal chemists use to organize and reason about their data or for splitting data sets for validating machine learning models.</p>
<p>This was turning into a mega-post, so I’m going to split it into two. In this first one I will look of the number of “Murcko scaffolds” found in medicinal chemistry papers. This is done by looking at the compounds tested in ChEMBL33 Ki assays with between 20 and 100 unique compounds which came from a document with a DOI. I’d expect a typical med chem assay (these come from a single paper) to have compounds for a small number of chemical series along with a few reference compounds from the literature. And then in a second post, coming later, I will do an analysis of the similarity characteristics of leave-scaffold-out splits for a random selection of the Ki assays mentioned above using the modified spatial statistics we used in the SIMPD paper (https://doi.org/10.1186/s13321-023-00787-9).</p>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">TL;DR</h2>
<p>Looking across 7148 Ki assays, the median number of scaffolds per assay is 12. The median ratio of the number of scaffolds to the number of compounds in an assay is 0.4; the number of scaffolds is 40% of the number of compounds tested in an assay (= the compounds from a single med chem paper). This doesn’t match my expectations at all, nor does it match what is actually observed in the five random papers I selected to spot check.</p>
<blockquote class="blockquote">
<p>Final Note: The analysis in this post is focused on the type of data sets that commonly show up during lead finding or lead optimization. A Murcko scaffold analysis likely to be less wrong when partitioning datasets of diverse compounds that don’t contain SAR series. Of course, in these cases a standard neighbor split works just as well.</p>
</blockquote>
<div id="ac78811d" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T08:44:09.599524Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T08:44:09.595151Z&quot;}" data-execution_count="23">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdFMCS</span>
<span id="cb1-7">Draw.SetComicMode(IPythonConsole.drawOptions)</span>
<span id="cb1-8"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>load_ext sql</span>
<span id="cb1-9"></span>
<span id="cb1-10"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-12">plt.style.use(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tableau-colorblind10'</span>)</span>
<span id="cb1-13">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.size'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'16'</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The sql extension is already loaded. To reload it, use:
  %reload_ext sql</code></pre>
</div>
</div>
</section>
</section>
<section id="grabbing-the-data-from-chembl" class="level1">
<h1>Grabbing the data from ChEMBL</h1>
<p>We pull all the compounds for each of the Ki assays in ChEMBL33 that are taken from a document with a DOI and a publication year. Then we keep the assays containing between 20 and 100 compounds - the idea of the upper limit here is to try and limit ourselves to the primary literature,</p>
<div id="f6cd42bd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-04-20T04:16:46.214901Z&quot;,&quot;start_time&quot;:&quot;2024-04-20T04:16:43.237443Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-2">  drop table <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> exists assay_counts</span>
<span id="cb3-3">    </span>
<span id="cb3-4"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-5">  select assays.chembl_id,assay_id,count(distinct molregno) cnt into temporary table assay_counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">      <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> assays join activities using (assay_id) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">                  join docs on (assays.doc_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> docs.doc_id) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">      where standard_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ki'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-9">      assays.doc_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> null <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> doi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> null <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> year <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> null<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-10">      group by (assays.chembl_id,assay_id)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-11"></span>
<span id="cb3-12">aids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">    select <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> assay_counts where cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> cnt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb3-14"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(aids)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done.
53801 rows affected.
7148 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>7148</code></pre>
</div>
</div>
<p>We now have a list with assay ChEMBL ID, assay ID (a primary key used in the database), and the number of compounds with data in the assay:</p>
<div id="ff6c8fab" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T05:55:29.542942Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T05:55:29.540228Z&quot;}" data-execution_count="48">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">aids[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>[('CHEMBL857972', 157, 66),
 ('CHEMBL615643', 393, 24),
 ('CHEMBL615557', 535, 71),
 ('CHEMBL615558', 536, 30)]</code></pre>
</div>
</div>
<p>Randomly reorder the assays:</p>
<div id="3c5faa29" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T05:55:38.641883Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T05:55:38.636297Z&quot;}" data-execution_count="49">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb8-2">random.seed(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xC0FFEE</span>)</span>
<span id="cb8-3">random.shuffle(aids)</span>
<span id="cb8-4">aids[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>[('CHEMBL1176478', 642589, 29),
 ('CHEMBL902340', 453190, 32),
 ('CHEMBL3877023', 1634231, 21),
 ('CHEMBL1959874', 807746, 36)]</code></pre>
</div>
</div>
</section>
<section id="looking-at-some-of-example-results" class="level1">
<h1>Looking at some of example results</h1>
<div id="a78072c3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:13:12.476522Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:13:12.470018Z&quot;}" data-execution_count="61">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CHEMBL1803423'</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this was the first hit from ChEMBL 32</span></span>
<span id="cb10-2">aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> aids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb10-3">structs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-4">  select distinct on (canonical_smiles) cids.chembl_id compound_chembl_id,canonical_smiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-5">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> activities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-6">        join assays using (assay_id) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-7">        join compound_structures using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-8">        join chembl_id_lookup cids on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-9">    where assays.chembl_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb10-10">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> standard_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ki'</span></span>
<span id="cb10-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(structs)</span>
<span id="cb10-12">    </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>29 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>29</code></pre>
</div>
</div>
<p>Here are the compounds from that assay:</p>
<div id="22025413" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:06:15.354701Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:06:15.325187Z&quot;}" data-execution_count="57">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">nms,smis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>structs)</span>
<span id="cb13-2">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> smis]</span>
<span id="cb13-3">Draw.MolsToGridImage(mols[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>nms,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-7-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Generate the Murcko scaffolds:</p>
<div id="074767d2" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:06:17.068323Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:06:17.031225Z&quot;}" data-execution_count="58">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">scaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb14-3">    scaff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MurckoDecompose(m)</span>
<span id="cb14-4">    Chem.SanitizeMol(scaff)</span>
<span id="cb14-5">    scaffs.append(scaff)</span>
<span id="cb14-6">scaff_smis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolToSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> scaffs]</span>
<span id="cb14-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(scaff_smis))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>12</code></pre>
</div>
</div>
<p>There are twelve unique “scaffolds”. Draw the first six of them:</p>
<div id="972749be" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:06:18.282630Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:06:18.260959Z&quot;}" data-execution_count="59">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">unique_scaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(smi) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> smi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(scaff_smis)]</span>
<span id="cb16-2">Draw.MolsToGridImage(unique_scaffs[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>],subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Some of these are quite similar to each other and others, like the first and last in the second row, are clearly structurally related - the last entry in the second row is a substructure of the first entry in that row.</p>
<p>Look at the compounds from another assay:</p>
<div id="3483bd3e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:13:25.501136Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:13:25.469349Z&quot;}" data-execution_count="62">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> aids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb17-2">structs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-3">  select distinct on (canonical_smiles) cids.chembl_id compound_chembl_id,canonical_smiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-4">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> activities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-5">        join assays using (assay_id) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-6">        join compound_structures using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-7">        join chembl_id_lookup cids on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-8">    where assays.chembl_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb17-9">      <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> standard_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ki'</span></span>
<span id="cb17-10"></span>
<span id="cb17-11">nms,smis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>structs)</span>
<span id="cb17-12">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> smis]</span>
<span id="cb17-13">Draw.MolsToGridImage(mols[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>],legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>nms,subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>32 rows affected.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-10-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And generate the scaffolds:</p>
<div id="4d2441e4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:13:53.674681Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:13:53.608917Z&quot;}" data-execution_count="63">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">scaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb19-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb19-3">    scaff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MurckoDecompose(m)</span>
<span id="cb19-4">    Chem.SanitizeMol(scaff)</span>
<span id="cb19-5">    scaffs.append(scaff)</span>
<span id="cb19-6">scaff_smis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolToSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> scaffs]</span>
<span id="cb19-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(scaff_smis)))</span>
<span id="cb19-8">unique_scaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(smi) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> smi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(scaff_smis)]</span>
<span id="cb19-9">Draw.MolsToGridImage(unique_scaffs[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>],subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="63">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This time there are 20 scaffolds and some of them are QUITE similar to each other.</p>
</section>
<section id="number-of-scaffolds-per-assay" class="level1">
<h1>Number of scaffolds per assay</h1>
<p>Do the compound extraction and scaffold calculation for all of the assays:</p>
<div id="d40066cc" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:38:02.463123Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:35:59.902309Z&quot;}" data-scrolled="true" data-execution_count="69">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>config SqlMagic.feedback <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb21-2"></span>
<span id="cb21-3">accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb21-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aid,_,_ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> aids:</span>
<span id="cb21-5">    structs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-6">      select distinct on (canonical_smiles) cids.chembl_id compound_chembl_id,canonical_smiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-7">        <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> activities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-8">            join assays using (assay_id) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-9">            join compound_structures using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-10">            join chembl_id_lookup cids on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-11">        where assays.chembl_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-12">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> standard_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ki'</span></span>
<span id="cb21-13"></span>
<span id="cb21-14">    nms,smis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>structs)</span>
<span id="cb21-15">    mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> smis]</span>
<span id="cb21-16">    scaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="cb21-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb21-18">        scaff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MurckoDecompose(m)</span>
<span id="cb21-19">        Chem.SanitizeMol(scaff)</span>
<span id="cb21-20">        scaffs.add(Chem.MolToSmiles(scaff))</span>
<span id="cb21-21">    accum.append((aid,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(mols),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(scaffs)))</span>
<span id="cb21-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(accum)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>:</span>
<span id="cb21-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Done </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(accum)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> of </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(aids)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Done 100 of 7148
Done 200 of 7148
Done 300 of 7148
Done 400 of 7148
Done 500 of 7148
Done 600 of 7148
Done 700 of 7148
Done 800 of 7148
Done 900 of 7148
Done 1000 of 7148
Done 1100 of 7148
Done 1200 of 7148
Done 1300 of 7148
Done 1400 of 7148
Done 1500 of 7148
Done 1600 of 7148
Done 1700 of 7148
Done 1800 of 7148
Done 1900 of 7148
Done 2000 of 7148
Done 2100 of 7148
Done 2200 of 7148
Done 2300 of 7148
Done 2400 of 7148
Done 2500 of 7148
Done 2600 of 7148
Done 2700 of 7148
Done 2800 of 7148
Done 2900 of 7148
Done 3000 of 7148
Done 3100 of 7148
Done 3200 of 7148
Done 3300 of 7148
Done 3400 of 7148
Done 3500 of 7148
Done 3600 of 7148
Done 3700 of 7148
Done 3800 of 7148
Done 3900 of 7148
Done 4000 of 7148
Done 4100 of 7148
Done 4200 of 7148
Done 4300 of 7148
Done 4400 of 7148
Done 4500 of 7148
Done 4600 of 7148
Done 4700 of 7148
Done 4800 of 7148
Done 4900 of 7148
Done 5000 of 7148
Done 5100 of 7148
Done 5200 of 7148
Done 5300 of 7148
Done 5400 of 7148
Done 5500 of 7148
Done 5600 of 7148
Done 5700 of 7148
Done 5800 of 7148
Done 5900 of 7148
Done 6000 of 7148
Done 6100 of 7148
Done 6200 of 7148
Done 6300 of 7148
Done 6400 of 7148
Done 6500 of 7148
Done 6600 of 7148
Done 6700 of 7148
Done 6800 of 7148
Done 6900 of 7148
Done 7000 of 7148
Done 7100 of 7148</code></pre>
</div>
</div>
<div id="17106f25" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-03-10T06:38:02.469222Z&quot;,&quot;start_time&quot;:&quot;2024-03-10T06:38:02.464415Z&quot;}" data-execution_count="70">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb23-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./results/murcko_scaffs.pkl'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wb+'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outf:</span>
<span id="cb23-3">    pickle.dump(accum,outf)</span></code></pre></div>
</div>
<div id="1ccf47b0" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:19:08.749247Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:19:08.673610Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb24-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./results/murcko_scaffs.pkl'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> inf:</span>
<span id="cb24-3">    accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(inf)</span></code></pre></div>
</div>
<p>How many scaffolds are there in each assay?</p>
<div id="33b7f130" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:20:57.765887Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:20:57.664715Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb25-2">nscaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> accum]</span>
<span id="cb25-3">plt.hist(nscaffs,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb25-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num scaffolds'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Stats of that:</p>
<div id="ed6b0bf3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:21:56.019931Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:21:56.016973Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'mean: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(nscaffs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, median: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(nscaffs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mean: 13.2, median: 12.0</code></pre>
</div>
</div>
<p>That’s a lot of scaffolds for each assay.</p>
<p>Since each assay contains a different number of compounds, it’s interesting to look at the relationship between the number of compounds and the number of scaffolds:</p>
<div id="733800f6" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:23:10.864843Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:23:10.729686Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb28-2">plt.scatter([x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> accum],[x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> accum],alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb28-3">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num compounds'</span>)</span>
<span id="cb28-4">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'num scaffolds'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can summarize that with a histogram of the ratio of the number of scaffolds to the number of compounds:</p>
<div id="608eef5d" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:23:11.239584Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:23:11.077383Z&quot;}" data-execution_count="13">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">frac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> accum]</span>
<span id="cb29-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb29-3">plt.hist(frac,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb29-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'$num_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{scaffolds}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> / num_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{compounds}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">$'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="78086d69" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:23:25.050185Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:23:25.046021Z&quot;}" data-execution_count="14">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'mean: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(frac)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, median: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(frac)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.1f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>mean: 0.4, median: 0.4</code></pre>
</div>
</div>
</section>
<section id="manually-extracted-scaffolds" class="level1">
<h1>Manually extracted scaffolds</h1>
<p>To see what’s going on in more detail, let’s look at a few randomly selected assays/papers:</p>
<div id="581d8d52" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T06:55:21.866570Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T06:55:21.859677Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb32-2">acp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> accum[:]</span>
<span id="cb32-3">random.seed(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb32-4">random.shuffle(acp)</span>
<span id="cb32-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,tpl <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(acp[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]):</span>
<span id="cb32-6">    assay,nc,ns <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tpl</span>
<span id="cb32-7">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'https://www.ebi.ac.uk/chembl/assay_report_card/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>assay<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ns<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">   </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>https://www.ebi.ac.uk/chembl/assay_report_card/CHEMBL4049094/  13   34
https://www.ebi.ac.uk/chembl/assay_report_card/CHEMBL859243/  10   39
https://www.ebi.ac.uk/chembl/assay_report_card/CHEMBL4710796/  16   23
https://www.ebi.ac.uk/chembl/assay_report_card/CHEMBL3131699/  21   28
https://www.ebi.ac.uk/chembl/assay_report_card/CHEMBL4183750/  9   25</code></pre>
</div>
</div>
<p>Get the compounds for each assay from the database:</p>
<div id="e3d2eee1" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T08:41:00.885036Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T08:40:59.418519Z&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>config SqlMagic.feedback <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb34-2"></span>
<span id="cb34-3">cmpd_accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb34-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aid,_,_ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> acp[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]:</span>
<span id="cb34-5">    structs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>sql postgresql:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>glandrum<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>stoat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>chembl_33 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-6">      select distinct on (canonical_smiles) cids.chembl_id compound_chembl_id,canonical_smiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-7">        <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> activities <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-8">            join assays using (assay_id) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-9">            join compound_structures using (molregno) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-10">            join chembl_id_lookup cids on (molregno<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>entity_id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> entity_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COMPOUND'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-11">        where assays.chembl_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>:aid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-12">          <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> standard_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ki'</span></span>
<span id="cb34-13"></span>
<span id="cb34-14">    nms,smis <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>structs)</span>
<span id="cb34-15">    mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> smis]</span>
<span id="cb34-16">    cmpd_accum[aid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mols</span></code></pre></div>
</div>
<div id="f017648c" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T08:44:30.245322Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T08:44:30.242882Z&quot;}" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb35-2">rdDepictor.SetPreferCoordGen(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>I went through each of the papers and came up with a scaffold based for each on what the authors of the paper report as the scaffold. If there was no reported scaffold or something which was less-than-useful, I constructed on myself:</p>
<div id="ec90df78" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T11:17:19.874772Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T11:17:19.834653Z&quot;}" data-execution_count="69">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">scaffolds_from_papers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb36-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CHEMBL4049094'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*n1ncc(n1)C(=O)NC(C*)C(=O)NC1(CC1)C#N'</span>,</span>
<span id="cb36-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CHEMBL859243'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*CC(N1CCCC1)C(=O)c1ccccc1'</span>,</span>
<span id="cb36-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CHEMBL4710796'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*c1n[nH]c(=S)n1N=C-*'</span>,</span>
<span id="cb36-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CHEMBL3131699'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC(C)(C)NC(=O)Nc1nc(Cl)c(*)n(C1=O)CC(=O)Nc1ccccc1C(=O)NS(=O)(=O)*'</span>,</span>
<span id="cb36-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CHEMBL4183750'</span>:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*C(=O)c1ccc(cc1)c1c(OC)ccc(c1)C1=NN(*)C(=O)C2C1CC=CC2'</span></span>
<span id="cb36-7">}</span>
<span id="cb36-8">ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryParameters.NoAdjustments()</span>
<span id="cb36-9">ps.makeDummiesQueries <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb36-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> scaffolds_from_papers:</span>
<span id="cb36-11">    scaffolds_from_papers[k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.AdjustQueryProperties(Chem.MolFromSmiles(scaffolds_from_papers[k]),ps)</span>
<span id="cb36-12">    </span>
<span id="cb36-13">Draw.MolsToGridImage(scaffolds_from_papers.values(),</span>
<span id="cb36-14">                     legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(scaffolds_from_papers.keys()),</span>
<span id="cb36-15">                     subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Confirm that these single scaffolds actually cover a reasonable number of the compounds in the paper:</p>
<div id="ba5ef4dd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T11:17:20.272973Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T11:17:20.265701Z&quot;}" data-execution_count="70">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> scaffolds_from_papers:</span>
<span id="cb37-2">    nMatches <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cmpd_accum[k] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x.HasSubstructMatch(scaffolds_from_papers[k])])</span>
<span id="cb37-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'assay </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">:  num compounds=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(cmpd_accum[k])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> num matching scaffold=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>nMatches<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>assay CHEMBL4049094:  num compounds=34 num matching scaffold=34
assay CHEMBL859243:  num compounds=39 num matching scaffold=31
assay CHEMBL4710796:  num compounds=23 num matching scaffold=22
assay CHEMBL3131699:  num compounds=28 num matching scaffold=22
assay CHEMBL4183750:  num compounds=25 num matching scaffold=21</code></pre>
</div>
</div>
<p>Notice that in each case these individual scaffolds cover most of the compounds in the assay. This is a large contrast to the results from the Murcko decomposition, where even the most populous scaffolds typically cover less than half the compounds in the assay (see below).</p>
<p>And, finally, let’s just look at those scaffolds together with the most populated Murcko scaffolds from each paper:</p>
<div id="48e19d55" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-31T11:16:49.981899Z&quot;,&quot;start_time&quot;:&quot;2024-05-31T11:16:49.822127Z&quot;}" data-execution_count="66">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Counter</span>
<span id="cb39-2">rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb39-3">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb39-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> scaffolds_from_papers:</span>
<span id="cb39-5">    scaffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb39-6">    counts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Counter()</span>
<span id="cb39-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> m <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cmpd_accum[k]:</span>
<span id="cb39-8">        scaff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MurckoDecompose(m)</span>
<span id="cb39-9">        Chem.SanitizeMol(scaff)</span>
<span id="cb39-10">        smi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolToSmiles(scaff)</span>
<span id="cb39-11">        counts[smi] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb39-12">        scaffs[smi] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> scaff</span>
<span id="cb39-13">    row <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [scaffolds_from_papers[k]]</span>
<span id="cb39-14">    lrow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [k]</span>
<span id="cb39-15">    top <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> counts.most_common(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb39-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> smi,cnt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> top:</span>
<span id="cb39-17">        row.append(scaffs[smi])</span>
<span id="cb39-18">        lrow.append(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(cnt))</span>
<span id="cb39-19">    rows.extend(row)</span>
<span id="cb39-20">    labels.extend(lrow)</span>
<span id="cb39-21">Draw.MolsToGridImage(rows,</span>
<span id="cb39-22">                     legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels,</span>
<span id="cb39-23">                     molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb39-24">                     subImgSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Each row above has the hand-sketched scaffold in the first column and the three most common scaffolds along with their frequency in the remaining columns.</p>
<p>You can see that, with the exception of the second row (assay CHEMBL859243), the scaffolds found by the Murcko decomposition do not track particularly well with the scaffold extracted from the paper.</p>


</section>

 ]]></description>
  <category>machine learning</category>
  <category>rants</category>
  <category>reference</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-05-31-scaffold-splits-and-murcko-scaffolds1.html</guid>
  <pubDate>Thu, 30 May 2024 22:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/scaffold-splits-and-murcko-scaffolds-1.png" medium="image" type="image/png" height="126" width="144"/>
</item>
<item>
  <title>The impact of single-atom changes on similarity</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality.html</link>
  <description><![CDATA[ 




<section id="impact-of-single-atom-changes-on-similarity" class="level1">
<h1>Impact of single-atom changes on similarity</h1>
<p>Last week I got curious about the impact single atoms make on the similarity between two molecules. I was initially wondering whether small differences in the “core” of two molecules have a disproportionate influence on the similarity between them. This blog post came from me trying to answer that question.</p>
<p>Along the way I discovered that there’s more to this topic than I thought, so the blog post is longer than planned. It still feels like there’s some exploration to do, so I may still end up doing a follow up.</p>
<p>Here’s a summary of the analysis of the average Tanimoto similarity of a molecule to itself with a single atom changed to a dummy atom. The analysis was done across 5000 ChEMBL molecules.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>FP</th>
<th>mean(SD)</th>
<th>90%</th>
<th>95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>MFP3</td>
<td>0.68(0.12)</td>
<td>0.53</td>
<td>0.48</td>
</tr>
<tr class="even">
<td>MFP2</td>
<td>0.75(0.09)</td>
<td>0.63</td>
<td>0.59</td>
</tr>
<tr class="odd">
<td>MFP1</td>
<td>0.83(0.06)</td>
<td>0.75</td>
<td>0.72</td>
</tr>
<tr class="even">
<td>RDK7</td>
<td>0.76(0.15)</td>
<td>0.54</td>
<td>0.47</td>
</tr>
<tr class="odd">
<td>RDK5</td>
<td>0.74(0.14)</td>
<td>0.53</td>
<td>0.46</td>
</tr>
<tr class="even">
<td>TT</td>
<td>0.78(0.12)</td>
<td>0.61</td>
<td>0.55</td>
</tr>
<tr class="odd">
<td>AP</td>
<td>0.88(0.05)</td>
<td>0.83</td>
<td>0.81</td>
</tr>
</tbody>
</table>
<p>We can think about these values as thresholds for retrieving <em>extremely</em> similar molecules: using the RDK5 fingerprint (RDKit fingerprint with a path length of 5) we need to use a Tanimoto similarity threshold of 0.46 to be 95% certain of retrieving molecules that have the same connectivity and that only differ in the identity of a single atom.</p>
<p>As for my original question about centrality: it’s not how central an atom is that matters, but how many atoms are close to it. We can see this in the similarity map showing the contributions of individual atoms to the similarity of one of the test molecules to itself using the RDK5 fingerprint:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/733e9c17-1-image.png" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<div id="ee90d630" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:19.832919Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:19.359437Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdFingerprintGenerator</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.MolStandardize <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolStandardize</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DataStructs</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RDLogger</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-9"></span>
<span id="cb1-10"></span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-12">plt.style.use(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tableau-colorblind10'</span>)</span>
<span id="cb1-13">plt.rcParams[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'font.size'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'16'</span></span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>matplotlib inline</span>
<span id="cb1-16"></span>
<span id="cb1-17"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2024.03.2</code></pre>
</div>
</div>
<p>Let’s start with one of my favority example molecules, the bioactive part of esomeprazole:</p>
<div id="49345b2b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:20.255497Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:20.226958Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">IPythonConsole.molSize <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">450</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">350</span></span>
<span id="cb3-2">IPythonConsole.drawOptions.addAtomIndices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb3-3">esomeprazole <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'COc1ccc2[nH]c(nc2c1)[S@@+]([O-])Cc3ncc(C)c(OC)c3C'</span>)</span>
<span id="cb3-4">esomeprazole</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Define a function which changes each of the atoms to a dummy and then compares the similarity of that to the unperturbed molecule.</p>
<p>We track the similarity between the modified and original molecules together with the number of atoms within a target radius of the modified atom (this second piece of info will be used at the end of the blog post).</p>
<div id="176ba890" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:21.574107Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:21.562616Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> get_modified_sims(mol,maxRadius,fpFunc):</span>
<span id="cb4-2">    basefp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpFunc(mol)</span>
<span id="cb4-3">    dm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.GetDistanceMatrix(mol)</span>
<span id="cb4-4">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb4-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aidx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(mol.GetNumAtoms()):</span>
<span id="cb4-6">        nm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(mol)</span>
<span id="cb4-7">        nm.GetAtomWithIdx(aidx).SetAtomicNum(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-8">        count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(dm[aidx]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>maxRadius)</span>
<span id="cb4-9">        res.append((count,DataStructs.TanimotoSimilarity(basefp,fpFunc(nm))))</span>
<span id="cb4-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res</span></code></pre></div>
</div>
<p>Now run that for esomeprazole using Morgan fingerprints with three different radius values.</p>
<p>We do the analysis for both count-based and bit-based fingerprints</p>
<div id="d9993113" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:23.627485Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:23.612079Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict</span>
<span id="cb5-2">res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> : defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>))</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> radius <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb5-5">    fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb5-6">    res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][radius].extend(get_modified_sims(esomeprazole,radius,fpg.GetCountFingerprint))</span>
<span id="cb5-7">    res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][radius].extend(get_modified_sims(esomeprazole,radius,fpg.GetFingerprint))</span>
<span id="cb5-8">    </span></code></pre></div>
</div>
<p>At each radius value, there’s one entry in <code>res</code> for each atom in the molecule:</p>
<div id="4141df8a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:25.164927Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:25.158331Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(esomeprazole.GetNumAtoms(),<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>24 24</code></pre>
</div>
</div>
<p>Here are the values:</p>
<div id="ed5f60fe" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:26.247121Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:26.233803Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">res[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>[(5, 0.8260869565217391),
 (7, 0.7319587628865979),
 (9, 0.6470588235294118),
 (9, 0.68),
 (10, 0.6310679611650486),
 (10, 0.5849056603773585),
 (11, 0.6),
 (11, 0.5849056603773585),
 (11, 0.6),
 (11, 0.5700934579439252),
 (11, 0.6153846153846154),
 (11, 0.6),
 (7, 0.75),
 (12, 0.6153846153846154),
 (12, 0.6),
 (10, 0.6470588235294118),
 (9, 0.68),
 (10, 0.6633663366336634),
 (7, 0.7684210526315789),
 (11, 0.6470588235294118),
 (9, 0.7319587628865979),
 (5, 0.8260869565217391),
 (12, 0.6153846153846154),
 (8, 0.75)]</code></pre>
</div>
</div>
<p>Interpreting the above: - atom 0 of esomeprazole has 5 atoms (including itself) within radius 2. The count-based fingerprint calculated when setting atom 0 to be a dummy has a similarity of 0.826 to the unmodified fingerprint. - atom 22 (the second to last atom) has 12 atoms (including itself) within radius 2. The count-based fingerprint calculated when setting atom 22 to be a dummy has a similarity of 0.615 to the unmodified fingerprint.</p>
<p>Now let’s do that perturbation on a bunch of molecules and see what the statistics look like. We’ll use 5000 molecules from <a href="https://rdkit.blogspot.com/2019/10/a-new-lessel-and-briem-like-dataset.html">this older blog post</a></p>
<div id="cb17cbd1" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:33.675233Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:30.801772Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'../data/BLSets_actives.txt'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> inf:</span>
<span id="cb10-2">    d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> inf.readlines()]</span>
<span id="cb10-3">    d.pop(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># title line</span></span>
<span id="cb10-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb10-5">random.seed(<span class="bn" style="color: #AD0000;
background-color: null;
font-style: inherit;">0xf00d</span>)</span>
<span id="cb10-6">random.shuffle(d)</span>
<span id="cb10-7">d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> d[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>]</span>
<span id="cb10-8"></span>
<span id="cb10-9">RDLogger.DisableLog(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rdApp.info'</span>)</span>
<span id="cb10-10">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb10-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> smi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> d:</span>
<span id="cb10-12">    mol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(smi)</span>
<span id="cb10-13">    mols.append(mol)</span>
<span id="cb10-14">rdMolStandardize.ChargeParentInPlace(mols,numThreads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb10-15">    </span></code></pre></div>
</div>
<p>The first few molecules, just to get a sense of what we’re dealing with here.</p>
<div id="f5d99b00" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-11T03:16:33.774565Z&quot;,&quot;start_time&quot;:&quot;2024-05-11T03:16:33.689816Z&quot;}" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">IPythonConsole.drawOptions.addAtomIndices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb11-2">Draw.MolsToGridImage(mols[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>],molsPerRow<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Histogram of molecule sizes:</p>
<div id="bd1a4618" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-05T03:54:42.489762Z&quot;,&quot;start_time&quot;:&quot;2024-05-05T03:54:42.381684Z&quot;}" data-execution_count="74">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">nAts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.GetNumHeavyAtoms() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols]</span>
<span id="cb12-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb12-3">plt.hist(nAts,bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb12-4">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Num Heavy Atoms'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>There’s a reasonable amount of computation to be done here, so we’ll use ipyparallel</p>
<div id="c2cc30cd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-04T08:14:28.580384Z&quot;,&quot;start_time&quot;:&quot;2024-05-04T08:14:28.486251Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb13-2">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ipyparallel <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ipp</span>
<span id="cb13-3">    rc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ipp.Client()</span>
<span id="cb13-4">    dview <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rc[:]</span>
<span id="cb13-5">    dview.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from rdkit import Chem'</span>)</span>
<span id="cb13-6">    dview.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from rdkit.Chem import rdFingerprintGenerator'</span>)</span>
<span id="cb13-7">    dview.execute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'from rdkit import DataStructs'</span>)</span>
<span id="cb13-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span>:</span>
<span id="cb13-9">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"could not use ipyparallel"</span>)</span>
<span id="cb13-10">    dview <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span></code></pre></div>
</div>
<div id="f226ad15" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-04T08:14:28.964188Z&quot;,&quot;start_time&quot;:&quot;2024-05-04T08:14:28.950756Z&quot;}" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> get_modified_sims2(mol,maxRadius,fpgFunc,method):</span>
<span id="cb14-2">    fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpgFunc()</span>
<span id="cb14-3">    fpFunc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">getattr</span>(fpg,method)</span>
<span id="cb14-4">    basefp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpFunc(mol)</span>
<span id="cb14-5">    dm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.GetDistanceMatrix(mol)</span>
<span id="cb14-6">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb14-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aidx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(mol.GetNumAtoms()):</span>
<span id="cb14-8">        nm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(mol)</span>
<span id="cb14-9">        nm.GetAtomWithIdx(aidx).SetAtomicNum(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb14-10">        count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(dm[aidx]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span>maxRadius)</span>
<span id="cb14-11">        res.append((count,DataStructs.TanimotoSimilarity(basefp,fpFunc(nm))))</span>
<span id="cb14-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res</span></code></pre></div>
</div>
<p>Run Morgan fingerprints with radius 1, 2, and 3.</p>
<div id="8fe3adbd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-04T09:21:51.848837Z&quot;,&quot;start_time&quot;:&quot;2024-05-04T09:21:24.808786Z&quot;}" data-execution_count="66">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> : defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>))</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> radius <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb15-4">    fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius:rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>r,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb15-5">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb15-6">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetCountFingerprint'</span>),mols)</span>
<span id="cb15-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb15-8">        accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][radius].extend(entry)</span>
<span id="cb15-9">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb15-10">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetFingerprint'</span>),mols)</span>
<span id="cb15-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb15-12">        accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][radius].extend(entry)</span></code></pre></div>
</div>
<p>Run RDKit fingerprints with max path length 5, 6, and 7</p>
<div id="6419cb93" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-04T09:26:19.302386Z&quot;,&quot;start_time&quot;:&quot;2024-05-04T09:21:51.850115Z&quot;}" data-execution_count="67">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">rdkit_accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> : defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>))</span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> radius <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>):</span>
<span id="cb16-4">    fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius:rdFingerprintGenerator.GetRDKitFPGenerator(maxPath<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>r,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb16-5">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb16-6">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetCountFingerprint'</span>),mols)</span>
<span id="cb16-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb16-8">        rdkit_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][radius].extend(entry)</span>
<span id="cb16-9">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb16-10">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetFingerprint'</span>),mols)</span>
<span id="cb16-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb16-12">        rdkit_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][radius].extend(entry)</span></code></pre></div>
</div>
<p>Same analysis for topological torsions and atom pairs. For these the extra “radius” argument does not really mean anything</p>
<div id="988e5b0a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-04T09:26:34.666338Z&quot;,&quot;start_time&quot;:&quot;2024-05-04T09:26:20.402848Z&quot;}" data-execution_count="70">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">tt_accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> : defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>))</span>
<span id="cb17-2"></span>
<span id="cb17-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> radius <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,):</span>
<span id="cb17-4">    fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius:rdFingerprintGenerator.GetTopologicalTorsionGenerator(fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4096</span>)</span>
<span id="cb17-5">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb17-6">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetCountFingerprint'</span>),mols)</span>
<span id="cb17-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb17-8">        tt_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][radius].extend(entry)</span>
<span id="cb17-9">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb17-10">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetFingerprint'</span>),mols)</span>
<span id="cb17-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb17-12">        tt_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][radius].extend(entry)</span></code></pre></div>
</div>
<div id="a66325bd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-04T09:26:50.452013Z&quot;,&quot;start_time&quot;:&quot;2024-05-04T09:26:34.667378Z&quot;}" data-execution_count="71">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">ap_accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> : defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>))</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> radius <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,):</span>
<span id="cb18-4">    fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius:rdFingerprintGenerator.GetAtomPairGenerator(fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4096</span>)</span>
<span id="cb18-5">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb18-6">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetCountFingerprint'</span>),mols)</span>
<span id="cb18-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb18-8">        ap_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][radius].extend(entry)</span>
<span id="cb18-9">    lres <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dview.map_sync(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x,r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_modified_sims2,</span>
<span id="cb18-10">                          z<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>fpg:y(x,r,z,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GetFingerprint'</span>),mols)</span>
<span id="cb18-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> entry <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lres:</span>
<span id="cb18-12">        ap_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][radius].extend(entry)</span></code></pre></div>
</div>
<p>Save all of those results for later analysis</p>
<div id="3ff918ec" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-06T03:03:37.275742Z&quot;,&quot;start_time&quot;:&quot;2024-05-06T03:03:37.273663Z&quot;}" data-execution_count="125">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> copy</span>
<span id="cb19-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> to_dict(dd):</span>
<span id="cb19-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(dd,defaultdict):</span>
<span id="cb19-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> copy.deepcopy(dd)</span>
<span id="cb19-5">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb19-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k,v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dd.items():</span>
<span id="cb19-7">        res[k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> to_dict(v)</span>
<span id="cb19-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res</span></code></pre></div>
</div>
<div id="09ee8803" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-06T03:04:31.812936Z&quot;,&quot;start_time&quot;:&quot;2024-05-06T03:04:11.089538Z&quot;}" data-execution_count="126">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb20-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gzip</span>
<span id="cb20-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> gzip.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./results/fp_perturbation.pkl.gz'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wb+'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> outf:</span>
<span id="cb20-4">    pickle.dump((to_dict(accum),to_dict(rdkit_accum),to_dict(ap_accum),to_dict(tt_accum)),outf)</span></code></pre></div>
</div>
<div id="3e721302" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-12T03:32:20.510651Z&quot;,&quot;start_time&quot;:&quot;2024-05-12T03:32:20.056176Z&quot;}" data-execution_count="159">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>chmod gou<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>w .<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>results<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>fp_perturbation.pkl.gz</span></code></pre></div>
</div>
<p>Load the saved data:</p>
<div id="7bdd091b" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-12T03:32:07.796279Z&quot;,&quot;start_time&quot;:&quot;2024-05-12T03:32:06.880954Z&quot;}" data-execution_count="158">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict</span>
<span id="cb22-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb22-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> gzip</span>
<span id="cb22-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> gzip.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'./results/fp_perturbation.pkl.gz'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> inf:</span>
<span id="cb22-5">    accum,rdkit_accum,ap_accum,tt_accum <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(inf)</span></code></pre></div>
</div>
<p>Now let’s look at the Morgan and RDKit results:</p>
<div id="d42162f8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-06T03:05:05.412375Z&quot;,&quot;start_time&quot;:&quot;2024-05-06T03:05:04.709371Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">rs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb23-2">tacc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> accum</span>
<span id="cb23-3">titl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Morgan'</span></span>
<span id="cb23-4"></span>
<span id="cb23-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> which <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>):</span>
<span id="cb23-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'---- </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>which<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> ----'</span>)</span>
<span id="cb23-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs:</span>
<span id="cb23-8">        yps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tacc[which][rad]]</span>
<span id="cb23-9">        qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(yps,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>])</span>
<span id="cb23-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'  r=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> mean=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> stddev=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> median=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb23-11"></span>
<span id="cb23-12">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb23-13">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb23-14"></span>
<span id="cb23-15">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tacc[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][rad]] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],</span>
<span id="cb23-16">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'counts r=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb23-17">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb23-18">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb23-19">plt.title(titl)</span>
<span id="cb23-20">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb23-21">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb23-22">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tacc[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][rad]] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],</span>
<span id="cb23-23">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'bits r=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb23-24">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb23-25">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb23-26">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb23-27">plt.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---- counts ----
  r=3 mean=0.74 stddev=0.10 median=0.74 90%=0.61, 95%:0.56
  r=2 mean=0.80 stddev=0.08 median=0.80 90%=0.71, 95%:0.67
  r=1 mean=0.87 stddev=0.05 median=0.88 90%=0.82, 95%:0.80
---- bits ----
  r=3 mean=0.68 stddev=0.12 median=0.69 90%=0.53, 95%:0.48
  r=2 mean=0.75 stddev=0.09 median=0.76 90%=0.63, 95%:0.59
  r=1 mean=0.83 stddev=0.06 median=0.84 90%=0.75, 95%:0.72</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-21-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Observations here: - The perturbations have a larger effect when the radius is larger. This makes sense because more atoms “feel” the changed atom with a larger radius. - I’m surprised by how large the overall impact on similarity is for these single atom-changes. With bit-based radius 2 or 3 fingerprints (the most commonly used, I believe), the mean similarities are 0.75 or 0.68 and you have to go all the way down to a similarity level of 0.59 or 0.48 to get 95% of the molecules. Those values are 0.56 and 0.67 with count-based fingerprints.</p>
<div id="aac5e446" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-05T04:12:54.454272Z&quot;,&quot;start_time&quot;:&quot;2024-05-05T04:12:53.779011Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">rs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb25-2">tacc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdkit_accum</span>
<span id="cb25-3">titl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RDKit'</span></span>
<span id="cb25-4"></span>
<span id="cb25-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> which <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>):</span>
<span id="cb25-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'---- </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>which<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> ----'</span>)</span>
<span id="cb25-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs:</span>
<span id="cb25-8">        yps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tacc[which][rad]]</span>
<span id="cb25-9">        qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(yps,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>])</span>
<span id="cb25-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'  maxp=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> mean=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> stddev=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> median=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb25-11"></span>
<span id="cb25-12"></span>
<span id="cb25-13">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb25-14">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb25-15"></span>
<span id="cb25-16">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tacc[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][rad]] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],</span>
<span id="cb25-17">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'counts maxp=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-18">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb25-19">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-20">plt.title(titl)</span>
<span id="cb25-21">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb25-22">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb25-23">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tacc[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][rad]] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],</span>
<span id="cb25-24">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'bits maxp=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rs],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-25">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb25-26">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb25-27">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb25-28">plt.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---- counts ----
  maxp=7 mean=0.71 stddev=0.17 median=0.73 90%=0.47, 95%:0.40
  maxp=6 mean=0.72 stddev=0.16 median=0.75 90%=0.50, 95%:0.42
  maxp=5 mean=0.75 stddev=0.14 median=0.77 90%=0.55, 95%:0.48
---- bits ----
  maxp=7 mean=0.76 stddev=0.15 median=0.78 90%=0.54, 95%:0.47
  maxp=6 mean=0.74 stddev=0.15 median=0.76 90%=0.52, 95%:0.45
  maxp=5 mean=0.74 stddev=0.14 median=0.76 90%=0.53, 95%:0.46</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-22-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Observations: - In contrast to the Morgan fingerprints, the changes for the bit-based fingerprints are less than count-based. I assume that this has to do with collisions, the RDKit fingerprints <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-07-06-number-of-fp-bits-set.html">set way more bits</a> than the Morgan fingerprints and have <a href="https://greglandrum.github.io/rdkit-blog/posts/2023-01-23-colliding-bits-iii-expanded.html">many more collisions</a>. - The distributions here have much longer tails than the Morgan FPs did and are more asymmetric (this is inevitable with the longer tails).</p>
<p>Atom pairs and topological torsions;</p>
<div id="b8d86e97" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-05T04:09:00.232485Z&quot;,&quot;start_time&quot;:&quot;2024-05-05T04:08:59.726766Z&quot;}" data-execution_count="6">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb27-2">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb27-3"></span>
<span id="cb27-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> which <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>):</span>
<span id="cb27-5">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'---- </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>which<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> ----'</span>)</span>
<span id="cb27-6">    yps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tt_accum[which][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb27-7">    qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(yps,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>])</span>
<span id="cb27-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'  TT mean=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> stddev=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> median=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb27-9">    yps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ap_accum[which][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]</span>
<span id="cb27-10">    qs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.quantile(yps,[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>])</span>
<span id="cb27-11">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'  AP mean=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>mean(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> stddev=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>std(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> median=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>np<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>median(yps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 90%=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 95%:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>qs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb27-12"></span>
<span id="cb27-13"></span>
<span id="cb27-14">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tt_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]],[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ap_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]],</span>
<span id="cb27-15">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'TT counts'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'AP counts'</span>],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb27-16">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb27-17">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb27-18">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb27-19">plt.subplot(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb27-20">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tt_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]],[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ap_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bits'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]]],</span>
<span id="cb27-21">         label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'TT bits'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'AP bits'</span>],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb27-22">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb27-23">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb27-24">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb27-25">plt.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---- counts ----
  TT mean=0.78 stddev=0.12 median=0.79 90%=0.61, 95%:0.55
  AP mean=0.88 stddev=0.04 median=0.88 90%=0.83, 95%:0.81
---- bits ----
  TT mean=0.78 stddev=0.12 median=0.80 90%=0.61, 95%:0.55
  AP mean=0.88 stddev=0.05 median=0.89 90%=0.83, 95%:0.81</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-23-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Observations: - The AP fingerprints are substantially less sensitive to the single-atom perturbations than any of the fingerprints looked at here. - The differences between counts and bits here are so small because both the TT and AP fingerprints use <a href="https://greglandrum.github.io/rdkit-blog/posts/2021-07-06-simulating-counts.html">count simulation</a> by default (this is why I used 4096 bits here instead of the 2048 bits used for the other fingerprints)</p>
<section id="aside" class="level3">
<h3 class="anchored" data-anchor-id="aside">Aside</h3>
<p>Assuming no collisions, we can directly calculate the atom-pair similarity between a molecule and itself with a single atom perturbed.</p>
<p>The Tanimoto similarity between fingerprints A and B is calculated as:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5C%7CA%5C&amp;B%5C%7C%7D%7B%5C%7CA%5C%7C+%5C%7CB%5C%7C-%5C%7CA%5C&amp;B%5C%7C%7D"></p>
<p>The number of atom pair bits for a molecule is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BN%20(N-1)%7D%7B2%7D"></p>
<p>When we perturb one atom, this changes <img src="https://latex.codecogs.com/png.latex?N-1"> of those bits, so the number of bits in common between the perturbed and unperturbed fingerprints is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BN%20(N-1)%7D%7B2%7D%20-%20(N-1)"></p>
<p>After a bit of math, we find that the Tanimoto similarity between the perturbed and unperturbed molecules is:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B%5Cfrac%7BN%20(N-1)%7D%7B2%7D%20-%20(N-1)%7D%7B%5Cfrac%7BN%20(N-1)%7D%7B2%7D%20+%20(N-1)%7D"></p>
<p>Plot this to demonstrate:</p>
<div id="73a91889" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-05T05:11:46.336296Z&quot;,&quot;start_time&quot;:&quot;2024-05-05T05:11:46.174449Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">nAts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x.GetNumHeavyAtoms() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols]</span>
<span id="cb29-2">psims <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb29-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> nAts:</span>
<span id="cb29-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb29-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb29-6">    psims.extend([(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x)</span>
<span id="cb29-7"></span>
<span id="cb29-8">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb29-9">plt.hist([[y <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x,y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ap_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]],psims],label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'measured'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'computed'</span>],bins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-10">plt.xlim(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb29-11">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="visualizing-the-impact-of-single-atom-changes-on-similarity" class="level1">
<h1>Visualizing the impact of single-atom changes on similarity</h1>
<p>Using the RDKit’s <a href="https://doi.org/10.1186/1758-2946-5-43">similarity maps</a> we can directly visualize how much the single-atom changes affect similarity</p>
<div id="786f20bd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-12T03:45:07.741455Z&quot;,&quot;start_time&quot;:&quot;2024-05-12T03:45:07.736619Z&quot;}" data-execution_count="165">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SimilarityMaps</span>
<span id="cb30-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdDepictor</span>
<span id="cb30-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> PIL <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Image</span>
<span id="cb30-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BytesIO</span>
<span id="cb30-5"></span>
<span id="cb30-6"></span>
<span id="cb30-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_similarity_map(m,fpfunc,scale_vals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,fillIt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,sigma<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>,w<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>,h<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">300</span>):</span>
<span id="cb30-8">    basefp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpfunc(m)</span>
<span id="cb30-9">    diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb30-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> aidx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(m.GetNumAtoms()):</span>
<span id="cb30-11">        nm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.Mol(m)</span>
<span id="cb30-12">        nm.GetAtomWithIdx(aidx).SetAtomicNum(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb30-13">        nfp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fpfunc(nm)</span>
<span id="cb30-14">        sim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataStructs.TanimotoSimilarity(basefp,nfp)</span>
<span id="cb30-15">        diffs.append(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sim)</span>
<span id="cb30-16"></span>
<span id="cb30-17"></span>
<span id="cb30-18">    diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(diffs)</span>
<span id="cb30-19">    rng <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(diffs)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(diffs)</span>
<span id="cb30-20">    </span>
<span id="cb30-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># print out the max and min changes caused by a single atom</span></span>
<span id="cb30-22">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'  max diff=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>(diffs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> min diff=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(diffs)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb30-23">    </span>
<span id="cb30-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># optionally scale the values so that differences are more visible</span></span>
<span id="cb30-25">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> scale_vals:</span>
<span id="cb30-26">        diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(diffs))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>rng <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb30-27">        </span>
<span id="cb30-28">        </span>
<span id="cb30-29">    d2d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.MolDraw2DCairo(w,h)</span>
<span id="cb30-30">    d2d.drawOptions().useBWAtomPalette()</span>
<span id="cb30-31"></span>
<span id="cb30-32">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Draw.ContourParams()</span>
<span id="cb30-33">    ps.fillGrid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fillIt</span>
<span id="cb30-34">    ps.gridResolution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span></span>
<span id="cb30-35">    ps.extraGridPadding <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb30-36"></span>
<span id="cb30-37">    m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolDraw2D.PrepareMolForDrawing(m, addChiralHs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb30-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> m.GetNumConformers():</span>
<span id="cb30-39">      rdDepictor.Compute2DCoords(m)</span>
<span id="cb30-40">    sigmas <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sigma] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m.GetNumAtoms()</span>
<span id="cb30-41">    locs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb30-42">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(m.GetNumAtoms()):</span>
<span id="cb30-43">      p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m.GetConformer().GetAtomPosition(i)</span>
<span id="cb30-44">      locs.append(Geometry.Point2D(p.x, p.y))</span>
<span id="cb30-45"></span>
<span id="cb30-46">    Draw.ContourAndDrawGaussians(d2d, locs, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(diffs), sigmas, nContours<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, params<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ps)</span>
<span id="cb30-47">    d2d.drawOptions().clearBackground <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb30-48">    d2d.DrawMolecule(m)</span>
<span id="cb30-49">    </span>
<span id="cb30-50">    d2d.FinishDrawing()</span>
<span id="cb30-51"></span>
<span id="cb30-52">    sio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BytesIO(d2d.GetDrawingText())</span>
<span id="cb30-53">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> Image.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(sio)</span></code></pre></div>
</div>
<div id="38a6ea04" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-12T03:45:09.862031Z&quot;,&quot;start_time&quot;:&quot;2024-05-12T03:45:09.780987Z&quot;}" data-execution_count="166">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb31-2">draw_similarity_map(esomeprazole,fpg.GetCountFingerprint)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  max diff=0.19 min diff=0.12</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="166">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-26-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="818a6424" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-14T02:55:09.178706Z&quot;,&quot;start_time&quot;:&quot;2024-05-14T02:55:09.101493Z&quot;}" data-execution_count="173">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb33-2">draw_similarity_map(esomeprazole,fpg.GetCountFingerprint)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  max diff=0.43 min diff=0.17</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="173">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-27-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>What about the RDKit fingerprint?</p>
<div id="5d0e278e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-14T02:55:29.854622Z&quot;,&quot;start_time&quot;:&quot;2024-05-14T02:55:29.770436Z&quot;}" data-execution_count="174">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetRDKitFPGenerator(maxPath<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb35-2">draw_similarity_map(esomeprazole,fpg.GetCountFingerprint)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  max diff=0.50 min diff=0.06</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="174">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-28-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This makes it look like centrality is important - the changes are largest around the central S atom. That’s a bit misleading, as another molecule will show.</p>
<p>Let’s look at a molecule from the set that we’ve been working with.</p>
<p>Morgan fingerprint:</p>
<div id="f57740bd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-14T02:56:51.288717Z&quot;,&quot;start_time&quot;:&quot;2024-05-14T02:56:51.206462Z&quot;}" data-execution_count="181">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetMorganGenerator(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb37-2">draw_similarity_map(mols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>],fpg.GetFingerprint)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  max diff=0.47 min diff=0.21</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="181">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-29-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>And RDKit fingerprint:</p>
<div id="f1200351" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-14T02:56:04.921447Z&quot;,&quot;start_time&quot;:&quot;2024-05-14T02:56:04.832787Z&quot;}" data-execution_count="177">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">fpg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdFingerprintGenerator.GetRDKitFPGenerator(maxPath<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,fpSize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>)</span>
<span id="cb39-2">draw_similarity_map(mols[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>],fpg.GetFingerprint)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  max diff=0.60 min diff=0.08</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="177">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-30-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>With both fingerprints (but particularly the RDKit fingerprint), we can see that the perturbations are largest in the “topologically complex” parts of the molecule: areas with a lot of branching.</p>
</section>
<section id="looking-at-delta_similarity-as-a-function-of-the-number-of-atoms-in-the-neighborhood" class="level1">
<h1>Looking at <img src="https://latex.codecogs.com/png.latex?%5CDelta_%7Bsimilarity%7D"> as a function of the number of atoms in the neighborhood</h1>
<p>My original idea with this post was to look at how much of an impact “centrality” - how close an atom is to the middle of the molecule - has on similarity. I realized pretty quickly that the important factor for more “local” fingerprints is the number of atoms within the fingerprints “radius”, not necessarily where that atom is in the molecule.</p>
<p>So let’s look at that.</p>
<div id="10e532b3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-12T03:34:55.489790Z&quot;,&quot;start_time&quot;:&quot;2024-05-12T03:34:54.065387Z&quot;}" data-execution_count="163">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"></span>
<span id="cb41-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mpatches</span>
<span id="cb41-3">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb41-4"></span>
<span id="cb41-5">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb41-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb41-7">    d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb41-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> r,s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][rad]:</span>
<span id="cb41-9">        d[r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].append(s)</span>
<span id="cb41-10">    labels.append((mpatches.Patch(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'C</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'r=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>))</span>
<span id="cb41-11">    </span>
<span id="cb41-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># only keep cases where we have at least 10 examples</span></span>
<span id="cb41-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(d.keys()):</span>
<span id="cb41-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(d[k])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>:</span>
<span id="cb41-15">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">del</span> d[k]</span>
<span id="cb41-16">        ks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(d.keys())</span>
<span id="cb41-17"></span>
<span id="cb41-18">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.25</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ks]</span>
<span id="cb41-19">    plt.violinplot([d[k] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ks],ps,showmedians<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb41-20"></span>
<span id="cb41-21">    plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'number of atoms in radius'</span>)</span>
<span id="cb41-22">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb41-23">plt.legend(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>labels))</span>
<span id="cb41-24">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Morgan counts'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="b1d82d3a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-05-12T03:34:14.386818Z&quot;,&quot;start_time&quot;:&quot;2024-05-12T03:34:13.904502Z&quot;}" data-execution_count="162">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mpatches</span>
<span id="cb42-2">plt.figure(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>))</span>
<span id="cb42-3"></span>
<span id="cb42-4">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb42-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,rad <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,)):</span>
<span id="cb42-6">    d <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb42-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> r,s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rdkit_accum[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'counts'</span>][rad]:</span>
<span id="cb42-8">        d[r].append(s)</span>
<span id="cb42-9">    labels.append((mpatches.Patch(color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'C</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'maxp=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>rad<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>))</span>
<span id="cb42-10"></span>
<span id="cb42-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># only keep cases where we have at least 10 examples</span></span>
<span id="cb42-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(d.keys()):</span>
<span id="cb42-13">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(d[k])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>:</span>
<span id="cb42-14">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">del</span> d[k]</span>
<span id="cb42-15">    </span>
<span id="cb42-16">    ks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sorted</span>(d.keys())</span>
<span id="cb42-17">    ps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.25</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ks]</span>
<span id="cb42-18">    plt.violinplot([d[k] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ks],ps,showmedians<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb42-19"></span>
<span id="cb42-20">plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'number of atoms in radius'</span>)</span>
<span id="cb42-21">plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'similarity'</span>)</span>
<span id="cb42-22">plt.legend(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>labels),loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb42-23">plt.title(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RDKit counts'</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The similarity initially decreases before flattening out at around 20 atoms in the radius.</p>


</section>

 ]]></description>
  <category>fingerprints</category>
  <category>reference</category>
  <category>exploration</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-05-14-similarity-and-centrality.html</guid>
  <pubDate>Mon, 13 May 2024 22:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/similarity-and-centrality-1.png" medium="image" type="image/png" height="86" width="144"/>
</item>
<item>
  <title>A stub a day keeps the docstrings at bay</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-03-08-docstring-stubs.html</link>
  <description><![CDATA[ 




<p>This is a guest post by Paolo Tosco (GitHub: <span class="citation" data-cites="ptosco">@ptosco</span>), one of the RDKit core maintainers.</p>
<p>This blog post expands a bit on the topic I presented last year in Mainz during <a href="https://github.com/rdkit/UGM_2023/blob/main/Presentations/Tosco_A_stub_a_day_keeps_the_docstrings_at_bay.pdf">a lightning talk</a> at the 2023 RDKit UGM, <em>i.e.</em>, the generation of RDKit stubs and programmatic patching of existing Python docstrings.</p>
<section id="tldr" class="level2">
<h2 class="anchored" data-anchor-id="tldr">TL;DR</h2>
<p>Starting with the 2023.09.6 release of the RDKit, the visibility and usability of the Python API documentation in VS Code is vastly improved. You now get things like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-13.png" class="img-fluid figure-img"></p>
<figcaption>FullyFunctionalHintsVSCode</figcaption>
</figure>
</div>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>I have been annoyed for a while by the fact that, when writing RDKit Python scripts in <a href="https://code.visualstudio.com/">Visual Studio Code</a> (I will it call VS Code from now on for simplicity), the familiar and helpful IntelliSense hints suggesting function or method names were either limited to a handful of functions or were not popping up at all.</p>
<p>For example, the <code>rdkit.Chem</code> module features a range of <code>MolFrom...</code> and <code>MolTo...</code> functions to generate an RDKit molecule from several formats and export an RDKit molecule to various formats, respectively.</p>
<p>However, when typing <code>mol = Chem.Mol</code> in VS Code, only InChI-related functions and <code>FindMolChiralCenters</code> were listed in the drop-down pop up:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-1.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeFewFunctions</figcaption>
</figure>
</div>
<p>Even after manually typing <code>Chem.MolFromSmiles</code>, VS Code would still not show any tooltip with the function docstring:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-2.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeNoDocString</figcaption>
</figure>
</div>
<p>Things were working much better in Jupyter Lab, as the drop-down was being populated with the expected methods while typing:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-3.png" class="img-fluid figure-img"></p>
<figcaption>JupyterLabWorksBetter</figcaption>
</figure>
</div>
<p>Also class methods seemed to work as expected:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-4.png" class="img-fluid figure-img"></p>
<figcaption>JupyterLabClassMethodsShowUp</figcaption>
</figure>
</div>
<p>However, something was still not quite right, as Jupyter Lab was not able to figure out the methods for the <code>Atom</code> instance returned by the <code>Mol.GetAtomWithIdx</code> method, and the dropdown was not showing any of the expected <code>Atom</code> methods:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-5.png" class="img-fluid figure-img"></p>
<figcaption>JupyterLabAtomMethodsMissing</figcaption>
</figure>
</div>
<p>At some point I was sufficiently annoyed by all of the above that I decided to invest a bit of time in figuring out why it was happening. I learnt that VS Code hints are powered by <a href="https://microsoft.github.io/pyright/#/">Pyright</a>, which in turn requires <a href="https://mypy.readthedocs.io/en/stable/stubs.html">stubs</a> to do its job, and RDKit does not have them. In the absence of stubs, the only available hints are those that can be obtained by introspection, which is the mechanism used by Jupyter Lab. In VS Code, introspection only works for functions defined in Python files, such as <code>FindMolChiralCenters</code> (<code>rdkit/Chem/__init__.py</code>) or InChI-related functions (<code>rdkit/Chem/inchi.py</code>). Since the large majority of RDKit functions and classes are defined in binary modules (<em>i.e.</em>, files bearing a <code>.so</code>, <code>.dylib</code> or <code>.pyd</code> extension, depending on the platform), now we know why most of the RDKit API is unknown to VS Code.</p>
<p>Stubs are Python files (though with a different extension, <code>.pyi</code>) containing class and free function definitions; docstrings associated to classes and functions are also included as triple-quoted comments. Function and method signatures are usually associated with parameter types and return types. Types are used by static type checkers such as <a href="https://mypy.readthedocs.io/en/stable/index.html"><code>mypy</code></a>, and by VS Code to figure out that the object returned by a function or class constructor is a class instance. Hovering on the object will show up the docstring associated to the class, and typing a dot after the object will trigger a pop up with all methods and properties available on that object. Once the user selects one of the available methods, VSCode will present a tooltip with the docstring associated to the method, as it had previously done with the class instance.<br></p>
<p>This works great for Python modules that come with stubs:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-6.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeReHints</figcaption>
</figure>
</div>
<p>Interestingly, Jupyter Lab seems to know that <code>re.compile</code> returns a <code>re.Pattern</code> instance, and presents us with the available methods, contrary to what happened with <code>Mol.GetAtomWithIdx</code>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-7.png" class="img-fluid figure-img"></p>
<figcaption>reCompileKnowsAboutPatternMethods</figcaption>
</figure>
</div>
<p>In summary, there seemed to be two different issues here:</p>
<ol type="1">
<li>The lack of stubs prevented hints from popping up in VS Code</li>
<li>Something else prevented correct introspection of the class method return type in jupyter Lab</li>
</ol>
</section>
<section id="generating-stubs-for-rdkit" class="level2">
<h2 class="anchored" data-anchor-id="generating-stubs-for-rdkit">Generating stubs for RDKit</h2>
<p><code>Mypy</code> comes with a tool for automatic stub generation, <a href="https://mypy.readthedocs.io/en/stable/stubgen.html"><code>stubgen</code></a>. Generating stubs for a Python package is super-simple:</p>
<pre><code>$ stubgen -p rdkit
$ ls out/rdkit
Avalon  Chem  DataManip  DataStructs  Dbase  DistanceGeometry  ForceField  Geometry  __init__.pyi  ML  Numerics  rdBase.pyi  RDConfig.pyi  RDLogger.pyi  RDPaths.pyi  RDRandom.pyi  SimDivFilters  sping  TestRunner.pyi  utils  VLib</code></pre>
<p>At first glance, <code>stubgen</code> seems to be able to process RDKIt’s binary extension modules and generate stubs. However, upon closer inspection, it proves unable to extract types, parameters and docstrings. Therefore, the generated stubs are <em>really</em> basic and not very useful, as they provide no hints about how to use the various functions and methods, nor any dosctrings:</p>
<pre><code>$ grep -A3 MolFromSmiles -r out/rdkit
out/rdkit/Chem/rdmolfiles.pyi:def MolFromSmiles(*args, **kwargs) -&gt; Any: ...
out/rdkit/Chem/rdmolfiles.pyi-def MolFromTPLBlock(boost) -&gt; Any: ...
out/rdkit/Chem/rdmolfiles.pyi-def MolFromTPLFile(*args, **kwargs) -&gt; Any: ...
out/rdkit/Chem/rdmolfiles.pyi-def MolFromXYZBlock(boost) -&gt; Any: ...</code></pre>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-8.png" class="img-fluid figure-img"></p>
<figcaption>stubgenStubsAreVeryBasic</figcaption>
</figure>
</div>
<p>Fortunately, there is another package, <a href="https://pypi.org/project/pybind11-stubgen/"><code>pybind11-stubgen</code></a>, which does a much better job with RDKit’s binary modules, and with a little bit of help can even figure out function parameters and types. I wrote a small Python module, <a href="https://github.com/rdkit/rdkit/tree/master/Scripts/gen_rdkit_stubs"><code>gen_rdkit_stubs</code></a>, which runs in parallel on multiple CPU cores and recursively generates stubs for the whole <code>rdkit</code> package in &lt; 10s:</p>
<pre><code>$ time ( python -m Scripts.gen_rdkit_stubs )

real    0m6.135s
user    1m51.786s
sys     0m27.283s</code></pre>
<p>VS Code were now looking as they were supposed to, with all functions and methods populated in the dropdown pop-up, plus type hints and docstrings in the right place:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-9.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeStubsGenRDKitStubs</figcaption>
</figure>
</div>
<p>Also the <code>Mol</code> methods were being suggested, and VS Code seemed aware of the fact that <code>Mol.GetAtomWithIdx</code> returns an <code>Atom</code> instance:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-10.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeChemMolMethodsPresent</figcaption>
</figure>
</div>
<p>However, the <code>Atom</code> methods were still not showing up, just as I had previously observed in Jupyter Lab:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-11.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeAtomMethodDoNotShowUp</figcaption>
</figure>
</div>
<p>A closer look at the stubs clarified that stubs were not quite correct yet: firstly, the <code>GetAtomWithIdx</code> method, as well as all of the <code>Mol</code> methods, were incorrectly decorated as <code>@staticmethod</code>; secondly, the <code>Atom</code> return type is not recognized, since the <code>Atom</code> object was not imported from <code>rdkit.Chem</code>, and hence is basically an unknown type:</p>
<pre><code>$ grep -B1 'def GetAtomWithIdx' -r pybind11-stubgen_rdkit-stubs/
pybind11-stubgen_rdkit-stubs/Chem/rdchem.pyi-    @staticmethod
pybind11-stubgen_rdkit-stubs/Chem/rdchem.pyi:    def GetAtomWithIdx(arg1: Mol, arg2: int) -&gt; Atom:</code></pre>
<p>Manually correcting the stub to the following:</p>
<pre><code>pybind11-stubgen_rdkit-stubs/Chem/rdchem.pyi-    #@staticmethod
pybind11-stubgen_rdkit-stubs/Chem/rdchem.pyi:    def GetAtomWithIdx(arg1: self, arg2: int) -&gt; rdkit.Chem.Atom:</code></pre>
<p>indeed led to the expected hints popping up:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-12.png" class="img-fluid figure-img"></p>
<figcaption>VSCodeManuallyCorrectedStub</figcaption>
</figure>
</div>
<p>In summary, there were three residual issues:</p>
<ol type="1">
<li>several hundreds of class method signatures in the C++ source code of RDKit Python wrappers were missing the <code>python::arg("self")</code> parameter, causing the corresponding methods to be incorrectly decorated as <code>@staticmethod</code></li>
<li><code>pybind11-stubgen</code> does not import objects used as return types; therefore, many return types are perceived as unknown by VS Code, and the associated class methods do not show up</li>
<li>functions and methods missing explicit <code>python::arg</code> parameters were attributed default parameter names such as <code>arg1</code>, <code>arg2</code>, …, <code>argN</code>, which make many signatures rather obscure compared to their C++ counterparts which have more meaningful parameter names</li>
</ol>
<p>It was immediately clear that manually patching the whole RDKit codebase to fix these 3 issues would be a daunting task. Therefore, I explored ways to accomplish the same task programmatically, and the <a href="https://libclang.readthedocs.io/en/latest/">Clang Indexing Library Bindings</a> emerged as the most appealing option.</p>
<p>The Clang Indexing Library can parse a C++ source file (including the headers that it references) and generate a tree-like structure which can be traversed to find the nodes of interest. Each of this nodes can in turn be related to a source code location (row and column numbers in the source file), making it possible to patch source code not just based on regular expressions, which would not be sufficient for our needs, but on some degree of actual “understanding” of the source code logic.</p>
<p>For this purpose, I wrote another Python module, <a href="https://github.com/rdkit/rdkit/tree/master/Scripts/patch_rdkit_docstrings"><code>patch_rdkit_docstrings</code></a>, which:</p>
<ol type="1">
<li>identifies source code files which relate to Python wrappers and need patching</li>
<li>generates AST files for each source code file</li>
<li>traverses AST files to find the places in the source code that need patching</li>
<li>adds the <code>self</code> parameter where needed to avoid that class methods are incorrectly decorated as <code>@staticmethod</code></li>
<li>replaces the <code>argN</code> parameter names in Python functions with more meaningful parameter names extracted from the C++ functions that the Python functions are wrapping</li>
<li>finally, runs <code>clang-format</code> on the patched sources to fix the formatting</li>
</ol>
<p>Also <code>patch_rdkit_docstrings</code> runs in parallel to speed up the patching, which takes a few minutes. Since docstring patching is a one-off operation, speed is not a critical factor; however, it definitely was during the development of the module. In fact, <code>patch_rdkit_docstrings</code> required several iterations to have the source code properly patched, and being able to quickly evaluate progress made between iterations was very helpful.</p>
<p>Once Greg and I were happy with the source code patching made by <code>patch_rdkit_docstrings</code>, as well as with the stubs generated out of the patched source code by <code>gen_rdkit_stubs</code>, I submitted a <a href="https://github.com/rdkit/rdkit/pull/6919/files">PR to RDKit with the programmatic source code patches made by <code>patch_rdkit_docstrings</code></a>.</p>
<p>The PR covered 91 files, with overall 4,076 lines of code being added and 1,088 being removed: definitely this was not a task that one would have liked to do manually: it would have probably required a comparable amount of time, some functions would have certainly being missed and some mistakes would have been made, and I would not have learnt anything about AST parsing and all the rest.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Since Release 2023.09.4, after building and installing in the usual way RDKit libraries and Python modules, stubs can be built and installed with the following command:</p>
<pre><code>cmake --build . --target stubs</code></pre>
<p>or, on Linux and macOS platforms, running</p>
<pre><code>make stubs</code></pre>
<p>The stubs enable fully functional hints in VS Code:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-13.png" class="img-fluid figure-img"></p>
<figcaption>FullyFunctionalHintsVSCode</figcaption>
</figure>
</div>
<p>As a bonus, thanks to the one-off source patching, also the Jupyter Lab issue described at the beginning is solved:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-14.png" class="img-fluid figure-img"></p>
<figcaption>JupyterLabAlsoWorks</figcaption>
</figure>
</div>
<p>Finally, also <a href="https://rdkit.org/docs/source/rdkit.Chem.rdchem.html#rdkit.Chem.rdchem.Mol.GetAtomWithIdx">the online RDKit documentation</a> looks prettier: <code>argN</code> parameters are replaced by meaningful parameter names taken from the respective C++ functions, while <code>self</code> parameters are now present in non-static methods:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-15.png" class="img-fluid figure-img"></p>
<figcaption>OnlineDocsLookBetter</figcaption>
</figure>
</div>
<p>Starting from Release 2023.09.6, <code>rdkit-stubs</code> are also available as part of <code>conda-forge</code> RDKit packages.</p>
<p>Happy coding with the new RDKit stubs!</p>


</section>

 ]]></description>
  <category>documentation</category>
  <category>release</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-03-08-docstring-stubs.html</guid>
  <pubDate>Thu, 07 Mar 2024 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/docstrings-stubs-13.png" medium="image" type="image/png" height="56" width="144"/>
</item>
<item>
  <title>Using custom standardization rules / Using the python logger from the RDKit</title>
  <link>https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging.html</link>
  <description><![CDATA[ 




<p>This post looks at two things:</p>
<ol type="1">
<li>Supplying your own parameters when normalizing molecules using the RDKit’s <code>MolStandardize</code></li>
<li>Capturing and parsig the RDKit’s C++ logs from within Python</li>
</ol>
<p>The RDKit’s <code>MolStandardize</code> module includes functionality for “normalizing” input molecules: applying a set of chemical transformations expressed as reactions to standardize the representation of particular functional groups or substructures of the input molecule. This kind of normalization is a common step in preparing molecules for a compound registration system. <code>MolStandardize</code> has a collection of default transformations adapted from Matt Swain’s <a href="https://molvs.readthedocs.io/en/latest/">MolVS</a> (<code>MolStandardize</code> itself started as a C++ port of MolVS) which cover standardizing a variety of common functional groups. The full list is in the <a href="https://github.com/rdkit/rdkit/blob/master/Code/GraphMol/MolStandardize/TransformCatalog/normalizations.in">RDKit source</a>.</p>
<p>Though we have tried to provide a broad and useful set of transformations, we know that they won’t fit everybody’s needs, so the <code>MolStandardize</code> allows the user to provide their own transformations. The first part of this post demonstrates how to do that.</p>
<p>The normalization funcationality in <code>MolStandarize</code> sends information about what transformations have been applied to the console using the RDKit’s logging functionality. This can be useful when working with small numbers of molecules in the shell or a notebook, and when debugging new transformations, but quickly becomes irritating when working with larger sets of molecules. In the second part of the post I’ll show how to disable this logging information as well as how to capture it and parse the logs to find out which transformations were applied to each molecule.</p>
<div id="a6ccbee4" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T04:54:00.013416Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T04:53:58.694409Z&quot;}" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Chem</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.MolStandardize <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdMolStandardize</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Draw</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit.Chem.Draw <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> IPythonConsole</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdkit</span>
<span id="cb1-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(rdkit.__version__)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2023.09.5</code></pre>
</div>
</div>
<section id="providing-your-own-normalization-transformations" class="level1">
<h1>Providing your own normalization transformations</h1>
<p>Let’s start with a simple molecule to demonstrate the default behavor of the normalization code.</p>
<p>The easiest way to apply the defaults to a molecule is to use the function <code>rdMolStandardize.Normalize()</code>:</p>
<div id="00fee046" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T04:54:00.107390Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T04:54:00.061640Z&quot;}" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[O-]c1[n+](C)cccc1'</span>)</span>
<span id="cb3-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolStandardize.Normalize(m)</span>
<span id="cb3-3">Draw.MolsToGridImage([m,m2])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:54:00] Initializing Normalizer
[05:54:00] Running Normalizer
[05:54:00] Rule applied: Recombine 1,3-separated charges</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging_files/figure-html/cell-3-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>An aside: as was mentioned in <a href="https://greglandrum.github.io/rdkit-blog/posts/2024-02-11-more-multithreading.html">another recent blog post</a>, it’s possible to call <code>NormalizeInPlace()</code> to modify the molecule in place instead of making a copy and working on it. This will be a bit faster and can be used with mulitiple threads when working with more than one molecule.</p>
<p>We can accomplish the same thing by creating a <code>Normalizer</code> object and using it to normalize the molecule:</p>
<div id="6978c1f3" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T04:54:01.777584Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T04:54:01.768867Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">nrm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolStandardize.Normalizer()</span>
<span id="cb5-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm.normalize(m)</span>
<span id="cb5-3">Draw.MolsToGridImage([m,m2])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:54:01] Initializing Normalizer
[05:54:01] Running Normalizer
[05:54:01] Rule applied: Recombine 1,3-separated charges</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging_files/figure-html/cell-4-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now let’s look at another molecule where the normalization doesn’t do anything:</p>
<div id="1c22d99a" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T04:54:02.873397Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T04:54:02.862326Z&quot;}" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC(C)(C)OC(=O)NCCC(=O)O[Na]'</span>)</span>
<span id="cb7-2">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm.normalize(m)</span>
<span id="cb7-3">Draw.MolsToGridImage([m,m2])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:54:02] Running Normalizer</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>As a demonstration, let’s construct a normalizer which will break the bond to the alkali metal and remove the Boc protecting group. This is, of course, an artificial example, but it shows how to provide new transformations to <code>MolStandardize</code></p>
<div id="d1e6c4dc" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T04:54:08.449768Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T04:54:08.440610Z&quot;}" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we provide the transformations in a string with one line per transformation.</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Lines starting with // are comments and are ignored. Each line contains the</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># name of the transformation, a tab character, and then the reaction SMARTS for</span></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># the transformation itself. It's also possible to skip the names; in that case</span></span>
<span id="cb9-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># just provide the reaction SMARTS (the tab is not needed)</span></span>
<span id="cb9-6">tfs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb9-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">// this is from Deprotect.cpp:</span></span>
<span id="cb9-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">remove_Boc</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[C;R0][C;R0]([C;R0])([O;R0][C;R0](=[O;R0])[NX3;H0,H1:1])C&gt;&gt;[N:1]</span></span>
<span id="cb9-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">// this should go last, because later transformations will</span></span>
<span id="cb9-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">// lose the alkali metal</span></span>
<span id="cb9-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">disconnect_alkali_metals</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[Li,Na,K,Rb:1]-[A:2]&gt;&gt;([*+:1].[*-:2])</span></span>
<span id="cb9-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb9-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create the new Normalizer:</span></span>
<span id="cb9-14">cps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolStandardize.CleanupParameters()</span>
<span id="cb9-15">nrm2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolStandardize.NormalizerFromData(tfs,cps)</span>
<span id="cb9-16"></span>
<span id="cb9-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># and apply it:</span></span>
<span id="cb9-18">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm2.normalize(m)</span>
<span id="cb9-19">Draw.MolsToGridImage([m,m2])</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[05:54:08] Initializing Normalizer
[05:54:08] Running Normalizer
[05:54:08] Rule applied: remove_Boc
[05:54:08] Rule applied: disconnect_alkali_metals</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging_files/figure-html/cell-6-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If you’re processing a lot of molecules, you probably don’t want those log messages filling your console or notebook. It’s possible to disable the logging:</p>
<div id="6caa1f97" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T04:55:18.810931Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T04:55:18.808343Z&quot;}" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RDLogger</span>
<span id="cb11-2">RDLogger.DisableLog(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rdApp.info'</span>)</span>
<span id="cb11-3">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm2.normalize(m)</span></code></pre></div>
</div>
</section>
<section id="connecting-the-rdkit-logs-to-the-python-logger" class="level1">
<h1>Connecting the RDKit logs to the Python logger</h1>
<p>It’s also possible to have the logging the RDKit’s C++ backend does sent to Python’s built-in logging facilities. This has been available since the 2022.03.1 release of the RDKit.</p>
<p>I won’t do a complete introduction to Python’s logging capabilities here (I’m not an expert!), but here’s a quick demonstration of what we might do:</p>
<div id="d06c5bd9" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:18:04.143889Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:18:04.141575Z&quot;}" data-execution_count="19">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb12-2"></span>
<span id="cb12-3">logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logging.getLogger(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rdkit'</span>)</span>
<span id="cb12-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set the log level for the default log handler (the one which sense output to the console/notebook):</span></span>
<span id="cb12-5">logger.handlers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].setLevel(logging.WARN)</span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># format the messages so that it's clear they come from the RDKit:</span></span>
<span id="cb12-7">logger.handlers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].setFormatter(logging.Formatter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'[RDKit] </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%(levelname)s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%(message)s</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>))</span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tell the RDKit's C++ backend to log to use the python logger:</span></span>
<span id="cb12-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdBase</span>
<span id="cb12-11">rdBase.LogToPythonLogger()</span></code></pre></div>
</div>
<p>Now do something which generates an error message:</p>
<div id="2a683682" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:18:05.440976Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:18:05.433570Z&quot;}" data-execution_count="20">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C1C'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[RDKit] ERROR:[06:18:05] SMILES Parse Error: unclosed ring for input: 'C1C'</code></pre>
</div>
</div>
<p>You can tell that this went through the Python logger because it has the prefix we set up above.</p>
<p>Since we’re only logging at the WARN (and above) level, the INFO messages from doing normalizations don’t appear:</p>
<div id="02b60d99" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:18:07.039594Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:18:07.037451Z&quot;}" data-execution_count="21">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm2.normalize(m)</span></code></pre></div>
</div>
<p>Let’s create an additional log message handler that catches INFO messages too but that saves them in a <code>StringIO</code> object instead of outputting them to the console:</p>
<div id="bb1924f7" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:20:43.872130Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:20:43.866249Z&quot;}" data-execution_count="38">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StringIO</span>
<span id="cb16-2"></span>
<span id="cb16-3">logger_sio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StringIO()</span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a handler that uses the StringIO and set its log level:</span></span>
<span id="cb16-5">handler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logging.StreamHandler(logger_sio)</span>
<span id="cb16-6">handler.setLevel(logging.INFO)</span>
<span id="cb16-7"></span>
<span id="cb16-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the handler to the Python logger:</span></span>
<span id="cb16-9">logger.addHandler(handler)</span>
<span id="cb16-10"></span>
<span id="cb16-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we also need to change the level of the main logger so that the INFO messages get sent to the handlers:</span></span>
<span id="cb16-12">logger.setLevel(logging.INFO)</span></code></pre></div>
</div>
<p>Now normalize a molecule:</p>
<div id="5de7716e" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:20:44.775548Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:20:44.353105Z&quot;}" data-execution_count="39">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm2.normalize(m)</span></code></pre></div>
</div>
<p>We don’t see anything in the notebook because the main handler (the one which goes to the console/notebook) is still set to only show WARN and above, but <code>logger_sio</code> has the message:</p>
<div id="777aeb44" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:20:44.900994Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:20:44.898027Z&quot;}" data-execution_count="40">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logger_sio.getvalue()</span>
<span id="cb18-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(text)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[06:20:44] Running Normalizer
[06:20:44] Rule applied: remove_Boc
[06:20:44] Rule applied: disconnect_alkali_metals
</code></pre>
</div>
</div>
<p>We can use a regular expression to extract the rules that were applied to the molecule from this output:</p>
<div id="62d1f102" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T05:20:45.801092Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T05:20:45.798300Z&quot;}" data-execution_count="41">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> re</span>
<span id="cb20-2">rules <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> re.findall(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'Rule applied: (.*?)\n'</span>,text)</span>
<span id="cb20-3">rules</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>['remove_Boc', 'disconnect_alkali_metals']</code></pre>
</div>
</div>
<p>If we now sanitize another molecule (or, in this case, the same one again), the log messages are appended to <code>logger_sio</code>:</p>
<div id="a4db1213" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T14:22:05.051809Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T14:22:05.048739Z&quot;}" data-execution_count="42">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm2.normalize(m)</span></code></pre></div>
</div>
<div id="5721e131" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T14:22:12.047720Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T14:22:12.040701Z&quot;}" data-execution_count="43">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logger_sio.getvalue()</span>
<span id="cb23-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(text)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[06:20:44] Running Normalizer
[06:20:44] Rule applied: remove_Boc
[06:20:44] Rule applied: disconnect_alkali_metals
[15:22:05] Running Normalizer
[15:22:05] Rule applied: remove_Boc
[15:22:05] Rule applied: disconnect_alkali_metals
</code></pre>
</div>
</div>
<p>But we can reset the StringIO object:</p>
<div id="74d6d1e8" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T14:23:19.703702Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T14:23:19.700393Z&quot;}" data-execution_count="45">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">logger_sio.truncate(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb25-2">logger_sio.seek(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb25-3"></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create and normalize a new molecule:</span></span>
<span id="cb25-5">new_m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Chem.MolFromSmiles(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CCCO[Na]'</span>)</span>
<span id="cb25-6">new_m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm2.normalize(new_m)</span>
<span id="cb25-7"></span>
<span id="cb25-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># show the normalizations that were applied:</span></span>
<span id="cb25-9">re.findall(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'Rule applied: (.*?)\n'</span>,logger_sio.getvalue())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>['disconnect_alkali_metals']</code></pre>
</div>
</div>
<p>We can now combine everything to write a function which applies a collection of custom transformations to a list of molecules and returns the transformed molecules along with which transformations were applied to each molecule:</p>
<div id="80d8aa63" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T14:30:51.403809Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T14:30:51.400558Z&quot;}" data-execution_count="46">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb27-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> io <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StringIO</span>
<span id="cb27-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> rdkit <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> rdBase</span>
<span id="cb27-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> re</span>
<span id="cb27-5"></span>
<span id="cb27-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> normalize_molecules(mols,standardization_rules):</span>
<span id="cb27-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tell the RDKit's C++ backend to log to use the python logger:</span></span>
<span id="cb27-8">    rdBase.LogToPythonLogger()</span>
<span id="cb27-9"></span>
<span id="cb27-10">    logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logging.getLogger(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rdkit'</span>)</span>
<span id="cb27-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set the log level for the default log handler (the one which sense output to the console/notebook):</span></span>
<span id="cb27-12">    logger.handlers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].setLevel(logging.WARN)</span>
<span id="cb27-13"></span>
<span id="cb27-14">    logger_sio <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StringIO()</span>
<span id="cb27-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create a handler that uses the StringIO and set its log level:</span></span>
<span id="cb27-16">    handler <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logging.StreamHandler(logger_sio)</span>
<span id="cb27-17">    handler.setLevel(logging.INFO)</span>
<span id="cb27-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add the handler to the Python logger:</span></span>
<span id="cb27-19">    logger.addHandler(handler)</span>
<span id="cb27-20"></span>
<span id="cb27-21">    </span>
<span id="cb27-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># create the new Normalizer:</span></span>
<span id="cb27-23">    cps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolStandardize.CleanupParameters()</span>
<span id="cb27-24">    nrm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rdMolStandardize.NormalizerFromData(standardization_rules,cps)</span>
<span id="cb27-25"></span>
<span id="cb27-26">    match_expr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> re.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'Rule applied: (.*?)\n'</span>)</span>
<span id="cb27-27">    </span>
<span id="cb27-28">    res_mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-29">    tfs_applied <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb27-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> mol <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> mols:</span>
<span id="cb27-31">        mol <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nrm.normalize(mol)</span>
<span id="cb27-32">        res_mols.append(mol)</span>
<span id="cb27-33">        </span>
<span id="cb27-34">        text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logger_sio.getvalue()</span>
<span id="cb27-35">        tfs_applied.append(match_expr.findall(text))</span>
<span id="cb27-36">        </span>
<span id="cb27-37">        logger_sio.truncate(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb27-38">        logger_sio.seek(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb27-39"></span>
<span id="cb27-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res_mols,tfs_applied</span>
<span id="cb27-41"></span>
<span id="cb27-42">    </span>
<span id="cb27-43">    </span></code></pre></div>
</div>
<div id="f35be9dd" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T14:32:48.724955Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T14:32:48.718344Z&quot;}" data-execution_count="49">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">tfs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb28-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">// this is from Deprotect.cpp:</span></span>
<span id="cb28-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">remove_Boc</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[C;R0][C;R0]([C;R0])([O;R0][C;R0](=[O;R0])[NX3;H0,H1:1])C&gt;&gt;[N:1]</span></span>
<span id="cb28-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">// this should go last, because later transformations will</span></span>
<span id="cb28-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">// lose the alkali metal</span></span>
<span id="cb28-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">disconnect_alkali_metals</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\t</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">[Li,Na,K,Rb:1]-[A:2]&gt;&gt;([*+:1].[*-:2])</span></span>
<span id="cb28-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'''</span></span>
<span id="cb28-8"></span>
<span id="cb28-9">mols <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Chem.MolFromSmiles(smi) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> smi <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> </span>
<span id="cb28-10">        (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC(C)(C)OC(=O)NCCC(=O)O[Na]'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CCCO[Na]'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'CC(C)(C)OC(=O)NCCC'</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'c1ccccc1'</span>)]</span>
<span id="cb28-11">tmols,tapplied <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> normalize_molecules(mols,tfs)</span></code></pre></div>
</div>
<div id="7026d378" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2024-02-23T14:33:30.949806Z&quot;,&quot;start_time&quot;:&quot;2024-02-23T14:33:30.937640Z&quot;}" data-execution_count="53">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">Draw.MolsToGridImage(tmols,legends<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>.join(x) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tapplied])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>
<figure class="figure">
<p><img src="https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>tutorial</category>
  <category>documentation</category>
  <guid>https://greglandrum.github.io/rdkit-blog/posts/2024-02-23-custom-transformations-and-logging.html</guid>
  <pubDate>Thu, 22 Feb 2024 23:00:00 GMT</pubDate>
  <media:content url="https://greglandrum.github.io/rdkit-blog/posts/images/blog/transforms-and-logging-1.png" medium="image" type="image/png" height="48" width="144"/>
</item>
</channel>
</rss>
