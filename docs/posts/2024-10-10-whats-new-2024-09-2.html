<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-10-10">
<meta name="description" content="Second of a series of short posts describing new features since the 2024.03.1 release">

<title>What’s new in 2024.09.1, part II – RDKit blog</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../posts/icons/favicon.ico" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-4379b0ccadffce622b03caf4c46266b3.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-53e29d70f03623de13ab2376923601bc.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-49b061ee4cc441246235e07f99f67764.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">RDKit blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">RDKit experiments, tips, and tutorials</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/rdkit/rdkit"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://bsky.app/profile/rdkit.bsky.social"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/groups/8192558/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#improvements-to-rms-filtering-in-conformer-generation" id="toc-improvements-to-rms-filtering-in-conformer-generation" class="nav-link active" data-scroll-target="#improvements-to-rms-filtering-in-conformer-generation">Improvements to RMS filtering in conformer generation</a></li>
  <li><a href="#interface-fo-the-pubchem-shape-based-alignment-code" id="toc-interface-fo-the-pubchem-shape-based-alignment-code" class="nav-link" data-scroll-target="#interface-fo-the-pubchem-shape-based-alignment-code">Interface fo the PubChem shape-based alignment code</a>
  <ul class="collapse">
  <li><a href="#about-the-features" id="toc-about-the-features" class="nav-link" data-scroll-target="#about-the-features">About the features</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">What’s new in 2024.09.1, part II</h1>
  <div class="quarto-categories">
    <div class="quarto-category">documentation</div>
    <div class="quarto-category">release</div>
  </div>
  </div>

<div>
  <div class="description">
    Second of a series of short posts describing new features since the 2024.03.1 release
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 10, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>This is the second of a short series of posts providing brief introductions to new functionality in the RDKit 2024.09.1 release (added since the 2024.03.1 release).</p>
<div id="bc9ae709" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rdkit</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>rdkit.__version__</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>'2024.09.1'</code></pre>
</div>
</div>
<div id="e64587b3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit <span class="im">import</span> Chem</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem <span class="im">import</span> Draw</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem.Draw <span class="im">import</span> IPythonConsole</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="improvements-to-rms-filtering-in-conformer-generation" class="level1">
<h1>Improvements to RMS filtering in conformer generation</h1>
<p>Here’s a simple molecule for demonstration purposes:</p>
<div id="bc208d1d" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>IPythonConsole.molSize <span class="op">=</span> <span class="dv">250</span>,<span class="dv">250</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> Chem.MolFromSmiles(<span class="st">'CCc1cc(C(=O)O)cc(C(=O)O)c1'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>
<figure class="figure">
<p><img src="2024-10-10-whats-new-2024-09-2_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="d5e0eb11" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdDistGeom</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdMolAlign</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>mh <span class="op">=</span> Chem.AddHs(m)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>ps.randomSeed <span class="op">=</span> <span class="bn">0xa100f</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>cids <span class="op">=</span> rdDistGeom.EmbedMultipleConfs(mh,<span class="dv">100</span>,ps)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(cids))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100</code></pre>
</div>
</div>
<div id="61fe949b" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> py3Dmol</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> drawit(ms, p<span class="op">=</span><span class="va">None</span>, confIds<span class="op">=</span><span class="va">None</span>, removeHs<span class="op">=</span><span class="va">False</span>,colors<span class="op">=</span>(<span class="st">'cyanCarbon'</span>,<span class="st">'blueCarbon'</span>,<span class="st">'redCarbon'</span>)):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> confIds <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>            confIds <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span><span class="bu">len</span>(ms)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> p <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> py3Dmol.view(width<span class="op">=</span><span class="dv">400</span>, height<span class="op">=</span><span class="dv">400</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        p.removeAllModels()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i,(m,confId) <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">zip</span>(ms,confIds)):</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> removeHs:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                m <span class="op">=</span> Chem.RemoveHs(m)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            IPythonConsole.addMolToView(m,p,confId<span class="op">=</span>confId)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i,m <span class="kw">in</span> <span class="bu">enumerate</span>(ms):</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            p.setStyle({<span class="st">'model'</span>:i,},</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                            {<span class="st">'stick'</span>:{<span class="st">'colorscheme'</span>:colors[i<span class="op">%</span><span class="bu">len</span>(colors)]}})</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        p.zoomTo()</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> p.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First a quick intro to the <code>symmetrizeConjugatedTerminalGroups</code> argument to <code>GetBestRMS()</code></p>
<div id="20a323e8" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="op">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="op">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>rms <span class="op">=</span> rdMolAlign.GetBestRMS(m1,m2,symmetrizeConjugatedTerminalGroups<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>rms<span class="sc">:.2f}</span><span class="ss">'</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>drawit([m1,m2])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.86</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17284452507970846" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17284452507970846" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17284452507970846 = null;
var warn = document.getElementById("3dmolwarning_17284452507970846");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17284452507970846 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17284452507970846"),{backgroundColor:"white"});
viewer_17284452507970846.zoomTo();
    viewer_17284452507970846.removeAllModels();
    viewer_17284452507970846.addModel("\n     RDKit          3D\n\n 14 14  0  0  0  0  0  0  0  0999 V2000\n    2.9083   -1.1662    0.7671 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0149   -1.2542   -0.4246 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7447   -0.5041   -0.2932 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.3453   -1.1475    0.2326 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.5723   -0.5167    0.3898 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.7280   -1.2100    0.9509 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8513   -0.6608    1.1038 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5747   -2.5397    1.3325 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.6583    0.7992   -0.0073 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.5956    1.4961   -0.5422 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7312    2.8973   -0.9521 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2505    3.5134   -1.4374 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9311    3.5390   -0.8065 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.5945    0.8149   -0.6724 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  6  7  2  0\n  6  8  1  0\n  5  9  2  0\n  9 10  1  0\n 10 11  1  0\n 11 12  2  0\n 11 13  1  0\n 10 14  2  0\n 14  3  1  0\nM  END\n","sdf");
    viewer_17284452507970846.setStyle({"stick": {}});
    viewer_17284452507970846.addModel("\n     RDKit          3D\n\n 14 14  0  0  0  0  0  0  0  0999 V2000\n    2.9462   -1.0221    0.7345 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0490   -1.1739   -0.4793 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7396   -0.5316   -0.2946 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.3639   -1.1701    0.2328 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.5722   -0.5209    0.3855 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.7372   -1.1997    0.9437 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8382   -0.6322    1.0904 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.6564   -2.5350    1.3404 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7049    0.7991    0.0089 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.6007    1.4368   -0.5184 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.7581    2.8320   -0.9114 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8761    3.3873   -0.7558 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.2742    3.5854   -1.4539 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.6238    0.8057   -0.6816 C   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  1  0\n  3  4  2  0\n  4  5  1  0\n  5  6  1  0\n  6  7  2  0\n  6  8  1  0\n  5  9  2  0\n  9 10  1  0\n 10 11  1  0\n 11 12  2  0\n 11 13  1  0\n 10 14  2  0\n 14  3  1  0\nM  END\n","sdf");
    viewer_17284452507970846.setStyle({"stick": {}});
    viewer_17284452507970846.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17284452507970846.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17284452507970846.zoomTo();
viewer_17284452507970846.render();
});
</script>
</div>
</div>
<p>You can see here that one of the carboxylic acids is flipped. That’s why the calculated RMSD is pretty high even though the overlay is quite good.</p>
<p>Using <code>symmetrizeConjugatedTerminalGroups=True</code> (which is the default), the RMSD calculate treats the two oxygens of the carboxylic acid as equivalent and we get a much lower RMSD value:</p>
<div id="56ab8982" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rms <span class="op">=</span> rdMolAlign.GetBestRMS(m1,m2)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>rms<span class="sc">:.2f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.08</code></pre>
</div>
</div>
<p>If we look across a varietyof conformer pairs we can see that this frequently makes a difference in the RMSDs:</p>
<div id="1a5f0b7f" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i):</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        m1 <span class="op">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op">=</span>cids[i]))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        m2 <span class="op">=</span> Chem.RemoveHs(Chem.Mol(mh,confId<span class="op">=</span>cids[j]))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        rms1 <span class="op">=</span> rdMolAlign.GetBestRMS(m1,m2)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        rms2 <span class="op">=</span> rdMolAlign.GetBestRMS(m1,m2,symmetrizeConjugatedTerminalGroups<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>j<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>rms1<span class="sc">:.2f}</span><span class="ss">, </span><span class="sc">{</span>rms2<span class="sc">:.2f}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1, 0: 0.08, 0.86
2, 0: 0.08, 0.86
2, 1: 0.09, 0.09
3, 0: 0.06, 0.85
3, 1: 0.08, 0.08
3, 2: 0.04, 0.04
4, 0: 0.08, 0.86
4, 1: 0.07, 0.58
4, 2: 0.12, 0.58
4, 3: 0.10, 0.58</code></pre>
</div>
</div>
<p>The <code>symmetrizeConjugatedTerminalGroups</code> option was added (and made the default) in the 2022.09.1 release of the RDKit. In the 2024.03.1 release we added support for this behavior to the RMSD pruning done during conformer generation and made it the default.</p>
<p>So if we turn on RMSD pruning for our simple test molecule, we now get only one conformer:</p>
<div id="8975b2b9" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ps.randomSeed <span class="op">=</span> <span class="bn">0xa100f</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>ps.pruneRmsThresh <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>cids <span class="op">=</span> rdDistGeom.EmbedMultipleConfs(mh,<span class="dv">10</span>,ps)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(cids))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1</code></pre>
</div>
</div>
<p>The symmetrization can be disabled:</p>
<div id="b1dfd62c" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ps.symmetrizeConjugatedTerminalGroupsForPruning<span class="op">=</span><span class="va">False</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cids <span class="op">=</span> rdDistGeom.EmbedMultipleConfs(mh,<span class="dv">10</span>,ps)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(cids))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3</code></pre>
</div>
</div>
</section>
<section id="interface-fo-the-pubchem-shape-based-alignment-code" class="level1">
<h1>Interface fo the PubChem shape-based alignment code</h1>
<p>The PubChem team has recently published <a href="https://github.com/ncbi/pubchem-align3d/">pubchem-align3d</a>, an open-source library for doing fast shape-based alignment of molecules.</p>
<p>We’ve put an RDKit wrapper around this and added it as an optional RDKit feature.</p>
<p>The API here is likely to evolve over the next couple of releases.</p>
<p>Start by reading in a set of test molecules. We’re using one of the sets from the paper “An Extensive and Diverse Set of Molecular Overlays for the Validation of Pharmacophore Programs” by <a href="https://doi.org/10.1021/ci400020a">Ilena Giangreco and coworkers</a></p>
<div id="e68e6334" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gzip</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit <span class="im">import</span> Chem</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdDistGeom</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem.Draw <span class="im">import</span> IPythonConsole</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>IPythonConsole.ipython_3d <span class="op">=</span> <span class="va">True</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> Chem.ForwardSDMolSupplier(gzip.<span class="bu">open</span>(<span class="st">'../data/AZ_overlays/P27487.sdf.gz'</span>),removeHs<span class="op">=</span><span class="va">False</span>) <span class="cf">if</span> x <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(ms)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>ref <span class="op">=</span> ms.pop(<span class="dv">0</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>ref</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[07:11:49] Explicit valence for atom # 21 C, 5, is greater than permitted
[07:11:49] ERROR: Could not sanitize molecule ending on line 1352
[07:11:49] ERROR: Explicit valence for atom # 21 C, 5, is greater than permitted</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728537109109565" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728537109109565" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728537109109565 = null;
var warn = document.getElementById("3dmolwarning_1728537109109565");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728537109109565 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728537109109565"),{backgroundColor:"white"});
viewer_1728537109109565.zoomTo();
    viewer_1728537109109565.removeAllModels();
    viewer_1728537109109565.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_1728537109109565.setStyle({"stick": {}});
    viewer_1728537109109565.setBackgroundColor("0xeeeeee");
    viewer_1728537109109565.zoomTo();
viewer_1728537109109565.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">

</div>
</div>
<p>Generate conformers for each of the molecules so that we have something to align</p>
<div id="7e35cf61" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> rdDistGeom.srETKDGv3()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ps.randomSeed <span class="op">=</span> <span class="bn">0xa100f</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>ps.numThreads <span class="op">=</span> <span class="dv">8</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> ms:</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    rdDistGeom.EmbedMultipleConfs(m,<span class="dv">100</span>,ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0c0ad37b" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(ms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>37</code></pre>
</div>
</div>
<p>Make a copy of the molecules so that we can play with them</p>
<div id="62e14fcb" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ms_save <span class="op">=</span> copy.deepcopy(ms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cad1cae9" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> copy.deepcopy(ms_save)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Look at the two molecules to align, just to see where we are starting.</p>
<div id="7327395f" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>drawit([ref,ms[<span class="dv">0</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728537170695931" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728537170695931" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728537170695931 = null;
var warn = document.getElementById("3dmolwarning_1728537170695931");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728537170695931 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728537170695931"),{backgroundColor:"white"});
viewer_1728537170695931.zoomTo();
    viewer_1728537170695931.removeAllModels();
    viewer_1728537170695931.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_1728537170695931.setStyle({"stick": {}});
    viewer_1728537170695931.addModel("1rwq_lig_5AP\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    1.8235    1.7553    1.5163 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n    2.8830    1.5354    0.1130 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.8773    2.4564   -0.1761 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7040    2.2782   -1.2731 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.9704    3.4346   -1.6556 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n    4.5428    1.1601   -2.1051 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.5364    0.2259   -1.8147 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.7236    0.4184   -0.7204 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.6535   -0.4946   -0.3375 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.8573   -1.8485   -0.1210 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.1990   -2.3941   -0.2877 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.9286   -2.4804    0.7989 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7806   -2.6198    0.2515 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.0400   -4.0120    0.4645 N   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4214    0.0151   -0.1778 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.6143   -0.7624    0.1880 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -0.4389   -2.0754    0.4024 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.9143   -0.1108    0.3297 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0313   -0.7835    0.7867 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.2073   -0.1017    0.9117 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3824   -0.7293    1.3740 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2530   -2.1060    1.6992 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.3458    1.2445    0.6016 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.2423    1.9233    0.1462 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.0700    1.2206    0.0282 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.2415    3.2656   -0.1988 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.0788    3.9278   -0.6692 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.9856    3.3100    0.4788 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1883    1.0076   -2.9719 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3797   -0.6468   -2.4325 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.5926   -2.7168   -1.2579 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8990   -2.8639    0.7390 H   0  0  0  0  0  0  0  0  0  0  0  0\n    1.5665   -4.4937   -0.3210 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7269   -4.4783    1.3246 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.9588   -1.8257    1.0351 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2429   -2.4626    2.1079 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.8952   -2.7294    0.8629 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.5382   -2.2485    2.5468 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2609    1.7900    0.6956 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.1855    1.7534   -0.3345 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3272    4.0657    0.1193 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.6440    3.3298   -1.5264 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4071    4.8668   -1.1409 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  2  8  1  0\n  3  4  1  0\n  3 28  1  0\n  4  5  1  0\n  4  6  2  0\n  6  7  1  0\n  6 29  1  0\n  7  8  2  0\n  7 30  1  0\n  8  9  1  0\n  9 10  2  0\n  9 15  1  0\n 10 11  1  0\n 10 13  1  0\n 11 12  2  0\n 11 31  1  0\n 12 32  1  0\n 13 14  1  0\n 13 17  2  0\n 14 33  1  0\n 14 34  1  0\n 15 16  2  0\n 16 17  1  0\n 16 18  1  0\n 18 19  2  0\n 18 25  1  0\n 19 20  1  0\n 19 35  1  0\n 20 21  1  0\n 20 23  2  0\n 21 22  1  0\n 22 36  1  0\n 22 37  1  0\n 22 38  1  0\n 23 24  1  0\n 23 39  1  0\n 24 25  2  0\n 24 26  1  0\n 25 40  1  0\n 26 27  1  0\n 27 41  1  0\n 27 42  1  0\n 27 43  1  0\nM  END\n","sdf");
    viewer_1728537170695931.setStyle({"stick": {}});
    viewer_1728537170695931.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_1728537170695931.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_1728537170695931.zoomTo();
viewer_1728537170695931.render();
});
</script>
</div>
</div>
<p>Now align those and show the results:</p>
<div id="9722dea2" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdkit.Chem <span class="im">import</span> rdShapeAlign</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>tpl <span class="op">=</span> rdShapeAlign.AlignMol(ref,ms[<span class="dv">0</span>])</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tpl)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>drawit([ref,ms[<span class="dv">0</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.4333876003130784, 0.03657366774970186)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285371717767177" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285371717767177" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285371717767177 = null;
var warn = document.getElementById("3dmolwarning_17285371717767177");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285371717767177 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285371717767177"),{backgroundColor:"white"});
viewer_17285371717767177.zoomTo();
    viewer_17285371717767177.removeAllModels();
    viewer_17285371717767177.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_17285371717767177.setStyle({"stick": {}});
    viewer_17285371717767177.addModel("1rwq_lig_5AP\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n   37.1332   53.0833   35.0233 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n   38.4229   52.9806   33.8125 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.6169   54.0007   32.8948 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.6281   53.9159   31.9519 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8901   55.1991   30.7806 Cl  0  0  0  0  0  0  0  0  0  0  0  0\n   40.4687   52.7932   31.9164 C   0  0  0  0  0  0  0  0  0  0  0  0\n   40.2743   51.7586   32.8445 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.2644   51.8590   33.7749 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9850   50.8387   34.7781 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9419   50.3685   35.6639 C   0  0  0  0  0  0  0  0  0  0  0  0\n   41.2941   50.9090   35.5919 C   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5623   51.9084   36.3981 N   0  0  0  0  0  0  0  0  0  0  0  0\n   39.5693   49.4138   36.5818 C   0  0  0  0  0  0  0  0  0  0  0  0\n   40.5913   48.9594   37.4760 N   0  0  0  0  0  0  0  0  0  0  0  0\n   37.7358   50.3504   34.8447 N   0  0  0  0  0  0  0  0  0  0  0  0\n   37.3983   49.4168   35.7533 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.3092   48.9479   36.6199 N   0  0  0  0  0  0  0  0  0  0  0  0\n   36.0144   48.9484   35.7391 C   0  0  0  0  0  0  0  0  0  0  0  0\n   35.5258   48.0612   36.6789 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.2153   47.6847   36.6126 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.6547   46.7845   37.5420 O   0  0  0  0  0  0  0  0  0  0  0  0\n   34.5429   46.3063   38.5423 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.3362   48.1481   35.6431 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.8107   49.0303   34.7038 C   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1301   49.3966   34.7878 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.0429   49.5689   33.6834 O   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5746   50.4749   32.7305 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.9591   54.8576   32.9405 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.2698   52.7148   31.1791 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8995   50.8772   32.8480 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.0549   50.5165   34.9083 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.5159   52.3358   36.3894 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4972   48.6662   37.0072 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.4274   48.9326   38.4897 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.1794   47.6829   37.4423 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.9544   45.6489   39.2462 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.4346   45.7975   38.1397 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.9042   47.1453   39.1867 H   0  0  0  0  0  0  0  0  0  0  0  0\n   32.3076   47.8615   35.5807 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.5172   50.0988   34.0430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.7978   51.4579   33.1661 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.5104   50.0215   32.2834 H   0  0  0  0  0  0  0  0  0  0  0  0\n   32.8685   50.5116   31.8866 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  2  3  2  0\n  2  8  1  0\n  3  4  1  0\n  3 28  1  0\n  4  5  1  0\n  4  6  2  0\n  6  7  1  0\n  6 29  1  0\n  7  8  2  0\n  7 30  1  0\n  8  9  1  0\n  9 10  2  0\n  9 15  1  0\n 10 11  1  0\n 10 13  1  0\n 11 12  2  0\n 11 31  1  0\n 12 32  1  0\n 13 14  1  0\n 13 17  2  0\n 14 33  1  0\n 14 34  1  0\n 15 16  2  0\n 16 17  1  0\n 16 18  1  0\n 18 19  2  0\n 18 25  1  0\n 19 20  1  0\n 19 35  1  0\n 20 21  1  0\n 20 23  2  0\n 21 22  1  0\n 22 36  1  0\n 22 37  1  0\n 22 38  1  0\n 23 24  1  0\n 23 39  1  0\n 24 25  2  0\n 24 26  1  0\n 25 40  1  0\n 26 27  1  0\n 27 41  1  0\n 27 42  1  0\n 27 43  1  0\nM  END\n","sdf");
    viewer_17285371717767177.setStyle({"stick": {}});
    viewer_17285371717767177.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17285371717767177.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17285371717767177.zoomTo();
viewer_17285371717767177.render();
});
</script>
</div>
</div>
<p>Find the conformer from each molecule that aligns with the highest feature score (the code calls it “color” score in analogy to the terminology that’s used in ROCS) and see how long that takes.</p>
<div id="cf22dad6" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> copy.deepcopy(ms_save)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time.time()</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>nAligns <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>bestScores <span class="op">=</span> []</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> ms:</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    best <span class="op">=</span> <span class="op">-</span><span class="fl">1e8</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    bestConf <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> conf <span class="kw">in</span> m.GetConformers():</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        nAligns <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        shapeTani,colorTani <span class="op">=</span> rdShapeAlign.AlignMol(ref,m,probeConfId<span class="op">=</span>conf.GetId())</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colorTani <span class="op">&gt;</span> best:</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>            best <span class="op">=</span> colorTani</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>            bestConf <span class="op">=</span> conf.GetId()</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    bestScores.append((best,bestConf))</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> time.time()</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>t2<span class="op">-</span>t1<span class="sc">:.2f}</span><span class="ss"> seconds for </span><span class="sc">{</span>nAligns<span class="sc">}</span><span class="ss"> alignments, </span><span class="sc">{</span>(t2<span class="op">-</span>t1)<span class="op">/</span>nAligns<span class="sc">:.2g}</span><span class="ss">s per alignment'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.50 seconds for 3700 alignments, 0.0004s per alignment</code></pre>
</div>
</div>
<div id="6b365762" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="bu">sorted</span>([(tpl,i) <span class="cf">for</span> i,tpl <span class="kw">in</span> <span class="bu">enumerate</span>(bestScores)],reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>order[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>[((0.41623472182088234, 53), 10),
 ((0.38375118479238873, 83), 14),
 ((0.343586129348326, 5), 1),
 ((0.3286720498960583, 87), 17),
 ((0.305952661317346, 20), 13)]</code></pre>
</div>
</div>
<div id="9522e9be" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>whichMol <span class="op">=</span> order[<span class="dv">0</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>bestConf <span class="op">=</span> bestScores[whichMol][<span class="dv">1</span>]</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(bestScores[whichMol])</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>drawit([ref,ms[whichMol]],confIds<span class="op">=</span>(<span class="op">-</span><span class="dv">1</span>,bestConf))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(0.41623472182088234, 53)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728537285213021" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728537285213021" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728537285213021 = null;
var warn = document.getElementById("3dmolwarning_1728537285213021");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728537285213021 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728537285213021"),{backgroundColor:"white"});
viewer_1728537285213021.zoomTo();
    viewer_1728537285213021.removeAllModels();
    viewer_1728537285213021.addModel("1n1m_lig_A3M\n     RDKit          3D\n\n 31 31  0  0  1  0  0  0  0  0999 V2000\n   35.0860   47.5790   35.0350 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.4150   48.4020   34.7020 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.6190   49.2710   35.8730 N   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2580   49.5590   36.3520 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6620   48.1420   36.4620 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.4840   50.4260   35.6040 C   0  0  0  0  0  0  0  0  0  0  0  0\n   38.8560   50.3740   35.0990 C   0  0  2  0  0  0  0  0  0  0  0  0\n   39.9730   50.3700   36.0850 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9680   49.2210   36.9950 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9730   51.6930   35.8390 O   0  0  0  0  0  0  0  0  0  0  0  0\n   39.1290   51.4820   34.1430 N   0  0  0  0  0  0  0  0  0  0  0  0\n   41.4580   50.3000   35.2790 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.3360   47.7740   34.2690 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3130   46.5130   35.0570 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2450   47.7100   34.5620 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2660   48.9790   33.7890 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.3120   50.0790   37.3090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.7430   50.1880   35.6260 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5760   48.1170   36.5560 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.1070   47.5260   37.2430 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9720   49.5060   34.4500 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.8990   51.2510   36.7210 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.8140   49.2960   37.6800 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.0400   49.2120   37.5660 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0480   48.3000   36.4180 H   0  0  0  0  0  0  0  0  0  0  0  0\n   40.0820   51.4180   33.8140 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4970   51.4130   33.3580 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9930   52.3690   34.6060 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.2680   50.2980   36.0090 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5060   49.3900   34.6820 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.5600   51.1680   34.6280 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  1  0\n  1  5  1  0\n  1 13  1  0\n  1 14  1  0\n  2  3  1  0\n  2 15  1  0\n  2 16  1  0\n  3  4  1  0\n  3  6  1  0\n  4  5  1  0\n  4 17  1  0\n  4 18  1  0\n  5 19  1  0\n  5 20  1  0\n  6  7  1  0\n  6 10  2  0\n  7  8  1  0\n  7 11  1  0\n  7 21  1  6\n  8  9  1  0\n  8 12  1  0\n  8 22  1  0\n  9 23  1  0\n  9 24  1  0\n  9 25  1  0\n 11 26  1  0\n 11 27  1  0\n 11 28  1  0\n 12 29  1  0\n 12 30  1  0\n 12 31  1  0\nM  CHG  1  11   1\nM  END\n","sdf");
    viewer_1728537285213021.setStyle({"stick": {}});
    viewer_1728537285213021.addModel("2iiv_lig_565\n     RDKit          3D\n\n 45 46  0  0  1  0  0  0  0  0999 V2000\n   43.6722   52.6471   34.1521 C   0  0  0  0  0  0  0  0  0  0  0  0\n   42.6306   51.7211   34.1936 C   0  0  0  0  0  0  0  0  0  0  0  0\n   42.1722   51.1973   35.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n   42.8235   51.6560   36.5320 C   0  0  0  0  0  0  0  0  0  0  0  0\n   43.8456   52.5640   36.4941 C   0  0  0  0  0  0  0  0  0  0  0  0\n   44.2964   53.0839   35.2983 C   0  0  0  0  0  0  0  0  0  0  0  0\n   44.4165   52.9522   37.6588 F   0  0  0  0  0  0  0  0  0  0  0  0\n   42.1075   51.3396   33.0071 F   0  0  0  0  0  0  0  0  0  0  0  0\n   41.0755   50.2626   35.5564 C   0  0  0  0  0  0  0  0  0  0  0  0\n   39.6954   50.9483   35.5780 C   0  0  2  0  0  0  0  0  0  0  0  0\n   38.6742   49.8702   35.7838 C   0  0  0  0  0  0  0  0  0  0  0  0\n   37.2783   50.3539   35.8752 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2590   49.4386   35.9842 N   0  0  0  0  0  0  0  0  0  0  0  0\n   39.4501   51.5767   34.2773 N   0  0  0  0  0  0  0  0  0  0  0  0\n   36.9794   51.5921   35.8584 O   0  0  0  0  0  0  0  0  0  0  0  0\n   36.3590   48.0281   36.0098 C   0  0  0  0  0  0  0  0  0  0  0  0\n   36.2603   47.3405   34.6248 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.8888   47.9194   34.1491 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.9334   47.6131   35.1765 N   0  0  0  0  0  0  0  0  0  0  0  0\n   33.9335   48.7287   36.2240 C   0  0  0  0  0  0  0  0  0  0  0  0\n   34.8244   49.9643   36.0994 C   0  0  1  0  0  0  0  0  0  0  0  0\n   34.6703   50.7474   37.3622 C   0  0  0  0  0  0  0  0  0  0  0  0\n   33.1825   48.5816   37.1692 O   0  0  0  0  0  0  0  0  0  0  0  0\n   45.3063   53.9764   35.3182 F   0  0  0  0  0  0  0  0  0  0  0  0\n   44.0364   53.0641   33.2177 H   0  0  0  0  0  0  0  0  0  0  0  0\n   42.5071   51.2784   37.5056 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.0273   49.4774   34.7686 H   0  0  0  0  0  0  0  0  0  0  0  0\n   41.1720   49.7423   36.5224 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.7000   51.7130   36.3528 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.7653   49.1751   34.9156 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.9066   49.3552   36.7286 H   0  0  0  0  0  0  0  0  0  0  0  0\n   38.4395   51.8197   34.1976 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.5827   50.8232   33.5521 H   0  0  0  0  0  0  0  0  0  0  0  0\n   39.9894   52.4362   34.1306 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.6051   47.5212   36.6416 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.3768   47.7053   36.3650 H   0  0  0  0  0  0  0  0  0  0  0  0\n   36.1782   46.2842   34.7906 H   0  0  0  0  0  0  0  0  0  0  0  0\n   37.0094   47.6303   33.9304 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6705   47.2631   33.2336 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.9085   48.9055   33.7994 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.3310   46.8647   35.3044 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.6244   50.5160   35.1961 H   0  0  0  0  0  0  0  0  0  0  0  0\n   34.9950   50.1326   38.2382 H   0  0  0  0  0  0  0  0  0  0  0  0\n   35.2031   51.7050   37.3251 H   0  0  0  0  0  0  0  0  0  0  0  0\n   33.5789   50.9209   37.5083 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  2  2  0\n  1  6  1  0\n  1 25  1  0\n  2  3  1  0\n  2  8  1  0\n  3  4  2  0\n  3  9  1  0\n  4  5  1  0\n  4 26  1  0\n  5  6  2  0\n  5  7  1  0\n  6 24  1  0\n  9 10  1  0\n  9 27  1  0\n  9 28  1  0\n 10 11  1  0\n 10 14  1  0\n 10 29  1  1\n 11 12  1  0\n 11 30  1  0\n 11 31  1  0\n 12 13  1  0\n 12 15  2  0\n 13 16  1  0\n 13 21  1  0\n 14 32  1  0\n 14 33  1  0\n 14 34  1  0\n 16 17  1  0\n 16 35  1  0\n 16 36  1  0\n 17 18  1  0\n 17 37  1  0\n 17 38  1  0\n 18 19  1  0\n 18 39  1  0\n 18 40  1  0\n 19 20  1  0\n 19 41  1  0\n 20 21  1  0\n 20 23  2  0\n 21 22  1  0\n 21 42  1  6\n 22 43  1  0\n 22 44  1  0\n 22 45  1  0\nM  CHG  1  14   1\nM  END\n","sdf");
    viewer_1728537285213021.setStyle({"stick": {}});
    viewer_1728537285213021.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_1728537285213021.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_1728537285213021.zoomTo();
viewer_1728537285213021.render();
});
</script>
</div>
</div>
<p>Since the reference molecule remains the same in each of these alignments, we can save a bit of time by precomputing the shape of the reference:</p>
<div id="a45a14f0" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> copy.deepcopy(ms_save)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time.time()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>refShape <span class="op">=</span> rdShapeAlign.PrepareConformer(ref)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>nAligns <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>bestScores <span class="op">=</span> []</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> m <span class="kw">in</span> ms:</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    best <span class="op">=</span> <span class="op">-</span><span class="fl">1e8</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    bestConf <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> conf <span class="kw">in</span> m.GetConformers():</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>        nAligns <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        shapeTani,colorTani <span class="op">=</span> rdShapeAlign.AlignMol(refShape,m,probeConfId<span class="op">=</span>conf.GetId())</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colorTani <span class="op">&gt;</span> best:</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>            best <span class="op">=</span> colorTani</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>            bestConf <span class="op">=</span> conf.GetId()</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    bestScores.append((best,bestConf))</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> time.time()</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>t2<span class="op">-</span>t1<span class="sc">:.2f}</span><span class="ss"> seconds for </span><span class="sc">{</span>nAligns<span class="sc">}</span><span class="ss"> alignments, </span><span class="sc">{</span>(t2<span class="op">-</span>t1)<span class="op">/</span>nAligns<span class="sc">:.2g}</span><span class="ss">s per alignment'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.35 seconds for 3700 alignments, 0.00036s per alignment</code></pre>
</div>
</div>
<p>This, of course, does not change the results:</p>
<div id="cd00c908" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> <span class="bu">sorted</span>([(tpl,i) <span class="cf">for</span> i,tpl <span class="kw">in</span> <span class="bu">enumerate</span>(bestScores2)],reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>order[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>[((0.41623472182088234, 53), 10),
 ((0.38375118479238873, 83), 14),
 ((0.343586129348326, 5), 1),
 ((0.3286720498960583, 87), 17),
 ((0.305952661317346, 20), 13)]</code></pre>
</div>
</div>
<section id="about-the-features" class="level2">
<h2 class="anchored" data-anchor-id="about-the-features">About the features</h2>
<p>The default feature definitions used for scoring the alignments are a slightly modified version of the <a href="https://doi.org/10.1002/(SICI)1097-0290(199824)61:1%3C47::AID-BIT9%3E3.0.CO;2-Z">Gobbi and Poppinger</a> features used elsewhere in the RDKit.</p>
<p>If the molecules have property that <a href="https://pubchem.ncbi.nlm.nih.gov/docs/pubchem3d">PubChem3D</a> uses to indicate pharmacophore features - <code>PUBCHEM_PHARMACOPHORE_FEATURES</code> - those features will be used instead.</p>
<p>Here’s an example showing this with conformers downloaded from PubChem3D:</p>
<div id="df9a74ce" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sdf <span class="op">=</span> requests.get(<span class="st">'https://pubchem.ncbi.nlm.nih.gov/rest/pug/conformers/000011F200000003/SDF'</span>).content</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>suppl <span class="op">=</span> Chem.SDMolSupplier()</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>suppl.SetData(sdf,removeHs<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>omeprazole <span class="op">=</span> <span class="bu">next</span>(suppl)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>omeprazole</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285427875475228" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285427875475228" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285427875475228 = null;
var warn = document.getElementById("3dmolwarning_17285427875475228");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285427875475228 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285427875475228"),{backgroundColor:"white"});
viewer_17285427875475228.zoomTo();
    viewer_17285427875475228.removeAllModels();
    viewer_17285427875475228.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_17285427875475228.setStyle({"stick": {}});
    viewer_17285427875475228.setBackgroundColor("0xeeeeee");
    viewer_17285427875475228.zoomTo();
viewer_17285427875475228.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="30">

</div>
</div>
<p>Look at the feature definitions;</p>
<div id="e2790203" class="cell" data-scrolled="true" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(omeprazole.GetProp(<span class="st">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9
1 2 acceptor
1 3 acceptor
1 4 acceptor
1 5 donor
1 7 acceptor
3 5 6 11 cation
5 5 6 11 12 14 rings
6 12 14 17 19 20 21 rings
6 7 9 10 13 15 18 rings</code></pre>
</div>
</div>
<div id="a5b6bc46" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>sdf <span class="op">=</span> requests.get(<span class="st">'https://pubchem.ncbi.nlm.nih.gov/rest/pug/conformers/0005DA1100000001/SDF'</span>).content</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>suppl <span class="op">=</span> Chem.SDMolSupplier()</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>suppl.SetData(sdf,removeHs<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>mol <span class="op">=</span> <span class="bu">next</span>(suppl)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>mol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285429342695057" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285429342695057" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285429342695057 = null;
var warn = document.getElementById("3dmolwarning_17285429342695057");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285429342695057 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285429342695057"),{backgroundColor:"white"});
viewer_17285429342695057.zoomTo();
    viewer_17285429342695057.removeAllModels();
    viewer_17285429342695057.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n   -0.4311    0.0004    1.0847 S   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9631   -2.3738   -0.2994 F   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9627    2.3737   -0.2998 F   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6642    2.3679    0.0662 F   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6641   -2.3681    0.0660 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.0189   -0.0006    0.2501 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0905    0.0007    1.4806 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5226   -0.0002   -0.6683 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.9371    0.0000   -0.3028 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4491   -0.0001   -0.5050 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.2747    0.0003    0.7891 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8935   -0.0001   -0.5498 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.0736    0.0002    0.5669 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6181   -1.2079   -0.2099 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6183    1.2081   -0.2111 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.6059    0.0003    1.2071 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.8861   -0.0005   -1.5444 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.0005    1.2082   -0.0238 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.0003   -1.2079   -0.0225 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.6916    0.0001    0.0705 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.5807   -0.0003    0.2038 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2293   -0.0005   -1.1480 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.1499    0.8780   -1.0895 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.1499   -0.8786   -1.0889 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.9868    0.0011    2.4864 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8761    0.0006    2.2569 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.6234   -0.0009   -2.5975 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6316   -0.0004    0.4825 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.0096   -0.0009   -1.9048 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_17285429342695057.setStyle({"stick": {}});
    viewer_17285429342695057.setBackgroundColor("0xeeeeee");
    viewer_17285429342695057.zoomTo();
viewer_17285429342695057.render();
});
</script>
</div>
<div class="cell-output cell-output-display" data-execution_count="31">

</div>
</div>
<div id="92fafc6c" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mol.GetProp(<span class="st">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5
1 7 donor
3 7 8 13 cation
5 7 8 11 12 13 rings
6 11 12 16 17 21 22 rings
6 9 14 15 18 19 20 rings</code></pre>
</div>
</div>
<p>Align the molecules:</p>
<div id="38b2186e" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>shapeTani,colorTani <span class="op">=</span> rdShapeAlign.AlignMol(omeprazole,mol)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shapeTani,colorTani)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>drawit([omeprazole,mol])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8584853463904615 0.5117278196011656</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285431073726847" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285431073726847" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285431073726847 = null;
var warn = document.getElementById("3dmolwarning_17285431073726847");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285431073726847 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285431073726847"),{backgroundColor:"white"});
viewer_17285431073726847.zoomTo();
    viewer_17285431073726847.removeAllModels();
    viewer_17285431073726847.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_17285431073726847.setStyle({"stick": {}});
    viewer_17285431073726847.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n    0.2156    0.7254   -0.7293 S   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4853    1.8433    1.8943 F   0  0  0  0  0  0  0  0  0  0  0  0\n    2.8046   -1.8088   -1.1222 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4873   -1.3794   -1.3485 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1682    2.2634    1.6612 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.6732    0.6557    0.0410 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4486    0.7871   -1.0868 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8171   -0.5363    0.5835 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6193    0.0133    0.3880 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1415   -0.2210    0.5152 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6086    0.2639   -0.5758 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.1879   -0.5588    0.4653 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4068    0.2797   -0.3614 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.2143    1.0500    1.0971 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3772   -0.8092   -0.4372 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9488    0.4345   -0.9244 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1476   -1.2608    1.2140 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7500   -0.5918   -0.5550 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.5871    1.2675    0.9793 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3550    0.4466    0.1534 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8906   -0.2716   -0.1685 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.4992   -1.1048    0.8819 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9200   -1.2889    0.4026 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.8017    0.0626    1.5183 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3756    1.4329   -1.8614 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2501    1.0817   -1.7401 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8538   -1.9105    2.0323 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.9471   -0.1694   -0.4040 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2544   -1.6407    1.4512 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_17285431073726847.setStyle({"stick": {}});
    viewer_17285431073726847.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17285431073726847.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17285431073726847.zoomTo();
viewer_17285431073726847.render();
});
</script>
</div>
</div>
<p>If we remove the properties, the code uses the RDKit feature definitions, so we get a different feature score:</p>
<div id="d6db5a70" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> Chem.Mol(omeprazole)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>t1.ClearProp(<span class="st">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> Chem.Mol(mol)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>t2.ClearProp(<span class="st">'PUBCHEM_PHARMACOPHORE_FEATURES'</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>shapeTani,colorTani <span class="op">=</span> rdShapeAlign.AlignMol(t1,t2)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shapeTani,colorTani)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>drawit([t1,t2])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8584733801282853 0.4440077489499693</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_1728543170085571" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1728543170085571" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_1728543170085571 = null;
var warn = document.getElementById("3dmolwarning_1728543170085571");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1728543170085571 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1728543170085571"),{backgroundColor:"white"});
viewer_1728543170085571.zoomTo();
    viewer_1728543170085571.removeAllModels();
    viewer_1728543170085571.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_1728543170085571.setStyle({"stick": {}});
    viewer_1728543170085571.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n    0.2128    0.7236   -0.7300 S   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4829    1.8459    1.8914 F   0  0  0  0  0  0  0  0  0  0  0  0\n    2.8017   -1.8113   -1.1189 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4843   -1.3824   -1.3463 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1658    2.2656    1.6571 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.6705    0.6551    0.0395 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4514    0.7847   -1.0872 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8197   -0.5359    0.5854 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6167    0.0134    0.3882 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1389   -0.2207    0.5160 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6114    0.2624   -0.5751 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.1905   -0.5586    0.4674 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4095    0.2785   -0.3611 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.2118    1.0512    1.0954 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3745   -0.8105   -0.4357 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9517    0.4324   -0.9237 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1502   -1.2593    1.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7472   -0.5934   -0.5541 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.5845    1.2685    0.9771 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3523    0.4462    0.1524 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8933   -0.2724   -0.1665 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.5018   -1.1038    0.8853 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9173   -1.2888    0.4053 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7992    0.0647    1.5187 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3786    1.4291   -1.8629 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2530    1.0782   -1.7406 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8562   -1.9076    2.0368 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.9498   -0.1706   -0.4020 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2569   -1.6387    1.4556 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_1728543170085571.setStyle({"stick": {}});
    viewer_1728543170085571.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_1728543170085571.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_1728543170085571.zoomTo();
viewer_1728543170085571.render();
});
</script>
</div>
</div>
<p>As a final note, it’s possible to disable the use of features in the scoring entirely:</p>
<div id="c5e6347a" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>shapeTani,colorTani <span class="op">=</span> rdShapeAlign.AlignMol(t1,t2,useColors<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shapeTani,colorTani)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>drawit([t1,t2])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8584733855324804 0.0</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="3dmolviewer_17285434059751809" style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17285434059751809" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdnjs.cloudflare.com/ajax/libs/3Dmol/2.4.0/3Dmol-min.js');
}

var viewer_17285434059751809 = null;
var warn = document.getElementById("3dmolwarning_17285434059751809");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17285434059751809 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17285434059751809"),{backgroundColor:"white"});
viewer_17285434059751809.zoomTo();
    viewer_17285434059751809.removeAllModels();
    viewer_17285434059751809.addModel("4594\n     RDKit          3D\n\n 43 45  0  0  1  0  0  0  0  0999 V2000\n    0.2799    0.7535   -0.8523 S   0  0  0  0  0  0  0  0  0  0  0  0\n    5.6802   -1.1956   -0.9111 O   0  0  0  0  0  0  0  0  0  0  0  0\n    0.4072    2.2559   -0.6946 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.1752   -0.0818    0.1901 O   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5022    1.0085   -0.7856 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.7125   -0.8269    0.1880 N   0  0  0  0  0  0  0  0  0  0  0  0\n    3.0758    1.3692    1.0722 N   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1692   -0.0049    0.5379 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6466    0.2489    0.4560 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.4644   -0.6385   -0.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.3970    0.2739   -0.4568 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6042    0.3371   -0.3218 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.8250   -0.3553   -0.2618 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.0850   -0.8048    0.2820 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3120    0.7890    0.3602 C   0  0  0  0  0  0  0  0  0  0  0  0\n    2.9174   -1.8598   -0.8757 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9691    0.6219   -0.3770 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.4043    1.6113    1.0079 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.9650   -1.7284    0.8713 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8306   -0.3083    0.2142 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.3395   -1.4631    0.8279 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.7599    1.1362    0.3412 C   0  0  0  0  0  0  0  0  0  0  0  0\n    6.2567   -2.2506   -0.1449 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.6184    1.1125   -0.4496 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9382   -1.0730    0.5858 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7767    0.4398    1.4605 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.5082    1.8901   -1.2814 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.0477   -1.6254   -1.4971 H   0  0  0  0  0  0  0  0  0  0  0  0\n    3.6371   -2.3342   -1.5505 H   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6348   -2.6025   -0.1225 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2846    1.5336   -0.8669 H   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7213    2.5182    1.5137 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.5932   -2.6284    1.3503 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.0290   -2.1717    1.2809 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.9177    2.1983    0.5593 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.3008    0.5521    1.0919 H   0  0  0  0  0  0  0  0  0  0  0  0\n    7.1989    0.9483   -0.6443 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8888   -2.8477   -0.8081 H   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4800   -2.8993    0.2720 H   0  0  0  0  0  0  0  0  0  0  0  0\n    6.8790   -1.8507    0.6611 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.2495    2.0066    0.0645 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -8.7108    1.1318   -0.3763 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -7.3713    1.1144   -1.5167 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1  3  2  0\n  1  8  1  1\n  1 11  1  0\n  2 13  1  0\n  2 23  1  0\n  4 20  1  0\n  4 24  1  0\n  5 11  1  0\n  5 12  1  0\n  5 27  1  0\n  6 11  2  0\n  6 14  1  0\n  7  9  2  0\n  7 18  1  0\n  8  9  1  0\n  8 25  1  0\n  8 26  1  0\n  9 10  1  0\n 10 13  2  0\n 10 16  1  0\n 12 14  2  0\n 12 17  1  0\n 13 15  1  0\n 14 19  1  0\n 15 18  2  0\n 15 22  1  0\n 16 28  1  0\n 16 29  1  0\n 16 30  1  0\n 17 20  2  0\n 17 31  1  0\n 18 32  1  0\n 19 21  2  0\n 19 33  1  0\n 20 21  1  0\n 21 34  1  0\n 22 35  1  0\n 22 36  1  0\n 22 37  1  0\n 23 38  1  0\n 23 39  1  0\n 23 40  1  0\n 24 41  1  0\n 24 42  1  0\n 24 43  1  0\nM  END\n","sdf");
    viewer_17285434059751809.setStyle({"stick": {}});
    viewer_17285434059751809.addModel("383505\n     RDKit          3D\n\n 29 31  0  0  0  0  0  0  0  0999 V2000\n    0.2128    0.7236   -0.7300 S   0  0  0  0  0  0  0  0  0  0  0  0\n    2.4829    1.8459    1.8914 F   0  0  0  0  0  0  0  0  0  0  0  0\n    2.8017   -1.8113   -1.1189 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.4843   -1.3824   -1.3463 F   0  0  0  0  0  0  0  0  0  0  0  0\n    5.1658    2.2656    1.6571 F   0  0  0  0  0  0  0  0  0  0  0  0\n    6.6705    0.6551    0.0395 F   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.4514    0.7847   -1.0872 N   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.8197   -0.5359    0.5854 N   0  0  0  0  0  0  0  0  0  0  0  0\n    2.6167    0.0134    0.3882 C   0  0  0  0  0  0  0  0  0  0  0  0\n    1.1389   -0.2207    0.5160 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.6114    0.2624   -0.5751 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.1905   -0.5586    0.4674 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -1.4095    0.2785   -0.3611 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.2118    1.0512    1.0954 C   0  0  0  0  0  0  0  0  0  0  0  0\n    3.3745   -0.8105   -0.4357 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.9517    0.4324   -0.9237 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -4.1502   -1.2593    1.2174 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.7472   -0.5934   -0.5541 C   0  0  0  0  0  0  0  0  0  0  0  0\n    4.5845    1.2685    0.9771 C   0  0  0  0  0  0  0  0  0  0  0  0\n    5.3523    0.4462    0.1524 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.8933   -0.2724   -0.1665 C   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.5018   -1.1038    0.8853 C   0  0  0  0  0  0  0  0  0  0  0  0\n    0.9173   -1.2888    0.4053 H   0  0  0  0  0  0  0  0  0  0  0  0\n    0.7992    0.0647    1.5187 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -2.3786    1.4291   -1.8629 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -5.2530    1.0782   -1.7406 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -3.8562   -1.9076    2.0368 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.9498   -0.1706   -0.4020 H   0  0  0  0  0  0  0  0  0  0  0  0\n   -6.2569   -1.6387    1.4556 H   0  0  0  0  0  0  0  0  0  0  0  0\n  1 10  1  0\n  1 13  1  0\n  2 14  1  0\n  3 15  1  0\n  4 18  1  0\n  5 19  1  0\n  6 20  1  0\n  7 11  1  0\n  7 13  1  0\n  7 25  1  0\n  8 12  1  0\n  8 13  2  0\n  9 10  1  0\n  9 14  2  0\n  9 15  1  0\n 10 23  1  0\n 10 24  1  0\n 11 12  2  0\n 11 16  1  0\n 12 17  1  0\n 14 19  1  0\n 15 18  2  0\n 16 21  2  0\n 16 26  1  0\n 17 22  2  0\n 17 27  1  0\n 18 20  1  0\n 19 20  2  0\n 21 22  1  0\n 21 28  1  0\n 22 29  1  0\nM  END\n","sdf");
    viewer_17285434059751809.setStyle({"stick": {}});
    viewer_17285434059751809.setStyle({"model": 0},{"stick": {"colorscheme": "cyanCarbon"}});
    viewer_17285434059751809.setStyle({"model": 1},{"stick": {"colorscheme": "blueCarbon"}});
    viewer_17285434059751809.zoomTo();
viewer_17285434059751809.render();
});
</script>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/greglandrum\.github\.io\/rdkit-blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="greglandrum/rdkit-blog" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright (C) 2025 Greg Landrum</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://www.rdkit.org"><img src="https://www.rdkit.org/logo.small.png" class="img-fluid" alt="RDKit" width="64"></a></p>
</div>
  </div>
</footer>




</body></html>